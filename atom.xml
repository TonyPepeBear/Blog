<?xml version="1.0" encoding="utf-8"?><feed xmlns="http://www.w3.org/2005/Atom" xml:lang="zh-TW"><title type="text">TonyPepe</title><subtitle type="html">紀錄我踩過得坑</subtitle><updated>2021-06-05T17:05:26+00:00</updated><id>https://tonypepe.com/</id><link rel="alternate" type="text/html" href="https://tonypepe.com/"/><link rel="self" type="application/atom+xml" href="https://tonypepe.com/atom.xml"/><author><name>TonyPepe</name><uri>https://tonypepe.com/</uri><email>tonybear55665566@gmail.com</email></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><generator uri="https://gohugo.io/" version="0.83.1">Hugo</generator><entry><title type="text">字架 Play With Docker</title><link rel="alternate" type="text/html" href="https://tonypepe.com/posts/docker/pwd-hosting/"/><id>https://tonypepe.com/posts/docker/pwd-hosting/</id><updated>2021-06-05T17:05:24+00:00</updated><published>2021-06-05T16:08:29+00:00</published><author><name>TonyPepe</name><uri>https://io-oi.me/</uri><email>tonybear55665566@gmail.com</email></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">學過 Docker 的人都應該有用過 Docker Playground 來學習或是測試過軟體，不想在本機跑 Docker 可以先用 Docker Playground 試試看軟體……</summary><content type="html">&lt;p>學過 Docker 的人都應該有用過 Docker Playground 來學習或是測試過軟體，不想在本機跑 Docker 可以先用 Docker Playground 試試看軟體可不可以跑。&lt;/p>
&lt;p>官方已經有架設 &lt;a href="https://labs.play-with-docker.com/">Docker Playground&lt;/a>，可以讓大家方便使用，但我使用的時後常發現他會 Lag，也不知道是 Docker Server 的問題，還是臺灣網路的問題。剛好最近想要教社團 Docker，這樣我架好一個，大家就不需要準備環境，直接就可以開始學了。&lt;/p>
&lt;p>本專案的 &lt;a href="https://github.com/play-with-docker/play-with-docker">GitHub&lt;/a>&lt;/p>
&lt;h2 id="準備環境">準備環境&lt;/h2>
&lt;ul>
&lt;li>
&lt;p>Docker &lt;code>18.06.0+&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Go 最新版&lt;/p>
&lt;/li>
&lt;/ul>
&lt;p>以上的安裝兩個在這邊都不贅述，請自行參閱官方文檔。&lt;/p>
&lt;h2 id="開始部署">開始部署&lt;/h2>
&lt;h3 id="第一步下載專案">第一步：下載專案&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">git clone https://github.com/play-with-docker/play-with-docker
&lt;span class="nb">cd&lt;/span> play-with-docker
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="第二步確認驅動">第二步：確認驅動&lt;/h3>
&lt;p>其實我不是很確定這一步驟是要幹嘛，但是官方文檔有寫到，但是我在 Mac 上無法執行此命令，也可以順利部署。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">sudo modprobe xt_ipvs
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="第三步docker-swarm">第三步：Docker swarm&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">docker swarm init
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="第四步下載-image">第四步：下載 image&lt;/h3>
&lt;p>這個 Image 是之後在 PWD 中創建容器時要用到的 Image。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">docker pull franela/dind
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="第五步go-mod">第五步：go mod&lt;/h3>
&lt;p>這步也是非必要的，我也不懂 Golang 所以也不確定是要幹嘛。&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">go mod vendor
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;h3 id="最後啟動">最後：啟動&lt;/h3>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-bash" data-lang="bash">docker-compose up
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>若沒有其他問題，理論上現在連接到 &lt;code>http://localhost:80&lt;/code> 就可以看到 PWD 正在執行，也可以開始創建容器使用。&lt;/p>
&lt;h2 id="localhost-or-404">localhost or 404&lt;/h2>
&lt;p>上一段的最後寫到可以連接到 localhost，但如果你試著用 localhost 以外的方式連接，就會出現問題，不管是 &lt;code>127.0.0.1&lt;/code> 或是用網址 &lt;code>pwd.example.com&lt;/code> 之類的都沒有辦法連接到 PWD，會不斷地出現 404，就是只有 localhost 可以。官方的文件就寫到這裡，也沒寫解法，以下是我自己發現的解決方法。&lt;/p>
&lt;p>基本上這個問題是 DNS 解析發生的問題，PWD 一次只能解析一種網址，預設是 &lt;code>localhost&lt;/code>，我們可以去他的設定檔中變更他。&lt;/p>
&lt;p>設定檔案在 &lt;code>play-with-docker/config/config.go&lt;/code> 之中，其中會有一行長下面的樣子：&lt;/p>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-go" data-lang="go">&lt;span class="nx">flag&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="nf">StringVar&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="o">&amp;amp;&lt;/span>&lt;span class="nx">PlaygroundDomain&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;playground-domain&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;localhost&amp;#34;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="s">&amp;#34;Domain to use for the playground&amp;#34;&lt;/span>&lt;span class="p">)&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div>&lt;p>可以看到 PWD 這裡可以設定要解析的網址就是 &lt;code>localhost&lt;/code>，所以只要將此變更為 &lt;code>pwd.example.com&lt;/code>，就可以用這個網址連上 PWD。&lt;/p>
&lt;h3 id="連上容器內的-port">連上容器內的 Port&lt;/h3>
&lt;p>就算做完上面的設定，也順利了啟動 Docker 容器，但最後才發現想要連上特定的 Port 還是會失敗，因為他是用子網域的方式去連線 &lt;code>http://ip&amp;lt;hyphen-ip&amp;gt;-&amp;lt;session_jd&amp;gt;-&amp;lt;port&amp;gt;.direct.pwd.example.com&lt;/code>，所以又會遇到無法解析 DNS 的情況，我的解法是在 DNS 的設定中把 &lt;code>pwd.example.com&lt;/code> 和 &lt;code>*.pwd.example.com&lt;/code> 都加入 A Record，才順利連上。&lt;/p></content><category scheme="https://tonypepe.com/tags/docker/" term="docker" label="docker"/><category scheme="https://tonypepe.com/tags/play-with-docker/" term="play-with-docker" label="play-with-docker"/></entry><entry><title type="text">Hello World</title><link rel="alternate" type="text/html" href="https://tonypepe.com/posts/other/hello-world/"/><id>https://tonypepe.com/posts/other/hello-world/</id><updated>2021-06-05T17:05:24+00:00</updated><published>2021-06-05T11:15:18+00:00</published><author><name>TonyPepe</name><uri>https://io-oi.me/</uri><email>tonybear55665566@gmail.com</email></author><rights>[CC BY-NC-SA 4.0](https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh)</rights><summary type="html">&lt;p>This is my first post in hugo.&lt;/p></summary><content type="html">&lt;p>This is my first post in hugo.&lt;/p>
&lt;h2 id="kotlin">Kotlin&lt;/h2>
&lt;div class="highlight">&lt;div class="chroma">
&lt;table class="lntable">&lt;tr>&lt;td class="lntd">
&lt;pre class="chroma">&lt;code>&lt;span class="lnt">1
&lt;/span>&lt;span class="lnt">2
&lt;/span>&lt;span class="lnt">3
&lt;/span>&lt;span class="lnt">4
&lt;/span>&lt;span class="lnt">5
&lt;/span>&lt;/code>&lt;/pre>&lt;/td>
&lt;td class="lntd">
&lt;pre class="chroma">&lt;code class="language-kotlin" data-lang="kotlin">&lt;span class="k">fun&lt;/span> &lt;span class="nf">String&lt;/span>&lt;span class="p">.&lt;/span>&lt;span class="n">hi&lt;/span>&lt;span class="p">()&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;&lt;/span>&lt;span class="si">$this&lt;/span>&lt;span class="s2"> HI&amp;#34;&lt;/span>
&lt;span class="k">class&lt;/span> &lt;span class="nc">Test&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="k">var&lt;/span> &lt;span class="py">i&lt;/span>&lt;span class="p">:&lt;/span> &lt;span class="n">Int&lt;/span>&lt;span class="p">)&lt;/span> &lt;span class="p">{&lt;/span>
&lt;span class="k">var&lt;/span> &lt;span class="py">p&lt;/span> &lt;span class="p">=&lt;/span> &lt;span class="s2">&amp;#34;13 13&amp;#34;&lt;/span>
&lt;span class="p">}&lt;/span>
&lt;/code>&lt;/pre>&lt;/td>&lt;/tr>&lt;/table>
&lt;/div>
&lt;/div></content></entry></feed>