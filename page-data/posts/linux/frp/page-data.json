{"componentChunkName":"component---src-templates-article-template-tsx","path":"/posts/linux/frp","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"id":"12cf7dd4-2218-52e9-b731-11bbf415cd30","html":"<p>frp 全名是 fast reverse proxy，可以將在 NAT 後方的服務快速的發布到公網 ip 上，可以支援 TCP 和 UDP 協議，我覺得唯一的缺點就是所有流量都會經過 Server 端，所以如果 Server 端的流量有限制就需要注意一下。</p>\n<!--more-->\n<p>frp 會需要一台 Server，Server 需要公網 ip，如果沒有公網 ip，可以使用 aws 或 gcp 買一個簡單的 VPS。</p>\n<h2>安裝</h2>\n<p>網路上有許多一鍵安裝的到腳本，但我們不使用那些，有興趣的自己上網搜尋。</p>\n<p>到官方 <a href=\"https://github.com/fatedier/frp/releases\">Release</a> 下載最新版，根據系統選擇，解壓後會看到 <code class=\"language-text\">frps</code> 、<code class=\"language-text\">frpc</code> 各有三個檔案，跟 <code class=\"language-text\">frps</code> 有關的就是 Server 端用的，<code class=\"language-text\">frpc</code> 的就是 Client 端用的。如果是 Server 端，就可以將 <code class=\"language-text\">frpc</code> 的檔案都刪除。</p>\n<h2>Server 端設定</h2>\n<p>在 Server 上打開設定文件 <code class=\"language-text\">frps.ini</code> 可以看到預設就有如下的內容：</p>\n<div class=\"gatsby-highlight\" data-language=\"ini\"><pre class=\"language-ini\"><code class=\"language-ini\"><span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">common</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">bind_port</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">7000</span></code></pre></div>\n<p><code class=\"language-text\">common</code> 內綁定了 7000 port，這個 port 是讓 client 端連接用的，基本現在不用改設定就可以直接用。執行 <code class=\"language-text\">frps</code> 要用 <code class=\"language-text\">-c</code> 參數給定設定檔案：</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\">./frps -c ./frps.ini</code></pre></div>\n<p>如果沒看到問題，基本上 Server 端就設定好了，其他功能晚點再介紹，我們先設定好 Client。</p>\n<h2>Client 端設定</h2>\n<p>Client 就是要發布服務伺服器，所以雖然叫做 Client 但本身應該也是一台提供服務的 Server。Client 就可以刪除有關 <code class=\"language-text\">frps</code> 相關的檔案。</p>\n<p>一樣先打開設定檔 <code class=\"language-text\">frpc.ini</code>，也會有如下預設內容：</p>\n<div class=\"gatsby-highlight\" data-language=\"ini\"><pre class=\"language-ini\"><code class=\"language-ini\"><span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">common</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">server_addr</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">127.0.0.1</span>\n<span class=\"token key attr-name\">server_port</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">7000</span>\n\n<span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">ssh</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">type</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">tcp</span>\n<span class=\"token key attr-name\">local_ip</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">127.0.0.1</span>\n<span class=\"token key attr-name\">local_port</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">22</span>\n<span class=\"token key attr-name\">remote_port</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">6000</span></code></pre></div>\n<p>Client 端的設定檔就不能直接用，需要修改 Server ip 才行，更改 <code class=\"language-text\">server_addr</code> 為剛剛 Server 端的 ip 地址或是 Domain 都可以。</p>\n<p>下方方的 ssh 區塊設一個將 Client 端的 ssh 22 port 公開到 Server 端的 6000 port 的範本，如果有其他的 port 要開放，用相同的思維更改即可。像是如過要加 Minecraft 25565 port 也到 Server 端的 25565 port，就可以新增一個區塊：</p>\n<div class=\"gatsby-highlight\" data-language=\"ini\"><pre class=\"language-ini\"><code class=\"language-ini\"><span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">common</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">server_addr</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">example.com</span>\n<span class=\"token key attr-name\">server_port</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">7000</span>\n\n<span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">ssh</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">type</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">tcp</span>\n<span class=\"token key attr-name\">local_ip</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">127.0.0.1</span>\n<span class=\"token key attr-name\">local_port</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">22</span>\n<span class=\"token key attr-name\">remote_port</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">6000</span>\n\n<span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">minecraft</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">type</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">tcp</span>\n<span class=\"token key attr-name\">local_ip</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">127.0.0.1</span>\n<span class=\"token key attr-name\">local_port</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">25565</span>\n<span class=\"token key attr-name\">remote_port</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">25565</span></code></pre></div>\n<p>到目前為止應該就可以用 Server 端的 ip 連接到 Client 端了，如果連不上，可能要檢查一下 Server 端防火牆的設定，這邊就不贅述。</p>\n<h2>Token 認證</h2>\n<p>不知道大家有沒有發現，基本上只要知道你 Server ip 或 domain 的人都可以新增自己的 port，要避免這樣的狀況，我們可以使用 token。使用方法也很簡單，只要在 Server 和 Client 端的 <code class=\"language-text\">[common]</code> 都加上相同的 token 參數，就可以進行簡單的認證。</p>\n<p>Server 端範例：</p>\n<div class=\"gatsby-highlight\" data-language=\"ini\"><pre class=\"language-ini\"><code class=\"language-ini\"><span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">common</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">bind_port</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">7000</span>\n<span class=\"token key attr-name\">token</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">7Jc2ZCvVzHu</span></code></pre></div>\n<p>Client 端範例：</p>\n<div class=\"gatsby-highlight\" data-language=\"ini\"><pre class=\"language-ini\"><code class=\"language-ini\"><span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">common</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">server_addr</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">example.com</span>\n<span class=\"token key attr-name\">server_port</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">7000</span>\n<span class=\"token key attr-name\">token</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">7Jc2ZCvVzHu</span>\n\n<span class=\"token section\"><span class=\"token punctuation\">[</span><span class=\"token section-name selector\">ssh</span><span class=\"token punctuation\">]</span></span>\n<span class=\"token key attr-name\">type</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">tcp</span>\n<span class=\"token key attr-name\">local_ip</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">127.0.0.1</span>\n<span class=\"token key attr-name\">local_port</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">22</span>\n<span class=\"token key attr-name\">remote_port</span> <span class=\"token punctuation\">=</span> <span class=\"token value attr-value\">6000</span></code></pre></div>\n<h2>Refrence</h2>\n<p><a href=\"https://github.com/fatedier/frp\">GitHub</a></p>\n<p><a href=\"https://gofrp.org/docs/\">中文文檔</a></p>","rawMarkdownBody":"\nfrp 全名是 fast reverse proxy，可以將在 NAT 後方的服務快速的發布到公網 ip 上，可以支援 TCP 和 UDP 協議，我覺得唯一的缺點就是所有流量都會經過 Server 端，所以如果 Server 端的流量有限制就需要注意一下。\n\n<!--more-->\n\nfrp 會需要一台 Server，Server 需要公網 ip，如果沒有公網 ip，可以使用 aws 或 gcp 買一個簡單的 VPS。\n\n## 安裝\n\n網路上有許多一鍵安裝的到腳本，但我們不使用那些，有興趣的自己上網搜尋。\n\n到官方 [Release](https://github.com/fatedier/frp/releases) 下載最新版，根據系統選擇，解壓後會看到 `frps` 、`frpc` 各有三個檔案，跟 `frps` 有關的就是 Server 端用的，`frpc` 的就是 Client 端用的。如果是 Server 端，就可以將 `frpc` 的檔案都刪除。\n\n## Server 端設定\n\n在 Server 上打開設定文件 `frps.ini` 可以看到預設就有如下的內容：\n\n```ini\n[common]\nbind_port = 7000\n```\n\n`common` 內綁定了 7000 port，這個 port 是讓 client 端連接用的，基本現在不用改設定就可以直接用。執行 `frps` 要用 `-c` 參數給定設定檔案：\n\n```shell\n./frps -c ./frps.ini\n```\n\n如果沒看到問題，基本上 Server 端就設定好了，其他功能晚點再介紹，我們先設定好 Client。\n\n## Client 端設定\n\nClient 就是要發布服務伺服器，所以雖然叫做 Client 但本身應該也是一台提供服務的 Server。Client 就可以刪除有關 `frps` 相關的檔案。\n\n一樣先打開設定檔 `frpc.ini`，也會有如下預設內容：\n\n```ini\n[common]\nserver_addr = 127.0.0.1\nserver_port = 7000\n\n[ssh]\ntype = tcp\nlocal_ip = 127.0.0.1\nlocal_port = 22\nremote_port = 6000\n```\n\nClient 端的設定檔就不能直接用，需要修改 Server ip 才行，更改 `server_addr` 為剛剛 Server 端的 ip 地址或是 Domain 都可以。\n\n下方方的 ssh 區塊設一個將 Client 端的 ssh 22 port 公開到 Server 端的 6000 port 的範本，如果有其他的 port 要開放，用相同的思維更改即可。像是如過要加 Minecraft 25565 port 也到 Server 端的 25565 port，就可以新增一個區塊：\n\n```ini\n[common]\nserver_addr = example.com\nserver_port = 7000\n\n[ssh]\ntype = tcp\nlocal_ip = 127.0.0.1\nlocal_port = 22\nremote_port = 6000\n\n[minecraft]\ntype = tcp\nlocal_ip = 127.0.0.1\nlocal_port = 25565\nremote_port = 25565\n```\n\n到目前為止應該就可以用 Server 端的 ip 連接到 Client 端了，如果連不上，可能要檢查一下 Server 端防火牆的設定，這邊就不贅述。\n\n## Token 認證\n\n不知道大家有沒有發現，基本上只要知道你 Server ip 或 domain 的人都可以新增自己的 port，要避免這樣的狀況，我們可以使用 token。使用方法也很簡單，只要在 Server 和 Client 端的 `[common]` 都加上相同的 token 參數，就可以進行簡單的認證。\n\nServer 端範例：\n\n```ini\n[common]\nbind_port = 7000\ntoken = 7Jc2ZCvVzHu\n```\n\nClient 端範例：\n\n```ini\n[common]\nserver_addr = example.com\nserver_port = 7000\ntoken = 7Jc2ZCvVzHu\n\n[ssh]\ntype = tcp\nlocal_ip = 127.0.0.1\nlocal_port = 22\nremote_port = 6000\n```\n\n## Refrence\n\n[GitHub](https://github.com/fatedier/frp)\n\n[中文文檔](https://gofrp.org/docs/)\n","excerpt":"frp 全名是 fast reverse proxy，可以將在 NAT 後方的服務快速的發布到公網 ip 上，可以支援 TCP 和 UDP 協議，我覺得唯一的缺點就是所有流量都會經過 Server 端，所以如果 Server 端的流量有限制就需要注意一下。 frp 會需要一台 Server，Server 需要公網 ip，如果沒有公網 ip，可以使用 aws 或 gcp 買一個簡單的 VPS。 安…","frontmatter":{"title":"Frp","date":"2021-06-20T13:48:33.000Z","draft":false,"tags":["frp","linux"],"image":"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/34046c81-cb6e-40a5-7b3a-8623c613f400/public","description":"frp 全名是 fast reverse proxy，可以將在 NAT 後方的服務快速的發布到公網 ip 上，可以支援 TCP 和 UDP 協議，我覺得唯一的缺點就是所有流量都會經過 Server 端，所以如果 Server 端的流量有限制就需要注意一下。"}}}]}},"pageContext":{"id":"12cf7dd4-2218-52e9-b731-11bbf415cd30"}},"staticQueryHashes":[]}