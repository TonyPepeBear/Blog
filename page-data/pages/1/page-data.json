{"componentChunkName":"component---src-templates-article-list-page-template-tsx","path":"/pages/1","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"id":"2797652b-b371-5832-b5ca-7639e58b787e","html":"<p>ç¶­åŸºç™¾ç§‘æ˜¯å¤§å®¶çš„å¥½æœ‹å‹ï¼Œä½†ä»–çš„ç¶²é æ’ç‰ˆæ„Ÿè¦ºå·²ç¶“å¹¾åå¹´æ²’æœ‰æ›´æ–°éï¼Œé–±è®€èµ·ä¾†æœ‰é»ä¸æ–¹ä¾¿ï¼Œè€Œ Wikiwand å°±æ˜¯ä¾†å¹«åŠ©ç¶­åŸºç™¾ç§‘æ’ç‰ˆæˆæ›´å®¹æ˜“é–±è®€çš„å½¢å¼ï¼Œåœ¨ Google Chrome ä¸Šæœ‰å®˜æ–¹çš„æ“´å……åŠŸèƒ½å¯ä»¥å°‡ Wiki çš„ç¶²å€ç›´æ¥é‡æ–°å°å‘åˆ° Wikiwandï¼Œè€Œ Safari å¥½åƒæ˜¯å› ç‚º Apple åš´æ ¼çš„æ¢ä»¶æ‰€ä»¥æ²’æœ‰æ“´å……åŠŸèƒ½ï¼Œä½†æˆ‘ä»Šå¤©ç™¼ç¾çš„ä¸€å€‹æŠ€å·§å¯ä»¥å”åŠ©å°‡ç¶²é ç›´æ¥é‡æ–°å°å‘åˆ° Wikiwandã€‚</p>\n<!--more-->\n<h2>Wikiwand æ¯”è¼ƒ</h2>\n<p>åŸç‰ˆç¶­åŸºï¼š</p>\n<p><img src=\"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/0a6c340c-becb-4748-a9d3-949a48241600/public\" alt=\"img\"></p>\n<p>Wikiwand:</p>\n<p><img src=\"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/6023546f-67b9-4524-df91-33bc53f34f00/public\" alt=\"img\"></p>\n<h2>åˆ©ç”¨ AdGuard</h2>\n<p>é€™å€‹æŠ€å·§æ˜¯åˆ©ç”¨å»£å‘Šéæ¿¾å™¨ä¾†å”åŠ©ç¶²é é‡æ–°å°å‘ï¼Œè€Œæˆ‘æ˜¯ç”¨ AdGuard ä¾†å¹«åŠ©æˆ‘å€‘å®Œæˆï¼Œæˆ‘ä¹Ÿåªåœ¨ AdGuard ä¸Šç”¨éï¼Œå…¶ä»–å»£å‘Šéæ¿¾å™¨æˆ‘å°±ä¸çŸ¥é“å¯ä¸å¯ä»¥åˆ©ç”¨é€™å€‹æŠ€å·§äº†ã€‚å¦‚éæ²’æœ‰ AdGuard çš„è©±ï¼Œä¹Ÿå¯ä»¥å»ä¸‹è¼‰è©¦ç”¨çœ‹çœ‹ï¼Œè‡ªå·±ç”¨äº†å¾ˆä¹…è¦ºå¾—é‚„ä¸éŒ¯ã€‚</p>\n<p>æ•´å€‹éç¨‹åªéœ€è¦ä¸€æ­¥</p>\n<p>åœ¨ AdGuard çš„è¨­å®šä¸­ï¼Œåœ¨éæ¿¾å™¨é¸é …ä¸­æ–°å¢ä½¿ç”¨è€…è‡ªè¨‚çš„éæ¿¾å™¨ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">@@<span class=\"token operator\">||</span>wikipedia<span class=\"token punctuation\">.</span>org<span class=\"token operator\">^</span>$generichide<span class=\"token punctuation\">,</span>badfilter\nwikipedia<span class=\"token punctuation\">.</span>org#<span class=\"token operator\">%</span>#<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>search <span class=\"token operator\">===</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token keyword\">var</span> lang <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>hostname<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'.'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> <span class=\"token keyword\">var</span> article <span class=\"token operator\">=</span> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>pathname<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">'/'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span> window<span class=\"token punctuation\">.</span>location<span class=\"token punctuation\">.</span>href <span class=\"token operator\">=</span> <span class=\"token string\">\"http://www.wikiwand.com/\"</span> <span class=\"token operator\">+</span> lang <span class=\"token operator\">+</span> <span class=\"token string\">\"/\"</span> <span class=\"token operator\">+</span> article<span class=\"token punctuation\">;</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p><img src=\"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/4296f199-0bb2-4c34-922f-b45a5c280100/public\" alt=\"img\"></p>\n<p>å¤§åŠŸå‘Šæˆ</p>\n<h2>Reference</h2>\n<ul>\n<li><a href=\"http://sebastiangrans.github.io/Wikiwand-on-Safari-13/\">Wikiwand on Safari</a></li>\n</ul>","rawMarkdownBody":"\nç¶­åŸºç™¾ç§‘æ˜¯å¤§å®¶çš„å¥½æœ‹å‹ï¼Œä½†ä»–çš„ç¶²é æ’ç‰ˆæ„Ÿè¦ºå·²ç¶“å¹¾åå¹´æ²’æœ‰æ›´æ–°éï¼Œé–±è®€èµ·ä¾†æœ‰é»ä¸æ–¹ä¾¿ï¼Œè€Œ Wikiwand å°±æ˜¯ä¾†å¹«åŠ©ç¶­åŸºç™¾ç§‘æ’ç‰ˆæˆæ›´å®¹æ˜“é–±è®€çš„å½¢å¼ï¼Œåœ¨ Google Chrome ä¸Šæœ‰å®˜æ–¹çš„æ“´å……åŠŸèƒ½å¯ä»¥å°‡ Wiki çš„ç¶²å€ç›´æ¥é‡æ–°å°å‘åˆ° Wikiwandï¼Œè€Œ Safari å¥½åƒæ˜¯å› ç‚º Apple åš´æ ¼çš„æ¢ä»¶æ‰€ä»¥æ²’æœ‰æ“´å……åŠŸèƒ½ï¼Œä½†æˆ‘ä»Šå¤©ç™¼ç¾çš„ä¸€å€‹æŠ€å·§å¯ä»¥å”åŠ©å°‡ç¶²é ç›´æ¥é‡æ–°å°å‘åˆ° Wikiwandã€‚\n\n<!--more-->\n\n## Wikiwand æ¯”è¼ƒ\n\nåŸç‰ˆç¶­åŸºï¼š\n\n![img](https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/0a6c340c-becb-4748-a9d3-949a48241600/public)\n\nWikiwand:\n\n![img](https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/6023546f-67b9-4524-df91-33bc53f34f00/public)\n\n## åˆ©ç”¨ AdGuard\n\né€™å€‹æŠ€å·§æ˜¯åˆ©ç”¨å»£å‘Šéæ¿¾å™¨ä¾†å”åŠ©ç¶²é é‡æ–°å°å‘ï¼Œè€Œæˆ‘æ˜¯ç”¨ AdGuard ä¾†å¹«åŠ©æˆ‘å€‘å®Œæˆï¼Œæˆ‘ä¹Ÿåªåœ¨ AdGuard ä¸Šç”¨éï¼Œå…¶ä»–å»£å‘Šéæ¿¾å™¨æˆ‘å°±ä¸çŸ¥é“å¯ä¸å¯ä»¥åˆ©ç”¨é€™å€‹æŠ€å·§äº†ã€‚å¦‚éæ²’æœ‰ AdGuard çš„è©±ï¼Œä¹Ÿå¯ä»¥å»ä¸‹è¼‰è©¦ç”¨çœ‹çœ‹ï¼Œè‡ªå·±ç”¨äº†å¾ˆä¹…è¦ºå¾—é‚„ä¸éŒ¯ã€‚\n\næ•´å€‹éç¨‹åªéœ€è¦ä¸€æ­¥\n\nåœ¨ AdGuard çš„è¨­å®šä¸­ï¼Œåœ¨éæ¿¾å™¨é¸é …ä¸­æ–°å¢ä½¿ç”¨è€…è‡ªè¨‚çš„éæ¿¾å™¨ï¼š\n\n```js\n@@||wikipedia.org^$generichide,badfilter\nwikipedia.org#%#if (window.location.search === \"\") { var lang = window.location.hostname.split('.')[0]; var article = window.location.pathname.split('/')[2]; window.location.href = \"http://www.wikiwand.com/\" + lang + \"/\" + article; }\n```\n\n![img](https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/4296f199-0bb2-4c34-922f-b45a5c280100/public)\n\nå¤§åŠŸå‘Šæˆ\n\n## Reference\n\n- [Wikiwand on Safari](http://sebastiangrans.github.io/Wikiwand-on-Safari-13/)\n","fileAbsolutePath":"/home/runner/work/Blog/Blog/src/posts/Others/Wikiwand on Safari.md","excerpt":"ç¶­åŸºç™¾ç§‘æ˜¯å¤§å®¶çš„å¥½æœ‹å‹ï¼Œä½†ä»–çš„ç¶²é æ’ç‰ˆæ„Ÿè¦ºå·²ç¶“å¹¾åå¹´æ²’æœ‰æ›´æ–°éï¼Œé–±è®€èµ·ä¾†æœ‰é»ä¸æ–¹ä¾¿ï¼Œè€Œ Wikiwand å°±æ˜¯ä¾†å¹«åŠ©ç¶­åŸºç™¾ç§‘æ’ç‰ˆæˆæ›´å®¹æ˜“é–±è®€çš„å½¢å¼ï¼Œåœ¨ Google Chrome ä¸Šæœ‰å®˜æ–¹çš„æ“´å……åŠŸèƒ½å¯ä»¥å°‡ Wiki çš„ç¶²å€ç›´æ¥é‡æ–°å°å‘åˆ° Wikiwandï¼Œè€Œ Safari å¥½åƒæ˜¯å› ç‚º Apple åš´æ ¼çš„æ¢ä»¶æ‰€ä»¥æ²’æœ‰æ“´å……åŠŸèƒ½ï¼Œä½†æˆ‘ä»Šå¤©ç™¼ç¾çš„ä¸€å€‹æŠ€å·§å¯ä»¥å”åŠ©å°‡ç¶²é ç›´æ¥é‡æ–°å°å‘åˆ° Wikiwandã€‚ â€¦","frontmatter":{"title":"Wikiwand on Safari","date":"2022-08-26T13:44:50.631Z","draft":false,"tags":["wiki","wikiwand","adguard"],"image":"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/70c00ace-d3b4-4326-cd8c-938fe0cc7200/public","description":null}}},{"node":{"id":"abbc4a5c-22fa-521b-8c76-c393653c057b","html":"<p>Amend Commit å°±æ˜¯ç”¨ä¾†ä¿®æ”¹æœ€æ–° Commit çš„æŒ‡ä»¤ï¼Œå¦‚æœè¦ä¿®æ”¹æ›´ä¹‹å‰çš„ Commitï¼Œå°±è¦ç”¨ Rebase æˆ–æ˜¯ Reset äº†ã€‚</p>\n<!--more-->\n<h2>ä¿®æ”¹ Commit Message</h2>\n<p>å¦‚æœæœ€æ–°çš„ Commit Message äº‚å¯«æˆ–æ˜¯å¯«çš„ä»€éº¼ä¸è©²å¯«çš„ï¼Œå°±å¯ä»¥ç”¨ Amend Commit ä¾†ä¿®æ”¹ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> commit --amend -m <span class=\"token string\">\"æ–°çš„ Commit Message\"</span></code></pre></div>\n<h2>å£“é€²å‰ä¸€æ¬¡ Commit</h2>\n<p>æˆ‘å¸¸å¸¸æœƒå…ˆå°‡ç›®å‰çš„ä¿®æ”¹çµ¦ Commit ä¸€ä¸‹ç•¶ä½œå­˜æª”ï¼Œä½†å¦‚æœæ¯æ¬¡éƒ½åªæœ‰å°ä¿®æ”¹å°± Commit ä¸€æ¬¡ä¹Ÿæœƒé€ æˆ Commit éå¸¸å¤šï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥åœ¨ Commit çš„æ™‚å€™ç”¨ Amend Commit å£“é€²å‰ä¸€æ¬¡ Commitï¼Œæˆ–æ˜¯æƒ³åƒæˆä¿®æ”¹ä¸Šä¸€æ¬¡çš„ Commit æŠŠé€™æ¬¡çš„ä¿®æ”¹çµ¦åŠ é€²å»ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">git</span> <span class=\"token function\">add</span> <span class=\"token builtin class-name\">.</span>\n<span class=\"token function\">git</span> commit --amend</code></pre></div>","rawMarkdownBody":"\nAmend Commit å°±æ˜¯ç”¨ä¾†ä¿®æ”¹æœ€æ–° Commit çš„æŒ‡ä»¤ï¼Œå¦‚æœè¦ä¿®æ”¹æ›´ä¹‹å‰çš„ Commitï¼Œå°±è¦ç”¨ Rebase æˆ–æ˜¯ Reset äº†ã€‚\n\n<!--more-->\n\n## ä¿®æ”¹ Commit Message\n\nå¦‚æœæœ€æ–°çš„ Commit Message äº‚å¯«æˆ–æ˜¯å¯«çš„ä»€éº¼ä¸è©²å¯«çš„ï¼Œå°±å¯ä»¥ç”¨ Amend Commit ä¾†ä¿®æ”¹ã€‚\n\n```bash\ngit commit --amend -m \"æ–°çš„ Commit Message\"\n```\n\n## å£“é€²å‰ä¸€æ¬¡ Commit\n\næˆ‘å¸¸å¸¸æœƒå…ˆå°‡ç›®å‰çš„ä¿®æ”¹çµ¦ Commit ä¸€ä¸‹ç•¶ä½œå­˜æª”ï¼Œä½†å¦‚æœæ¯æ¬¡éƒ½åªæœ‰å°ä¿®æ”¹å°± Commit ä¸€æ¬¡ä¹Ÿæœƒé€ æˆ Commit éå¸¸å¤šï¼Œæ‰€ä»¥æˆ‘å€‘å¯ä»¥åœ¨ Commit çš„æ™‚å€™ç”¨ Amend Commit å£“é€²å‰ä¸€æ¬¡ Commitï¼Œæˆ–æ˜¯æƒ³åƒæˆä¿®æ”¹ä¸Šä¸€æ¬¡çš„ Commit æŠŠé€™æ¬¡çš„ä¿®æ”¹çµ¦åŠ é€²å»ã€‚\n\n```bash\ngit add .\ngit commit --amend\n```\n","fileAbsolutePath":"/home/runner/work/Blog/Blog/src/posts/Git/amend.md","excerpt":"Amend Commit å°±æ˜¯ç”¨ä¾†ä¿®æ”¹æœ€æ–° Commit çš„æŒ‡ä»¤ï¼Œå¦‚æœè¦ä¿®æ”¹æ›´ä¹‹å‰çš„ Commitï¼Œå°±è¦ç”¨ Rebase æˆ–æ˜¯ Reset äº†ã€‚ ä¿®æ”¹ Commit Message å¦‚æœæœ€æ–°çš„ Commit Message äº‚å¯«æˆ–æ˜¯å¯«çš„ä»€éº¼ä¸è©²å¯«çš„ï¼Œå°±å¯ä»¥ç”¨ Amend Commit ä¾†ä¿®æ”¹ã€‚ å£“é€²å‰ä¸€æ¬¡ Commit æˆ‘å¸¸å¸¸æœƒå…ˆå°‡ç›®å‰çš„ä¿®æ”¹çµ¦ Commit ä¸€ä¸‹ç•¶ä½œå­˜æª”ï¼Œä½†å¦‚æœæ¯æ¬¡éƒ½åªæœ‰å°ä¿®æ”¹â€¦","frontmatter":{"title":"Git Amend Commit","date":"2022-08-11T13:44:12.703Z","draft":false,"tags":["git","amend","commit"],"image":"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/aa912c60-37ce-4fc5-6187-568499120700/public","description":null}}},{"node":{"id":"4c2b84a4-ff67-5922-b2e9-703e3980c137","html":"<p>ä»Šå¤©æŠŠä¸€å°å¤è€çš„ Samsung Galaxy S7 å¾ Android 6M åˆ·ä¸Š Android 11Rï¼Œä½¿ç”¨ Pixle Experience ROMï¼Œä¸¦å®‰è£ Magisk å’Œ GPS JoyStick ä¾†ç© Pokemon Goã€‚éç¨‹ä¸é›£ï¼Œä¸€æ­¥æ­¥åšå°±ä¸æœƒå‡ºéŒ¯ï¼Œå¾ Andoird 6 å‡åˆ° 11 ä¹Ÿæ²’æœ‰æ—©æˆæ‰‹æ©Ÿæœ‰æ˜é¡¯å¡é “ï¼Œä½©æœä½œè€…ã€‚</p>\n<!--more-->\n<p>é€™æ¬¡çš„å‹•æ©Ÿä¸»è¦æ˜¯ Pokemon Go æœ€è¿‘é–‹å§‹ä¸æ”¯æ´ Android 6 ä»¥ä¸‹çš„è£ç½®éŠç©ï¼Œåªå¥½å‡ç´šåŸæœ¬çš„è£ç½®ã€‚</p>\n<h2>æ­¥é©Ÿæ¦‚è¦½</h2>\n<ol>\n<li>åˆ·å…¥ TWRP</li>\n<li>åˆ·å…¥ Pixle Experience</li>\n<li>å®‰è£ Magisk</li>\n<li>å®‰è£ SmaliPatcher</li>\n<li>å®‰è£ SafetyNet Fix</li>\n<li>å®‰è£ä¸¦è¨­å®š GPS JoyStick</li>\n<li>ç©</li>\n</ol>\n<p>æ‰‹æ©Ÿæ‡‰è©²ä¸ä¸€å®šè¦æ˜¯ S7 ä¹Ÿå¯ä»¥ç…§è‘—é€™äº›æ€è·¯å®Œæˆã€‚</p>\n<h2>æ‰‹æ©Ÿäº‹å‰æº–å‚™</h2>\n<p>é–‹å•Ÿ USB åµéŒ¯å’Œ OEM è§£é–ã€‚</p>\n<p>çœ‹å®Œæœ¬æ–‡ï¼Œä¸¦å¯ä»¥å…ˆæŠŠæœƒç”¨åˆ°çš„æ±è¥¿éƒ½ä¸‹è¼‰ä¸‹ä¾†ã€‚</p>\n<h2>åˆ·å…¥ TWRP</h2>\n<ol>\n<li>é€²å…¥ Download Mode</li>\n<li>ç”¨ Odin å¯«å…¥ TWRP Recovery</li>\n<li>é€²å…¥ TWRP</li>\n</ol>\n<p>ä¸‹è¼‰æœ€æ–°çš„ Odin ç‰ˆæœ¬ (ç›®å‰æ˜¯ 3.13.1)ï¼Œ<a href=\"https://odindownload.com/\">Odin å®˜ç¶²</a></p>\n<p>ä¸‹è¼‰ <a href=\"https://twrp.me/samsung/samsunggalaxys7.html\">TWRP for Samsung Galaxy S7</a> (ç›®å‰æ˜¯ 3.6.2)ã€‚</p>\n<p>å°‡æ‰‹æ©Ÿé€£ä¸Šé›»è…¦ï¼Œä¸¦é—œæ©Ÿå¾Œé€²å…¥ Download Mode (POWER + VOL DOWN + HOME)ã€‚</p>\n<p><img src=\"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/4d367c79-5c09-4118-6b49-f09f918b8600/public\" alt=\"img\"></p>\n<p>é–‹å•Ÿ Odin ä¸¦é» AP é¸æ“‡åˆ·å…¥ TWRP æª”æ¡ˆï¼Œé—œé–‰ Auto Reboot å¾Œ Startï¼Œæ‡‰è©²åªè¦å¹¾ç§’å°±æœƒå®Œæˆã€‚</p>\n<p><img src=\"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/dacd3ce6-e43e-490d-0a1f-4f6b430e7800/public\" alt=\"img\"></p>\n<p>å¼·åˆ¶é—œæ©Ÿ (POWER + VOL DOWN + HOME) è¢å¹•é»‘æ‰å¾Œé¦¬ä¸ŠæŠŠéŸ³é‡éµä¸‹æ›æˆéŸ³é‡éµä¸Š (POWER + VOL UP + HOME) é€²å…¥ Recovery Modeï¼Œå¦‚æœåˆ°ç›®å‰ç‚ºæ­¢éƒ½æˆåŠŸçš„è©±æ‡‰è©²å°±æœƒçœ‹åˆ° TWRP çš„ä»‹é¢ã€‚</p>\n<h2>åˆ·å…¥ Pixle Experience ROM</h2>\n<p>ä¸‹è¼‰ <a href=\"https://download.pixelexperience.org/herolte\">Galaxy S7 Pixle Experience</a>ï¼Œç›®å‰æœ€æ–°ç‰ˆæœ¬æ˜¯ (20210923-1530)ã€‚</p>\n<p>é€²å…¥ TWRP å…ˆ Wipe å››å€‹åˆ†å€ï¼š</p>\n<p><img src=\"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/eed93d6e-153c-43d5-eac0-7eceeee50b00/public\" alt=\"img\"></p>\n<p>å¦‚æœ Wipe å¤±æ•—ä¸”æ˜¯å› ç‚ºæ²’è¾¦æ³• mount dataï¼Œå¯ä»¥åƒè€ƒ<a href=\"https://forum.xda-developers.com/t/how-to-fix-unable-to-mount-data-internal-storage-0mb-in-twrp-permanently.3830897/\">é€™ç¯‡æ–‡ç« </a>ã€‚</p>\n<p>æ¥ä¸‹ä¾†å¯ä»¥é¸æ“‡å…ˆå°‡ ROM æ”¾å…¥ SD å¡ï¼Œæˆ–æ˜¯ç›´æ¥ç”¨ adb å‘½ä»¤åˆ· (é›»è…¦ç•¶ç„¶è¦è£å¥½ adbï¼Œæœ€å¿«çš„æ–¹æ³•é‚„æ˜¯ç”¨ Chocolatey)ï¼Œæˆ‘è‡ªå·±æ˜¯ç›´æ¥ç”¨ adb çš„å‘½ä»¤åˆ·ã€‚åœ¨ TWRP ä¸»ç•«é¢é¸ Advancedï¼Œç„¶å¾Œä½¿ç”¨ ADB Sideloadã€‚</p>\n<p>é–‹å•Ÿé›»è…¦ Terminalï¼Œcd åˆ°æ”¾å‰›å‰›ä¸‹è¼‰çš„ ROM çš„ç›®éŒ„ï¼Œä¸¦è¼¸å…¥ä»¥ä¸‹å‘½ä»¤ (æª”åè¨˜å¾—æ›¿æ›è‡ªå·±çš„)ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">adb sideload .\\PixelExperience_herolte-11.0-20210923-1530-OFFICIAL.zip</code></pre></div>\n<p>é€™å€‹æœƒæ˜¯å…¨éƒ¨è€—è²»æœ€ä¹…çš„æ­¥é©Ÿï¼Œè¦æœ‰è€å¿ƒåœ°ç­‰ä¹…ä¸€é»ã€‚</p>\n<p>å®Œæˆå¾Œ Reboot æ²’å•é¡Œçš„è©±ï¼Œç­‰ä¸€å…©åˆ†é˜ (å®˜æ–¹å¥½åƒæ˜¯èªª 15 åˆ†é˜å…§ï¼Œä½†æˆ‘æ²’é‡åˆ°é‚£éº¼ä¹…) æ‡‰è©²å°±å¯ä»¥é€²å…¥åˆ°ç³»çµ±ã€‚é€²å…¥åˆ°ç³»çµ±å¾Œå¯ä»¥å…ˆåšä¸€äº›æ‰‹æ©Ÿçš„åˆå§‹åŒ–ï¼Œç¢ºå®šæ‰‹æ©Ÿä½¿ç”¨ä¸Šæ²’ç”šéº¼å¤§å•é¡Œå¾Œï¼Œå¯ä»¥å…ˆåˆ° Google Play ä¸‹è¼‰ Pokemon Go å†ç¹¼çºŒã€‚</p>\n<h2>å®‰è£ Magisk</h2>\n<p><a href=\"https://magiskmanager.com/\">Magisk</a> æ˜¯æ‰€æœ‰ Root ç©å®¶æ‡‰è©²éƒ½æœƒç”¨åˆ°çš„å¥½æ±è¥¿ï¼Œæ‡‰è©²ä¹Ÿæ˜¯ä¸‹è¼‰æœ€æ–°ç‰ˆå°±å¯ä»¥(ç›®å‰æ˜¯ 25.1)ã€‚ä¸‹è¼‰å¾Œè¦å°‡å‰¯æª”åæ”¹æˆ zipã€‚å¯ä»¥ç”¨æ‰‹æ©Ÿç›´æ¥ä¸‹è¼‰ï¼Œæˆ–æ˜¯ç”¨é›»è…¦ä¸‹è¼‰å¾Œç”¨ adb å‘½ä»¤ push åˆ°æ‰‹æ©Ÿä¸­ï¼Œæˆ‘é‚„æ˜¯é¸æ“‡ç”¨ adbï¼ŒæŒ‡ä»¤å¦‚ä¸‹ã€‚ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"sh\"><pre class=\"language-sh\"><code class=\"language-sh\">adb push magisk.zip /sdcard/Download</code></pre></div>\n<p>é—œæ©Ÿå¾Œå†æ¬¡é€²å…¥ TWRPï¼Œé€™æ¬¡é¸æ“‡ Installï¼Œä¸¦å®‰è£å‰›å‰› push åˆ°æ‰‹æ©Ÿä¸­çš„ Magisk.zipã€‚å®‰è£å¾Œé‡é–‹æ©Ÿï¼Œå†é–‹å•Ÿ Magisk App å®Œæˆå®‰è£ã€‚</p>\n<p>å®‰è£å®Œæˆ Magisk å¾Œï¼Œé€²å…¥ Magisk å³ä¸Šè§’çš„è¨­å®šï¼Œé¸æ“‡éš±è— Magiskï¼Œå–ä¸€å€‹è‡ªå·±å–œæ­¡çš„åå­—ï¼Œé¿å…è¢« Pokemon Go åµæ¸¬åˆ° Magisk çš„å­˜åœ¨ã€‚</p>\n<p>æœ€å¾Œé–‹å•Ÿå…©å€‹é¸é …ï¼šZygiskã€å¼·åˆ¶é»‘åå–®ï¼Œé–‹å•Ÿé€™å…©å€‹é¸é …å¾Œï¼Œéœ€è¦å†æ¬¡é‡é–‹æ©Ÿï¼Œä¸¦åœ¨<strong>è¨­å®šé»‘åå–®é¸é …</strong>ä¸­æŠŠ Pokemon Go (Pokemon Go App å¥½åƒæœ‰å…©å€‹ Package name è¨˜å¾—éƒ½è¦å‹¾) é¸æ“‡èµ·ä¾†ã€‚</p>\n<h2>å®‰è£ SmaliPatcher å’Œ SafetyNet Fix</h2>\n<p>SmaliPatcher æ˜¯ç‚ºäº†è®“ Pokemon Go åµæ¸¬ä¸åˆ°æ‰‹æ©Ÿæ˜¯ç”¨æ¨¡æ“¬çš„ä½ç½®ï¼ŒSafetyNet å¥½åƒæ˜¯è®“ Pokemon Go åµæ¸¬ä¸åˆ°æœ‰ Root (é€™æˆ‘ä¸æ˜¯å¾ˆç¢ºå®šï¼Œæˆ‘åªçŸ¥é“ä¸è£é€²ä¸äº†éŠæˆ²)</p>\n<p>ç¹¼çºŒå°‡æ‰‹æ©Ÿé€£æ©Ÿåˆ°é›»è…¦ï¼Œç”¨é»è…¦ä¸‹è¼‰ <a href=\"https://forum.xda-developers.com/t/module-smali-patcher-7-4.3680053/\">SamliPatcher</a>(ç›®å‰æœ€æ–°æ˜¯ 0.0.7.4)ï¼Œè§£å£“ç¸®å¾Œæ˜¯å€‹åŸ·è¡Œæª”ï¼Œç”¨ç³»çµ±ç®¡ç†å“¡çš„èº«åˆ†åŸ·è¡Œï¼Œä¸¦å‹¾å¦‚åœ–çš„é¸é … (æˆ‘æ˜¯å‹¾äº†é€™ä¸‰å€‹ï¼Œä½†è½èªªå¥½åƒåªå‹¾ç¬¬ä¸€å€‹ä¹Ÿå¯ä»¥)ï¼š</p>\n<p><img src=\"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/5678afd4-b35f-4d1b-94ec-f12496862700/public\" alt=\"img\"></p>\n<p>ç¢ºå®šæ‰‹æ©Ÿé€£æ¥åˆ°é›»è…¦å¾ŒæŒ‰ä¸‹ ADD PATCHï¼Œé€™æœƒéœ€è¦è·‘ä¸€é™£å­ï¼Œä¹Ÿéœ€è¦æœ‰é»å…§å¿ƒçš„ç­‰å€™ï¼Œå®Œæˆæœƒåœ¨åŸ·è¡Œæª”çš„ç›®éŒ„æ‹¿åˆ°ä¸€å€‹æª”åé¡ä¼¼ SmaliPatcherModule çš„å£“ç¸®æª”ï¼Œä¸€æ¨£å¯ä»¥ç”¨å‰›å‰›çš„ adb å‘½ä»¤ push åˆ°æ‰‹æ©Ÿä¸­ï¼Œæœ€å¾Œç”¨ Magisk å®‰è£é€™å€‹æ¨¡çµ„å¾Œé‡é–‹æ©Ÿå³å¯ã€‚</p>\n<blockquote>\n<p>SmaliPatcher æˆªè‡³ç›®å‰æ˜¯ä¸æ”¯æ´ Android 12 çš„ï¼Œæˆ‘å› ç‚ºé€™å€‹å‘å¡äº†æ•´å€‹ä¸‹åˆï¼ŒPokemon Go éƒ½æœƒåµæ¸¬åˆ°æ¨¡æ“¬ä½ç½®</p>\n</blockquote>\n<p>æœ€å¾Œä¸€å€‹è¦å®‰è£çš„æ±è¥¿ï¼Œ<a href=\"https://github.com/kdrag0n/safetynet-fix/releases\">SafetyNet Fix</a> (ç›®å‰ç‰ˆæœ¬æ˜¯ 2.3.1)ï¼Œå¯ç”¨å‰›å‰›çš„æ–¹å¼åœ¨é›»è…¦ä¸‹è¼‰ zip å¾Œ push åˆ°æ‰‹æ©Ÿï¼Œæˆ–æ˜¯ç›´æ¥åœ¨æ‰‹æ©Ÿä¸‹è¼‰ï¼Œç„¶å¾Œé‚„æ˜¯ç”¨ Magisk å®‰è£æ¨¡çµ„é‡é–‹æ©Ÿå³å¯ã€‚</p>\n<h2>è¨­å®š GPS JoyStick</h2>\n<p>ä¸è¦å¾ Google Play ä¸‹è¼‰ GPS JoyStickï¼Œåˆ°ä»–çš„<a href=\"http://gpsjoystick.theappninjas.com/\">å®˜ç¶²</a>ä¸‹è¼‰ Unlock Version (æœ€æ–°ç‰ˆæœ¬æ˜¯ 4.3.2)ã€‚</p>\n<p>é–‹å•Ÿ GPS JoyStick æœƒçœ‹åˆ°ä¸€å€‹éš±ç§æ¨¡å¼ï¼Œé€™ä¹Ÿæ˜¯ç‚ºäº†é¿å…è¢« Pokemon Go åµæ¸¬åˆ°é€™å€‹ App çš„å­˜åœ¨ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯è‡ªå·±é–‹å¿ƒå–å€‹åå­—é‡æ–°å®‰è£ã€‚</p>\n<p>åˆ°è¨­å®šä¸­é—œé–‰ <code class=\"language-text\">å•Ÿç”¨é–“æ¥æ¨¡æ“¬</code>ï¼Œé€™é¸é …é è¨­æ˜¯é–‹å•Ÿçš„ï¼Œä¸€å®šè¦æŠŠå®ƒé—œé–‰ã€‚ç„¶å¾Œåˆ°é–‹ç™¼äººå“¡é¸é …ä¸­æŠŠæ¨¡æ“¬ä½ç½®çš„é¸é …è¨­å®šæˆè‡ªå·±çš„ JoyStick åå­—ã€‚</p>\n<h2>é–‹å•Ÿ Pokemon Go</h2>\n<p>ç„¡é ˆè¨­å®šï¼Œå¤§åŠŸå‘Šæˆ</p>\n<h2>Reference</h2>\n<ul>\n<li><a href=\"https://download.pixelexperience.org/herolte\">Galaxy S7 Pixle Experience</a></li>\n<li><a href=\"https://odindownload.com/\">Odin</a></li>\n<li><a href=\"https://twrp.me/samsung/samsunggalaxys7.html\">TWRP for Samsung Galaxy S7</a></li>\n<li><a href=\"https://magiskmanager.com/\">Magisk</a></li>\n<li><a href=\"https://forum.xda-developers.com/t/module-smali-patcher-7-4.3680053/\">SamliPatcher</a></li>\n<li><a href=\"http://gpsjoystick.theappninjas.com/\">GPS JoyStick</a></li>\n</ul>","rawMarkdownBody":"\nä»Šå¤©æŠŠä¸€å°å¤è€çš„ Samsung Galaxy S7 å¾ Android 6M åˆ·ä¸Š Android 11Rï¼Œä½¿ç”¨ Pixle Experience ROMï¼Œä¸¦å®‰è£ Magisk å’Œ GPS JoyStick ä¾†ç© Pokemon Goã€‚éç¨‹ä¸é›£ï¼Œä¸€æ­¥æ­¥åšå°±ä¸æœƒå‡ºéŒ¯ï¼Œå¾ Andoird 6 å‡åˆ° 11 ä¹Ÿæ²’æœ‰æ—©æˆæ‰‹æ©Ÿæœ‰æ˜é¡¯å¡é “ï¼Œä½©æœä½œè€…ã€‚\n\n<!--more-->\n\né€™æ¬¡çš„å‹•æ©Ÿä¸»è¦æ˜¯ Pokemon Go æœ€è¿‘é–‹å§‹ä¸æ”¯æ´ Android 6 ä»¥ä¸‹çš„è£ç½®éŠç©ï¼Œåªå¥½å‡ç´šåŸæœ¬çš„è£ç½®ã€‚\n\n## æ­¥é©Ÿæ¦‚è¦½\n\n1. åˆ·å…¥ TWRP\n2. åˆ·å…¥ Pixle Experience\n3. å®‰è£ Magisk\n4. å®‰è£ SmaliPatcher\n5. å®‰è£ SafetyNet Fix\n6. å®‰è£ä¸¦è¨­å®š GPS JoyStick\n7. ç©\n\næ‰‹æ©Ÿæ‡‰è©²ä¸ä¸€å®šè¦æ˜¯ S7 ä¹Ÿå¯ä»¥ç…§è‘—é€™äº›æ€è·¯å®Œæˆã€‚\n\n## æ‰‹æ©Ÿäº‹å‰æº–å‚™\n\né–‹å•Ÿ USB åµéŒ¯å’Œ OEM è§£é–ã€‚\n\nçœ‹å®Œæœ¬æ–‡ï¼Œä¸¦å¯ä»¥å…ˆæŠŠæœƒç”¨åˆ°çš„æ±è¥¿éƒ½ä¸‹è¼‰ä¸‹ä¾†ã€‚\n\n## åˆ·å…¥ TWRP\n\n1. é€²å…¥ Download Mode\n2. ç”¨ Odin å¯«å…¥ TWRP Recovery\n3. é€²å…¥ TWRP\n\nä¸‹è¼‰æœ€æ–°çš„ Odin ç‰ˆæœ¬ (ç›®å‰æ˜¯ 3.13.1)ï¼Œ[Odin å®˜ç¶²](https://odindownload.com/)\n\nä¸‹è¼‰ [TWRP for Samsung Galaxy S7](https://twrp.me/samsung/samsunggalaxys7.html) (ç›®å‰æ˜¯ 3.6.2)ã€‚\n\nå°‡æ‰‹æ©Ÿé€£ä¸Šé›»è…¦ï¼Œä¸¦é—œæ©Ÿå¾Œé€²å…¥ Download Mode (POWER + VOL DOWN + HOME)ã€‚\n\n![img](https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/4d367c79-5c09-4118-6b49-f09f918b8600/public)\n\né–‹å•Ÿ Odin ä¸¦é» AP é¸æ“‡åˆ·å…¥ TWRP æª”æ¡ˆï¼Œé—œé–‰ Auto Reboot å¾Œ Startï¼Œæ‡‰è©²åªè¦å¹¾ç§’å°±æœƒå®Œæˆã€‚\n\n![img](https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/dacd3ce6-e43e-490d-0a1f-4f6b430e7800/public)\n\nå¼·åˆ¶é—œæ©Ÿ (POWER + VOL DOWN + HOME) è¢å¹•é»‘æ‰å¾Œé¦¬ä¸ŠæŠŠéŸ³é‡éµä¸‹æ›æˆéŸ³é‡éµä¸Š (POWER + VOL UP + HOME) é€²å…¥ Recovery Modeï¼Œå¦‚æœåˆ°ç›®å‰ç‚ºæ­¢éƒ½æˆåŠŸçš„è©±æ‡‰è©²å°±æœƒçœ‹åˆ° TWRP çš„ä»‹é¢ã€‚\n\n## åˆ·å…¥ Pixle Experience ROM\n\nä¸‹è¼‰ [Galaxy S7 Pixle Experience](https://download.pixelexperience.org/herolte)ï¼Œç›®å‰æœ€æ–°ç‰ˆæœ¬æ˜¯ (20210923-1530)ã€‚\n\né€²å…¥ TWRP å…ˆ Wipe å››å€‹åˆ†å€ï¼š\n\n![img](https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/eed93d6e-153c-43d5-eac0-7eceeee50b00/public)\n\nå¦‚æœ Wipe å¤±æ•—ä¸”æ˜¯å› ç‚ºæ²’è¾¦æ³• mount dataï¼Œå¯ä»¥åƒè€ƒ[é€™ç¯‡æ–‡ç« ](https://forum.xda-developers.com/t/how-to-fix-unable-to-mount-data-internal-storage-0mb-in-twrp-permanently.3830897/)ã€‚\n\næ¥ä¸‹ä¾†å¯ä»¥é¸æ“‡å…ˆå°‡ ROM æ”¾å…¥ SD å¡ï¼Œæˆ–æ˜¯ç›´æ¥ç”¨ adb å‘½ä»¤åˆ· (é›»è…¦ç•¶ç„¶è¦è£å¥½ adbï¼Œæœ€å¿«çš„æ–¹æ³•é‚„æ˜¯ç”¨ Chocolatey)ï¼Œæˆ‘è‡ªå·±æ˜¯ç›´æ¥ç”¨ adb çš„å‘½ä»¤åˆ·ã€‚åœ¨ TWRP ä¸»ç•«é¢é¸ Advancedï¼Œç„¶å¾Œä½¿ç”¨ ADB Sideloadã€‚\n\né–‹å•Ÿé›»è…¦ Terminalï¼Œcd åˆ°æ”¾å‰›å‰›ä¸‹è¼‰çš„ ROM çš„ç›®éŒ„ï¼Œä¸¦è¼¸å…¥ä»¥ä¸‹å‘½ä»¤ (æª”åè¨˜å¾—æ›¿æ›è‡ªå·±çš„)ï¼š\n\n```sh\nadb sideload .\\PixelExperience_herolte-11.0-20210923-1530-OFFICIAL.zip\n```\n\né€™å€‹æœƒæ˜¯å…¨éƒ¨è€—è²»æœ€ä¹…çš„æ­¥é©Ÿï¼Œè¦æœ‰è€å¿ƒåœ°ç­‰ä¹…ä¸€é»ã€‚\n\nå®Œæˆå¾Œ Reboot æ²’å•é¡Œçš„è©±ï¼Œç­‰ä¸€å…©åˆ†é˜ (å®˜æ–¹å¥½åƒæ˜¯èªª 15 åˆ†é˜å…§ï¼Œä½†æˆ‘æ²’é‡åˆ°é‚£éº¼ä¹…) æ‡‰è©²å°±å¯ä»¥é€²å…¥åˆ°ç³»çµ±ã€‚é€²å…¥åˆ°ç³»çµ±å¾Œå¯ä»¥å…ˆåšä¸€äº›æ‰‹æ©Ÿçš„åˆå§‹åŒ–ï¼Œç¢ºå®šæ‰‹æ©Ÿä½¿ç”¨ä¸Šæ²’ç”šéº¼å¤§å•é¡Œå¾Œï¼Œå¯ä»¥å…ˆåˆ° Google Play ä¸‹è¼‰ Pokemon Go å†ç¹¼çºŒã€‚\n\n## å®‰è£ Magisk\n\n[Magisk](https://magiskmanager.com/) æ˜¯æ‰€æœ‰ Root ç©å®¶æ‡‰è©²éƒ½æœƒç”¨åˆ°çš„å¥½æ±è¥¿ï¼Œæ‡‰è©²ä¹Ÿæ˜¯ä¸‹è¼‰æœ€æ–°ç‰ˆå°±å¯ä»¥(ç›®å‰æ˜¯ 25.1)ã€‚ä¸‹è¼‰å¾Œè¦å°‡å‰¯æª”åæ”¹æˆ zipã€‚å¯ä»¥ç”¨æ‰‹æ©Ÿç›´æ¥ä¸‹è¼‰ï¼Œæˆ–æ˜¯ç”¨é›»è…¦ä¸‹è¼‰å¾Œç”¨ adb å‘½ä»¤ push åˆ°æ‰‹æ©Ÿä¸­ï¼Œæˆ‘é‚„æ˜¯é¸æ“‡ç”¨ adbï¼ŒæŒ‡ä»¤å¦‚ä¸‹ã€‚ï¼š\n\n```sh\nadb push magisk.zip /sdcard/Download\n```\n\né—œæ©Ÿå¾Œå†æ¬¡é€²å…¥ TWRPï¼Œé€™æ¬¡é¸æ“‡ Installï¼Œä¸¦å®‰è£å‰›å‰› push åˆ°æ‰‹æ©Ÿä¸­çš„ Magisk.zipã€‚å®‰è£å¾Œé‡é–‹æ©Ÿï¼Œå†é–‹å•Ÿ Magisk App å®Œæˆå®‰è£ã€‚\n\nå®‰è£å®Œæˆ Magisk å¾Œï¼Œé€²å…¥ Magisk å³ä¸Šè§’çš„è¨­å®šï¼Œé¸æ“‡éš±è— Magiskï¼Œå–ä¸€å€‹è‡ªå·±å–œæ­¡çš„åå­—ï¼Œé¿å…è¢« Pokemon Go åµæ¸¬åˆ° Magisk çš„å­˜åœ¨ã€‚\n\næœ€å¾Œé–‹å•Ÿå…©å€‹é¸é …ï¼šZygiskã€å¼·åˆ¶é»‘åå–®ï¼Œé–‹å•Ÿé€™å…©å€‹é¸é …å¾Œï¼Œéœ€è¦å†æ¬¡é‡é–‹æ©Ÿï¼Œä¸¦åœ¨**è¨­å®šé»‘åå–®é¸é …**ä¸­æŠŠ Pokemon Go (Pokemon Go App å¥½åƒæœ‰å…©å€‹ Package name è¨˜å¾—éƒ½è¦å‹¾) é¸æ“‡èµ·ä¾†ã€‚\n\n## å®‰è£ SmaliPatcher å’Œ SafetyNet Fix\n\nSmaliPatcher æ˜¯ç‚ºäº†è®“ Pokemon Go åµæ¸¬ä¸åˆ°æ‰‹æ©Ÿæ˜¯ç”¨æ¨¡æ“¬çš„ä½ç½®ï¼ŒSafetyNet å¥½åƒæ˜¯è®“ Pokemon Go åµæ¸¬ä¸åˆ°æœ‰ Root (é€™æˆ‘ä¸æ˜¯å¾ˆç¢ºå®šï¼Œæˆ‘åªçŸ¥é“ä¸è£é€²ä¸äº†éŠæˆ²)\n\nç¹¼çºŒå°‡æ‰‹æ©Ÿé€£æ©Ÿåˆ°é›»è…¦ï¼Œç”¨é»è…¦ä¸‹è¼‰ [SamliPatcher](https://forum.xda-developers.com/t/module-smali-patcher-7-4.3680053/)(ç›®å‰æœ€æ–°æ˜¯ 0.0.7.4)ï¼Œè§£å£“ç¸®å¾Œæ˜¯å€‹åŸ·è¡Œæª”ï¼Œç”¨ç³»çµ±ç®¡ç†å“¡çš„èº«åˆ†åŸ·è¡Œï¼Œä¸¦å‹¾å¦‚åœ–çš„é¸é … (æˆ‘æ˜¯å‹¾äº†é€™ä¸‰å€‹ï¼Œä½†è½èªªå¥½åƒåªå‹¾ç¬¬ä¸€å€‹ä¹Ÿå¯ä»¥)ï¼š\n\n![img](https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/5678afd4-b35f-4d1b-94ec-f12496862700/public)\n\nç¢ºå®šæ‰‹æ©Ÿé€£æ¥åˆ°é›»è…¦å¾ŒæŒ‰ä¸‹ ADD PATCHï¼Œé€™æœƒéœ€è¦è·‘ä¸€é™£å­ï¼Œä¹Ÿéœ€è¦æœ‰é»å…§å¿ƒçš„ç­‰å€™ï¼Œå®Œæˆæœƒåœ¨åŸ·è¡Œæª”çš„ç›®éŒ„æ‹¿åˆ°ä¸€å€‹æª”åé¡ä¼¼ SmaliPatcherModule çš„å£“ç¸®æª”ï¼Œä¸€æ¨£å¯ä»¥ç”¨å‰›å‰›çš„ adb å‘½ä»¤ push åˆ°æ‰‹æ©Ÿä¸­ï¼Œæœ€å¾Œç”¨ Magisk å®‰è£é€™å€‹æ¨¡çµ„å¾Œé‡é–‹æ©Ÿå³å¯ã€‚\n\n> SmaliPatcher æˆªè‡³ç›®å‰æ˜¯ä¸æ”¯æ´ Android 12 çš„ï¼Œæˆ‘å› ç‚ºé€™å€‹å‘å¡äº†æ•´å€‹ä¸‹åˆï¼ŒPokemon Go éƒ½æœƒåµæ¸¬åˆ°æ¨¡æ“¬ä½ç½®\n\næœ€å¾Œä¸€å€‹è¦å®‰è£çš„æ±è¥¿ï¼Œ[SafetyNet Fix](https://github.com/kdrag0n/safetynet-fix/releases) (ç›®å‰ç‰ˆæœ¬æ˜¯ 2.3.1)ï¼Œå¯ç”¨å‰›å‰›çš„æ–¹å¼åœ¨é›»è…¦ä¸‹è¼‰ zip å¾Œ push åˆ°æ‰‹æ©Ÿï¼Œæˆ–æ˜¯ç›´æ¥åœ¨æ‰‹æ©Ÿä¸‹è¼‰ï¼Œç„¶å¾Œé‚„æ˜¯ç”¨ Magisk å®‰è£æ¨¡çµ„é‡é–‹æ©Ÿå³å¯ã€‚\n\n## è¨­å®š GPS JoyStick\n\nä¸è¦å¾ Google Play ä¸‹è¼‰ GPS JoyStickï¼Œåˆ°ä»–çš„[å®˜ç¶²](http://gpsjoystick.theappninjas.com/)ä¸‹è¼‰ Unlock Version (æœ€æ–°ç‰ˆæœ¬æ˜¯ 4.3.2)ã€‚\n\né–‹å•Ÿ GPS JoyStick æœƒçœ‹åˆ°ä¸€å€‹éš±ç§æ¨¡å¼ï¼Œé€™ä¹Ÿæ˜¯ç‚ºäº†é¿å…è¢« Pokemon Go åµæ¸¬åˆ°é€™å€‹ App çš„å­˜åœ¨ï¼Œæ‰€ä»¥ä¹Ÿæ˜¯è‡ªå·±é–‹å¿ƒå–å€‹åå­—é‡æ–°å®‰è£ã€‚\n\nåˆ°è¨­å®šä¸­é—œé–‰ `å•Ÿç”¨é–“æ¥æ¨¡æ“¬`ï¼Œé€™é¸é …é è¨­æ˜¯é–‹å•Ÿçš„ï¼Œä¸€å®šè¦æŠŠå®ƒé—œé–‰ã€‚ç„¶å¾Œåˆ°é–‹ç™¼äººå“¡é¸é …ä¸­æŠŠæ¨¡æ“¬ä½ç½®çš„é¸é …è¨­å®šæˆè‡ªå·±çš„ JoyStick åå­—ã€‚\n\n## é–‹å•Ÿ Pokemon Go\n\nç„¡é ˆè¨­å®šï¼Œå¤§åŠŸå‘Šæˆ\n\n## Reference\n\n- [Galaxy S7 Pixle Experience](https://download.pixelexperience.org/herolte)\n- [Odin](https://odindownload.com/)\n- [TWRP for Samsung Galaxy S7](https://twrp.me/samsung/samsunggalaxys7.html)\n- [Magisk](https://magiskmanager.com/)\n- [SamliPatcher](https://forum.xda-developers.com/t/module-smali-patcher-7-4.3680053/)\n- [GPS JoyStick](http://gpsjoystick.theappninjas.com/)\n","fileAbsolutePath":"/home/runner/work/Blog/Blog/src/posts/Android/S7 Poekmon Root.md","excerpt":"ä»Šå¤©æŠŠä¸€å°å¤è€çš„ Samsung Galaxy S7 å¾ Android 6M åˆ·ä¸Š Android 11Rï¼Œä½¿ç”¨ Pixle Experience ROMï¼Œä¸¦å®‰è£ Magisk å’Œ GPS JoyStick ä¾†ç© Pokemon Goã€‚éç¨‹ä¸é›£ï¼Œä¸€æ­¥æ­¥åšå°±ä¸æœƒå‡ºéŒ¯ï¼Œå¾ Andoird 6 å‡åˆ° 11 ä¹Ÿæ²’æœ‰æ—©æˆæ‰‹æ©Ÿæœ‰æ˜é¡¯å¡é “ï¼Œä½©æœä½œè€…ã€‚ é€™æ¬¡çš„å‹•æ©Ÿä¸»è¦æ˜¯ Pokemon Go æœ€è¿‘é–‹å§‹ä¸æ”¯æ´ â€¦","frontmatter":{"title":"S7 åˆ· Android 11 + Pokemon Go é£›äººç°¡å–®ç´€éŒ„","date":"2022-07-17T13:39:39.000Z","draft":false,"tags":["android","samsung","s7","twrp","pokemon","joystick","gps","pixle","magisk","odin"],"image":"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/d0d9494e-6a67-4237-77aa-c4d7f059b400/public","description":null}}},{"node":{"id":"497c64d1-c2d9-57b6-bd9f-9c60e6829fa5","html":"<p>ç´€éŒ„ä¸€ä¸‹ç¶²ç«™æˆæ•ˆ</p>\n<!--more-->\n<p><img src=\"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/7e18d41e-67cc-45cb-92fc-2e1373ba2a00/public\" alt=\"img\"></p>\n<p>å…©ç¯‡æˆæ•ˆæ„å¤–å¥½çš„å‘</p>\n<blockquote>\n<p>å»¢æ–‡æ²’éŒ¯</p>\n</blockquote>\n<h2>Reference</h2>\n<ul>\n<li><a href=\"https://search.google.com/\">Google Search Console</a></li>\n</ul>","rawMarkdownBody":"\nç´€éŒ„ä¸€ä¸‹ç¶²ç«™æˆæ•ˆ\n\n<!--more-->\n\n![img](https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/7e18d41e-67cc-45cb-92fc-2e1373ba2a00/public)\n\nå…©ç¯‡æˆæ•ˆæ„å¤–å¥½çš„å‘\n\n> å»¢æ–‡æ²’éŒ¯\n\n## Reference\n\n- [Google Search Console](https://search.google.com/)\n","fileAbsolutePath":"/home/runner/work/Blog/Blog/src/posts/Blog/20220708 review.md","excerpt":"ç´€éŒ„ä¸€ä¸‹ç¶²ç«™æˆæ•ˆ img å…©ç¯‡æˆæ•ˆæ„å¤–å¥½çš„å‘ å»¢æ–‡æ²’éŒ¯ Reference Google Search Console","frontmatter":{"title":"æœ¬ç«™ 2022/7/8 æˆæ•ˆç´€éŒ„","date":"2022-07-08T05:24:40.177Z","draft":false,"tags":["blog","gatsby","google","search"],"image":"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/46de886b-02a6-48d1-e5f5-1486881dcc00/public","description":null}}},{"node":{"id":"22235767-e1e6-5ec4-a8c0-8f1428c52404","html":"<p>Cloudflare Workers ä¹Ÿæ˜¯ Cloudflare çš„ä½›å¿ƒæœå‹™ä¹‹ä¸€ï¼Œå¯ä»¥æŠŠ node ç¨‹å¼éƒ¨ç½²åˆ° Cloudflare ä¸Šçš„çœ¾å¤šç¯€é»ï¼Œæ•ˆèƒ½ä¹Ÿä¸ä¿—ï¼Œæ¯å¤©é‚„æœ‰ 100,000 æ¬¡çš„å…è²»å‘¼å«ï¼Œä¹Ÿæ²’æœ‰å†·å•Ÿå‹•çš„å•é¡Œï¼Œå°æµé‡ä¸é«˜çš„ç¶²é ä¾†èªªå®Œå…¨å¤ ç”¨ã€‚å¦å¤–ï¼Œé‚„æœ‰ Workers KV å¯ä»¥ç”¨ä¾†å„²å­˜è³‡æ–™ï¼Œé€™å°±å¯ä»¥å¯«å‡ºç°¡å–®çš„å‹•æ…‹ç¶²é ï¼Œç”šè‡³æ˜¯ä¸€äº›æ›´è¤‡é›œçš„æ‡‰ç”¨ã€‚ä»Šå¤©å°±ä¾†å¯«ä¸€å€‹ Serverless çš„çŸ­ç¶²å€æœå‹™ï¼Œä¸¦æŠŠè³‡æ–™å­˜åœ¨ KV ä¸­ï¼Œå°±æˆ‘ç›®å‰è‡ªå·±æ¸¬è©¦ä¸‹ä¾†ï¼ŒWorkers çš„æ•ˆç‡çœŸçš„æ²’è©±èªªã€‚</p>\n<!--more-->\n<h2>Workers Playground</h2>\n<p>å¦‚æœæƒ³è¦åœ¨ç¶²é ä¸­å…ˆè©¦è©¦çœ‹ Workersï¼Œå¯ä»¥åˆ° <a href=\"https://cloudflareworkers.com/\">Cloudflare Workers</a> é€™å€‹ç¶²ç«™ã€‚</p>\n<p>æœƒæœ‰ä¸€å€‹é è¨­çš„æ¨¡æ¿é•·é€™æ¨£ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"fetch\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">respondWith</span><span class=\"token punctuation\">(</span><span class=\"token function\">handleRequest</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token comment\">/**\n * Fetch and log a given request object\n * @param {Request} request\n */</span>\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">handleRequest</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">request</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Got request\"</span><span class=\"token punctuation\">,</span> request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Got response\"</span><span class=\"token punctuation\">,</span> response<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>è®“æˆ‘å€‘å…ˆä¾†ç†è§£ä¸€ä¸‹ç¨‹å¼ç¢¼ã€‚</p>\n<p>å¯ä»¥çœ‹åˆ°ç¨‹å¼æœ‰å…©å€‹ functionï¼Œå…¶ä¸­ <code class=\"language-text\">addEventListener(...)</code> å°±æ˜¯ç¨‹å¼çš„å…¥å£ï¼Œç•¶ Workers æ”¶åˆ° Request ä¹‹å¾Œï¼Œå°±æœƒå‚³å…¥ä½ çµ¦ä»–çš„ functionï¼Œç„¶å¾Œå†æ±ºå®šè¦ç”¨ä»€éº¼ Response å›å‚³åˆ° Clientï¼Œé€™è£¡ä»–å¯«äº†ä¸€å€‹ <code class=\"language-text\">handleRequest</code> çš„ function ä¾†è™•ç†ã€‚æ‰€ä»¥é€™å€‹ç¨‹å¼ç¢¼å¯¦éš›ä¸Šåšçš„äº‹ï¼Œå°±åªæœ‰æŠŠ Request å’Œ Response çµ¦ log å‡ºä¾†ï¼Œå›å‚³åŸæœ¬çš„ç¶²é çš„æ¨£å­ä¸åšä»»ä½•æ›´å‹•ã€‚</p>\n<p>ä¸‹åœ–æ˜¯ Workers åœ¨ Cloudflare ä¸Šçš„é‹è¡Œé †åºï¼Œå¯ä»¥çœ‹åˆ° Workers è¢«æ”¾åœ¨æœ€å¾Œä¸€å€‹ï¼Œä¹Ÿå°±æ˜¯æœ€å¾Œä¸€å€‹æ±ºå®šè¦å›å‚³ä»€éº¼å…§å®¹çµ¦ User çš„åœ°æ–¹ï¼Œä¹Ÿå¯ä»¥ç†è§£ç‚ºå¯ä»¥åœ¨é€™è£¡å°åŸæœ¬çš„ Response åšæœ€å¾Œçš„æ›´å‹•ï¼Œå†å›å‚³çµ¦ Clientã€‚</p>\n<p>æ‰€ä»¥é€™å€‹ Playground ä¸Šå¯ä»¥è¼¸å…¥ä»»æ„çš„ URLï¼Œä¾†é è¦½ä½ çš„ Workers åœ¨ä»»ä½•ä¸€å€‹ç¶²ç«™ä¸Šï¼Œæœƒå° Response åšçš„æ›´å‹•ã€‚</p>\n<p><img src=\"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/32bd1508-ba78-4e94-76a0-adec503fe000/public\" alt=\"img\"></p>\n<p>ä¹Ÿå°±æ˜¯èªªå¦‚æœæŠŠç¨‹å¼æ”¹æˆä¸‹é¢é€™æ¨£ï¼Œå°±å¯ä»¥ç™¼ç¾ä»»æ„ç¶²ç«™éƒ½æœƒè®Šæˆ Google çš„æ¨¡æ¨£ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token function\">addEventListener</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"fetch\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">event</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  event<span class=\"token punctuation\">.</span><span class=\"token function\">respondWith</span><span class=\"token punctuation\">(</span><span class=\"token function\">handleRequest</span><span class=\"token punctuation\">(</span>event<span class=\"token punctuation\">.</span>request<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">async</span> <span class=\"token keyword\">function</span> <span class=\"token function\">handleRequest</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">request</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token function\">fetch</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"https://google.com\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><img src=\"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/d7409a8b-8203-4e23-6491-309a4cc5b500/public\" alt=\"img\"></p>\n<p>ç†è§£å¾Œå°±æœƒç™¼ç¾ï¼Œå…¶å¯¦ Workers å¯ä»¥å°ç¶²é æœ‰å³æ™‚æ€§çš„æ›´æ”¹ï¼Œä¹Ÿå°±æ˜¯èªªå¯ä»¥å°ç¾æœ‰çš„ç¶²é åŠ ä¸Šæ–°åŠŸèƒ½ï¼Œæˆ–æ˜¯åœ¨ä¸æ›´å‹•åŸæœ¬ç¶²é çš„æƒ…æ³ä¸‹å»ä¿® bugã€‚</p>\n<h2>Wrangler</h2>\n<p>Wrangler æ˜¯ç®¡ç† Workers æœƒç”¨åˆ°çš„ cli å·¥å…·ï¼Œé›–ç„¶ä¸å®‰è£ä¹Ÿæ˜¯å¯ä»¥åœ¨ç¶²é ä¸­æ’°å¯« Workers ï¼Œä½†æ˜¯åŠŸèƒ½å°±æœƒå°‘å¾ˆå¤šï¼Œæ‰€ä»¥é‚„æ˜¯å»ºè­°å®‰è£ä¸€ä¸‹ã€‚é€™è£¡æ˜¯å®˜æ–¹çš„ Repo <a href=\"https://github.com/cloudflare/wrangler2\">cloudflare/wrangler2</a>ã€‚</p>\n<p>ç”¨ npm å®‰è£åˆ° Globalï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">npm</span> i @cloudflare/wrangler -g</code></pre></div>\n<p>é‚„æ˜¯å»ºè­°å»å®˜æ–¹ Repo çœ‹ä¸‹æœ‰æ²’æœ‰å…¶ä»–æ³¨æ„äº‹é …</p>\n<p>å®‰è£å®Œæˆå¾Œè¦ç™»å…¥ Cloudflare å¸³è™Ÿï¼Œ<code class=\"language-text\">wrangler login</code>ï¼Œå†ç”¨ç€è¦½å™¨ç™»å…¥å³å¯ã€‚</p>\n<h2>Init Project</h2>\n<p><code class=\"language-text\">wrangler init &lt;project-name></code> å‰µå»ºæ–°çš„å°ˆæ¡ˆï¼Œé€™ç•¶ä¸­ Wrangler æœƒå•ä¸€äº›å•é¡Œï¼Œå¯ä»¥æŒ‰ç…§è‡ªå·±çš„éœ€æ±‚æ±ºå®šã€‚</p>\n<p>init å®Œæˆå¾Œï¼Œå¯ä»¥çœ‹åˆ°è‡ªå‹•ç”¢ç”Ÿäº†ä¸€äº›æª”æ¡ˆï¼ŒåŸºæœ¬ä¸Šæœƒç”¨åˆ°çš„åªæœ‰ <code class=\"language-text\">wrangler.toml</code> å’Œ <code class=\"language-text\">index.js</code> å…©å€‹æª”æ¡ˆã€‚</p>\n<p>ç¾åœ¨å¯ä»¥å…ˆåœ¨ Terminal ä¸­è¼¸å…¥ <code class=\"language-text\">wrangler dev</code>ï¼Œå°±å¯ä»¥è®“ Workers è·‘åœ¨æœ¬åœ°ã€‚</p>\n<h3>Bug</h3>\n<p>å› ç‚ºæˆ‘çš„ Cloudflare ä¸€æ¬¡ç™»å…¥å¤šå€‹ Userï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨ wrangler çš„ <strong>2.0.14</strong> æ™‚å€™æœƒå‡º bug ç›´æ¥é–ƒé€€ï¼Œæˆ‘è§£æ±ºçš„æ–¹å¼æ˜¯ç›´æ¥åœ¨ <code class=\"language-text\">wrangler.toml</code> ä¸­è¼¸å…¥ <code class=\"language-text\">account_id</code> ä¾†é¿å… wrangler æœƒéœ€è¦é¸æ“‡å¸³è™Ÿçš„å•é¡Œã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"toml\"><pre class=\"language-toml\"><code class=\"language-toml\"><span class=\"token key property\">account_id</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"xxxxxxxxxxxxxxx\"</span></code></pre></div>\n<h2>Cloudflare Workers KV</h2>\n<p>çœ‹åˆ°åå­—å–ä½œ KVï¼Œç›´è§€çš„å°±æ˜¯è¡¨ç¤º <code class=\"language-text\">key-value</code> éµå€¼å°ï¼Œç¼ºé»æ˜¯ Key åªèƒ½å°ä¸Šä¸€å€‹ Valueï¼Œä¸èƒ½è¦å·¢ç‹€çš„ Value (åƒæ˜¯ Json é‚£æ¨£)ï¼Œè§£æ±ºçš„æ–¹å¼å…¶å¯¦ä¹Ÿæ˜¯ä¸é›£ï¼Œå¯ä»¥ç›´æ¥åœ¨ Value ä¸­å­˜ä¸Šæ•´çš„ Json æª”æ¡ˆï¼Œä½†åœ¨æœ¬æ–‡ä¸æœƒå¤šåšèªªæ˜ï¼Œå¯ä»¥è‡ªå·±ç ”ç©¶çœ‹çœ‹ã€‚</p>\n<p>å¦å¤– Cloudflare ä¹Ÿæœ‰æåˆ°ï¼ŒKV å­˜å–åœ¨å…¨çƒå¯èƒ½ä¸æ˜¯å³æ™‚æ€§çš„ï¼Œå¥½åƒæ˜¯åªä¿è­‰ 60 ç§’å¾ŒæœƒåŒæ­¥åˆ°æ‰€æœ‰ Serverï¼Œé›–ç„¶æˆ‘è¦ºå¾—æœ€æ…¢æ‡‰è©²ä¹Ÿæ˜¯ 5 å…§ç§’å•¦ï¼Œæˆ‘å¾ä¾†æ²’æœ‰æ„Ÿå—åˆ°å»¶é²éï¼Œä½†å¦‚æœå°å³æ™‚æ€§æœ‰ç–‘æ…®çš„å°ˆæ¡ˆå¯èƒ½ä¹Ÿè¦æ³¨æ„ä¸€ä¸‹ã€‚</p>\n<p>ä¸‹é¢å°±ä¾†å‰µå»ºä¸€å€‹ KV namespaceï¼Œé€™å°±æ˜¯ä¸€å€‹ Database çš„åŸºæœ¬å–®ä½ï¼Œç›®å‰ Cloudflare æ˜¯å…è¨±ä¸€å€‹å¸³è™Ÿæœ‰ 100 å€‹ KV namespaceï¼Œæ‰€ä»¥æ­£å¸¸ä¾†èªªæ‡‰è©²ä¹Ÿä¸ç”¨æ“”å¿ƒæœƒç”¨å®Œã€‚ä¸‹é¢ç”¨ <code class=\"language-text\">URLS</code> ç•¶ä½œ namespace çš„åç¨±ï¼Œå› ç‚ºæˆ‘å€‘æ˜¯è¦å­˜çŸ­ç¶²å€çš„è³‡æ–™ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ wrangler kv:namespace create <span class=\"token string\">\"URLS\"</span>\n\nğŸŒ€  Creating namespace with title <span class=\"token string\">\"my-site-MY_KV\"</span>\nâœ¨  Success<span class=\"token operator\">!</span>\nAdd the following to your configuration file:\nkv_namespaces <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> binding <span class=\"token operator\">=</span> <span class=\"token string\">\"URLS\"</span>, <span class=\"token function\">id</span> <span class=\"token operator\">=</span> <span class=\"token string\">\"xxxxxxxxxxxxxxxxxxxxxxx\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>ç„¶å¾Œ wrangler æœƒæœ‰å€‹çµ¦ä½ ä¸€å€‹ binding å’Œ idï¼Œå°±ç›´æ¥è¤‡è£½è²¼ä¸Šåˆ° <code class=\"language-text\">wrangler.tmol</code> ä¸­å³å¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"toml\"><pre class=\"language-toml\"><code class=\"language-toml\"><span class=\"token key property\">kv_namespaces</span> <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span>\n  <span class=\"token punctuation\">{</span> <span class=\"token key property\">binding</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"URLS\"</span><span class=\"token punctuation\">,</span> <span class=\"token key property\">id</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"xxxxxxxxxxxxxxxxxxxxxxx\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>å¦‚æœè¦åœ¨ wrangler çš„ dev æ¨¡å¼ä¸­æ¸¬è©¦ KVï¼Œå°±å¤šç”³è«‹ä¸€å€‹ Preview KVï¼Œä¾†é¿å…å°å·²ç¶“ä¸Šç·šçš„æœå‹™é€ æˆå½±éŸ¿ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">$ wrangler kv:namespace create <span class=\"token string\">\"URLS\"</span> --preview\n\nâ›…ï¸ wrangler <span class=\"token number\">2.0</span>.14\n--------------------\nğŸŒ€ Creating namespace with title <span class=\"token string\">\"URLS\"</span>\nâœ¨ Success<span class=\"token operator\">!</span>\nAdd the following to your configuration <span class=\"token function\">file</span> <span class=\"token keyword\">in</span> your kv_namespaces array:\n<span class=\"token punctuation\">{</span> binding <span class=\"token operator\">=</span> <span class=\"token string\">\"URLS\"</span>, preview_id <span class=\"token operator\">=</span> <span class=\"token string\">\"xxxxxxxxxxxxxxxxxxxx2\"</span> <span class=\"token punctuation\">}</span></code></pre></div>\n<p>é€™æ¬¡æŠŠ <code class=\"language-text\">preview_id</code> åŠ åœ¨åŸæœ¬çš„ id å¾Œæ–¹å³å¯ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"toml\"><pre class=\"language-toml\"><code class=\"language-toml\"><span class=\"token key property\">kv_namespaces</span> <span class=\"token punctuation\">=</span> <span class=\"token punctuation\">[</span>\n    <span class=\"token punctuation\">{</span> <span class=\"token key property\">binding</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"URLS\"</span><span class=\"token punctuation\">,</span> <span class=\"token key property\">id</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"xxxxxxxxxxxxxxxxxxxx\"</span><span class=\"token punctuation\">,</span> <span class=\"token key property\">preview_id</span> <span class=\"token punctuation\">=</span> <span class=\"token string\">\"xxxxxxxxxxxxxxxxxxxx2\"</span> <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">]</span></code></pre></div>\n<p>è¨­å®šå¥½å¾Œï¼Œwrangler æœƒç›´æ¥æŠŠä½ å‰›å‰›å–çš„åå­—ç›´æ¥ç”¨ç’°å¢ƒè®Šæ•¸ (ENV) å‚³å…¥ï¼Œå…·é«”çš„ä½¿ç”¨æ–¹å¼å¯ä»¥ç¹¼çºŒå¾€ä¸‹çœ‹ã€‚</p>\n<h2>Routing</h2>\n<p>ç‚ºäº†æ–¹ä¾¿ç­‰ç­‰æˆ‘å€‘è™•ç†å‚³å…¥çš„ Routingï¼Œæˆ‘å€‘å…ˆä¾†å®‰è£ä¸€å€‹ npm å¥—ä»¶ã€‚å°ä½ æ²’çœ‹éŒ¯ï¼ŒWorkers ä¹Ÿæ˜¯æ”¯æ´ npm å¥—ä»¶çš„ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token function\">yarn</span> <span class=\"token function\">add</span> itty-router\n\n<span class=\"token function\">npm</span> i itty-router</code></pre></div>\n<p>é€™æ¨£ç­‰ç­‰å°±å¯ä»¥ç”¨ itty-router ä¾†è™•ç†å‚³å…¥çš„ requestã€‚</p>\n<p>æˆ‘å€‘å…ˆå°‡ Handle Request å®Œå…¨ä¸Ÿçµ¦çš„ itty-router ä¾†è™•ç†ï¼Œå°‡ index.js æ”¹æˆä¸‹æ–¹é€™æ¨£ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Router <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"itty-router\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> <span class=\"token function\">Router</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">fetch</span><span class=\"token operator\">:</span> router<span class=\"token punctuation\">.</span>handle<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>å¯ä»¥çœ‹åˆ°ç›´æ¥ export router çš„ handle æ–¹æ³•ï¼Œé€™æ¨£å°±å®Œå…¨æŠŠ Requse äº¤çµ¦ Router ä¾†è™•ç†ã€‚æˆ‘å€‘å…ˆå°‡ root å›å‚³ Hello æ¸¬è©¦çœ‹çœ‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> Router <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"itty-router\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> router <span class=\"token operator\">=</span> <span class=\"token function\">Router</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\nrouter<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> env</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Response</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Hello Workers\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token number\">200</span><span class=\"token punctuation\">,</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token literal-property property\">fetch</span><span class=\"token operator\">:</span> router<span class=\"token punctuation\">.</span>handle<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ç¾åœ¨å¯ä»¥ <code class=\"language-text\">wrangler dev</code> ä¸€ä¸‹ï¼Œç„¶å¾Œåˆ° <code class=\"language-text\">loclahost:8787/</code> çœ‹çœ‹æœƒä¸æœƒå›å‚³ Hello Workersã€‚</p>\n<blockquote>\n<p>ä¹‹å¾Œçš„ç¨‹å¼ç¢¼å°±ä¸å†å®Œæ•´çš„å¯«å‡ºä¾†äº†ï¼Œä½†å°±æ˜¯åœ¨é€™å€‹å¤§æ¡†æ¶ä¸‹æ’°å¯«</p>\n</blockquote>\n<h3>New çŸ­ç¶²å€</h3>\n<p>æˆ‘å€‘å¯«ä¸€å€‹ post æ–¹æ³•ä¾†æ¥æ”¶æ–°çš„ç¶²å€ï¼Œä¸¦å›å‚³ä»–çš„æ–°çŸ­ç¶²å€çµ¦ä»–ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">router<span class=\"token punctuation\">.</span><span class=\"token function\">post</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/new\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> env</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> body <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> req<span class=\"token punctuation\">.</span><span class=\"token function\">json</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>        <span class=\"token comment\">// å–å¾— POST JSON BODY ä¸¦è½‰æˆ JS ç‰©ä»¶</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>body<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">var</span> <span class=\"token punctuation\">{</span> url<span class=\"token punctuation\">,</span> len <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> body<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>url <span class=\"token operator\">==</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token function\">f00</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// JSON æœ‰èª¤ï¼Œå›å‚³ 400 éŒ¯èª¤</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span><span class=\"token operator\">!</span><span class=\"token function\">isValidHttpUrl</span><span class=\"token punctuation\">(</span>url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token function\">f00</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"URL is not valid\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>  <span class=\"token comment\">// ç¢ºèªæ˜¯å¦ç‚º Http ç¶²å€</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>len <span class=\"token operator\">==</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> len <span class=\"token operator\">=</span> <span class=\"token number\">5</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>len <span class=\"token operator\">&lt;</span> <span class=\"token number\">4</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token function\">f00</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Lenght must be at least 4\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ç¢ºèªè‡³å°‘å¤§æ–¼ç­‰æ–¼ 4</span>\n  <span class=\"token keyword\">var</span> s <span class=\"token operator\">=</span> <span class=\"token function\">getRandomString</span><span class=\"token punctuation\">(</span>len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// ç”¢ç”Ÿè‹±æ–‡äº‚ç¢¼</span>\n  <span class=\"token keyword\">while</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">await</span> env<span class=\"token punctuation\">.</span><span class=\"token constant\">URLS</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">!=</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span> <span class=\"token comment\">// å¾ kv ç¢ºèªæ²’æœ‰é‡è¤‡</span>\n    len<span class=\"token operator\">++</span><span class=\"token punctuation\">;</span> æœ‰é‡è¤‡å°‡ len <span class=\"token operator\">+</span><span class=\"token number\">1</span> å¾Œå†ç”¢ç”Ÿæ–°çš„\n    s <span class=\"token operator\">=</span> <span class=\"token function\">getRandomString</span><span class=\"token punctuation\">(</span>len<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">await</span> env<span class=\"token punctuation\">.</span><span class=\"token constant\">URLS</span><span class=\"token punctuation\">.</span><span class=\"token function\">put</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// å­˜å…¥ kv</span>\n  <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Response</span><span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">f00</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">msg</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Response</span><span class=\"token punctuation\">(</span>msg <span class=\"token operator\">?</span> msg <span class=\"token operator\">:</span> <span class=\"token string\">\"BAD REQUEST\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token number\">400</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">isValidHttpUrl</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">string</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">let</span> url<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n    url <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">URL</span><span class=\"token punctuation\">(</span>string<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span>_<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token boolean\">false</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> url<span class=\"token punctuation\">.</span>protocol <span class=\"token operator\">===</span> <span class=\"token string\">\"http:\"</span> <span class=\"token operator\">||</span> url<span class=\"token punctuation\">.</span>protocol <span class=\"token operator\">===</span> <span class=\"token string\">\"https:\"</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">function</span> <span class=\"token function\">getRandomString</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">len</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">var</span> s <span class=\"token operator\">=</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">for</span> <span class=\"token punctuation\">(</span><span class=\"token keyword\">let</span> i <span class=\"token operator\">=</span> <span class=\"token number\">0</span><span class=\"token punctuation\">;</span> i <span class=\"token operator\">&lt;</span> len<span class=\"token punctuation\">;</span> i<span class=\"token operator\">++</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    s <span class=\"token operator\">+=</span> String<span class=\"token punctuation\">.</span><span class=\"token function\">fromCharCode</span><span class=\"token punctuation\">(</span><span class=\"token function\">getRandomInt</span><span class=\"token punctuation\">(</span><span class=\"token number\">26</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">+</span> <span class=\"token number\">97</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token keyword\">return</span> s<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>é€™å€‹ POST è¦åƒä¸€å€‹åƒæ˜¯ä¸‹é¢çš„ json bodyï¼Œåˆ†åˆ¥æœ‰è¦ç¸®çš„ç¶²å€ï¼Œå’Œè¦ç”¢å‡ºçš„çŸ­ç¶²å€é•·åº¦ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"json\"><pre class=\"language-json\"><code class=\"language-json\"><span class=\"token punctuation\">{</span>\n  <span class=\"token property\">\"url\"</span><span class=\"token operator\">:</span> <span class=\"token string\">\"https://tonypepe.com\"</span><span class=\"token punctuation\">,</span>\n  <span class=\"token property\">\"len\"</span><span class=\"token operator\">:</span> <span class=\"token number\">3</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>å¯ä»¥ç™¼ç¾æˆ‘å€‘æ˜¯æ²’æœ‰åšæ¬Šé™æª¢æŸ¥çš„ï¼Œæ‰€ä»¥ä»»ä½•äººåªè¦å° POST <code class=\"language-text\">/new</code>ï¼Œéƒ½å¯ä»¥ç”¢ç”Ÿæ–°çš„çŸ­ç¶²å€ï¼Œä½†æˆ‘è‡ªå·±æ˜¯è¦ºå¾—å•é¡Œä¹Ÿä¸å¤§ï¼Œç•¢ç«Ÿ Cloudflare å°±æ˜¯ä¸€å®¶ ddos é˜²è­·å•†ï¼Œæ‰€ä»¥è¦è¢«æ”»æ“Šåˆ°ä¸€å¤©çš„ä½¿ç”¨é‡éƒ½ç”¨å®Œæ‡‰è©²ä¹Ÿå¾ˆé›£ã€‚æˆ–æ˜¯ä½ æƒ³è¦åšæ¬Šé™æª¢æŸ¥ï¼Œä¹Ÿå¯ä»¥è©¦è‘—å¯¦ä½œçœ‹çœ‹ã€‚</p>\n<h2>Redirect é‡æ–°å°å‘</h2>\n<p>æœ€å¾Œä¸€æ­¥å°±æ˜¯æŠŠçŸ­ç¶²å€é‡æ–°å°å‘åˆ°åŸæœ¬çš„ç¶²å€ï¼Œé€™éƒ¨ä»½å¾ˆç°¡å–®ï¼Œå°±æ˜¯å¾ kv å–å¾—åŸæœ¬çš„ç¶²å€ï¼Œç„¶å¾Œ Response HTTP 303 ä¾†åšé‡æ–°å°å‘ï¼Œå–ä¸åˆ° value å°±çµ¦ 404ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">router<span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/:path\"</span><span class=\"token punctuation\">,</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">req<span class=\"token punctuation\">,</span> env</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> params <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> req<span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> env<span class=\"token punctuation\">.</span><span class=\"token constant\">URLS</span><span class=\"token punctuation\">.</span><span class=\"token function\">get</span><span class=\"token punctuation\">(</span>params<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>url <span class=\"token operator\">==</span> <span class=\"token keyword\">undefined</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">return</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Response</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"NOT FOUND\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token number\">404</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> response <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Response</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> <span class=\"token literal-property property\">status</span><span class=\"token operator\">:</span> <span class=\"token number\">303</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  response<span class=\"token punctuation\">.</span>headers<span class=\"token punctuation\">.</span><span class=\"token function\">append</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"Location\"</span><span class=\"token punctuation\">,</span> url<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> response<span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>Publish</h2>\n<p><code class=\"language-text\">wrangler publish</code> å°±å¯ä»¥æŠŠç¨‹å¼ç¢¼éƒ¨ç½²åˆ°å…¨çƒçš„ Cloudflare ç¯€é»ï¼Œå¦‚æœæ²’æœ‰è‡ªå·±ç¶²åŸŸï¼ŒCloudflare ä¹Ÿæœƒçµ¦ä½ ä¸€å€‹ <code class=\"language-text\">xxx.workers.dev</code> çš„ç¶²åŸŸå…è²»ä½¿ç”¨ï¼Œå¯ä»¥ç¾åœ¨é€™è£¡æ¸¬è©¦çœ‹çœ‹ï¼Œå†æ±ºå®šè¦ä¸è¦æŠŠè‡ªå·±çš„ç¶²åŸŸç¶å®šä¸Šå»ã€‚</p>\n<h2>å¾Œè¨˜</h2>\n<p>é€™ç¯‡ç”¨ä¸åˆ° 100 è¡Œç¨‹å¼ç¢¼ç†Ÿç·´äº† Cloudflare çš„ Serverless æœå‹™ï¼Œå’Œå¯«å‡ºäº†çŸ­ç¶²å€æ‡‰ç”¨ï¼Œè®“æˆ‘å€‘ä¸ç”¨è‡ªå·±æ¶è¨­è‡ªå·±çš„ Server å°±å¯ä»¥æœ‰å‹•æ…‹ç¶²é çš„åŠŸèƒ½ã€‚æˆ‘é‚„çœ‹åˆ°å®˜æ–¹çš„æ–‡ä»¶ä¸­å¯ä»¥æŠŠ Response åŠ ä¸Š Cors çš„æ¨™é ­ï¼Œè®“åŸæœ¬ä¸å…è¨±è·¨ç«™å­˜å–çš„ api å¯ä»¥è·¨ç«™å­˜å–ï¼Œé›–ç„¶å¾ˆä¸é“å¾·ï¼Œä½†æ˜¯æˆ‘å–œæ­¡ã€‚æˆ‘è‡ªå·±é‚„æƒ³åˆ°å¯ä»¥å°åŸæœ¬çš„éœæ…‹ç¶²é åŠ ä¸Šé™åˆ¶å­˜å–çš„åŠŸèƒ½ï¼Œæˆ–æ˜¯ç¶²é æœ‰èª¤ç›´æ¥æŠŠç¶²é å…ˆå°å‘ 404ï¼Œé€™éƒ½æ˜¯å¾ˆæœ‰è¶£çš„æ‡‰ç”¨ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±ç™¼æ®çœ‹çœ‹ã€‚</p>\n<p>å¦‚æœè¦å®Œæ•´ç¨‹å¼ç¢¼ï¼š<a href=\"https://gist.github.com/TonyPepeBear/f435dae11b83fc2626a49a6b3cc9848b\">Gist</a></p>\n<h2>Reference</h2>\n<ul>\n<li><a href=\"https://developers.cloudflare.com/workers/\">Cloudflare Workers documentation</a></li>\n</ul>","rawMarkdownBody":"\nCloudflare Workers ä¹Ÿæ˜¯ Cloudflare çš„ä½›å¿ƒæœå‹™ä¹‹ä¸€ï¼Œå¯ä»¥æŠŠ node ç¨‹å¼éƒ¨ç½²åˆ° Cloudflare ä¸Šçš„çœ¾å¤šç¯€é»ï¼Œæ•ˆèƒ½ä¹Ÿä¸ä¿—ï¼Œæ¯å¤©é‚„æœ‰ 100,000 æ¬¡çš„å…è²»å‘¼å«ï¼Œä¹Ÿæ²’æœ‰å†·å•Ÿå‹•çš„å•é¡Œï¼Œå°æµé‡ä¸é«˜çš„ç¶²é ä¾†èªªå®Œå…¨å¤ ç”¨ã€‚å¦å¤–ï¼Œé‚„æœ‰ Workers KV å¯ä»¥ç”¨ä¾†å„²å­˜è³‡æ–™ï¼Œé€™å°±å¯ä»¥å¯«å‡ºç°¡å–®çš„å‹•æ…‹ç¶²é ï¼Œç”šè‡³æ˜¯ä¸€äº›æ›´è¤‡é›œçš„æ‡‰ç”¨ã€‚ä»Šå¤©å°±ä¾†å¯«ä¸€å€‹ Serverless çš„çŸ­ç¶²å€æœå‹™ï¼Œä¸¦æŠŠè³‡æ–™å­˜åœ¨ KV ä¸­ï¼Œå°±æˆ‘ç›®å‰è‡ªå·±æ¸¬è©¦ä¸‹ä¾†ï¼ŒWorkers çš„æ•ˆç‡çœŸçš„æ²’è©±èªªã€‚\n\n<!--more-->\n\n## Workers Playground\n\nå¦‚æœæƒ³è¦åœ¨ç¶²é ä¸­å…ˆè©¦è©¦çœ‹ Workersï¼Œå¯ä»¥åˆ° [Cloudflare Workers](https://cloudflareworkers.com/) é€™å€‹ç¶²ç«™ã€‚\n\næœƒæœ‰ä¸€å€‹é è¨­çš„æ¨¡æ¿é•·é€™æ¨£ï¼š\n\n```js\naddEventListener(\"fetch\", (event) => {\n  event.respondWith(handleRequest(event.request));\n});\n\n/**\n * Fetch and log a given request object\n * @param {Request} request\n */\nasync function handleRequest(request) {\n  console.log(\"Got request\", request);\n  const response = await fetch(request);\n  console.log(\"Got response\", response);\n  return response;\n}\n```\n\nè®“æˆ‘å€‘å…ˆä¾†ç†è§£ä¸€ä¸‹ç¨‹å¼ç¢¼ã€‚\n\nå¯ä»¥çœ‹åˆ°ç¨‹å¼æœ‰å…©å€‹ functionï¼Œå…¶ä¸­ `addEventListener(...)` å°±æ˜¯ç¨‹å¼çš„å…¥å£ï¼Œç•¶ Workers æ”¶åˆ° Request ä¹‹å¾Œï¼Œå°±æœƒå‚³å…¥ä½ çµ¦ä»–çš„ functionï¼Œç„¶å¾Œå†æ±ºå®šè¦ç”¨ä»€éº¼ Response å›å‚³åˆ° Clientï¼Œé€™è£¡ä»–å¯«äº†ä¸€å€‹ `handleRequest` çš„ function ä¾†è™•ç†ã€‚æ‰€ä»¥é€™å€‹ç¨‹å¼ç¢¼å¯¦éš›ä¸Šåšçš„äº‹ï¼Œå°±åªæœ‰æŠŠ Request å’Œ Response çµ¦ log å‡ºä¾†ï¼Œå›å‚³åŸæœ¬çš„ç¶²é çš„æ¨£å­ä¸åšä»»ä½•æ›´å‹•ã€‚\n\nä¸‹åœ–æ˜¯ Workers åœ¨ Cloudflare ä¸Šçš„é‹è¡Œé †åºï¼Œå¯ä»¥çœ‹åˆ° Workers è¢«æ”¾åœ¨æœ€å¾Œä¸€å€‹ï¼Œä¹Ÿå°±æ˜¯æœ€å¾Œä¸€å€‹æ±ºå®šè¦å›å‚³ä»€éº¼å…§å®¹çµ¦ User çš„åœ°æ–¹ï¼Œä¹Ÿå¯ä»¥ç†è§£ç‚ºå¯ä»¥åœ¨é€™è£¡å°åŸæœ¬çš„ Response åšæœ€å¾Œçš„æ›´å‹•ï¼Œå†å›å‚³çµ¦ Clientã€‚\n\næ‰€ä»¥é€™å€‹ Playground ä¸Šå¯ä»¥è¼¸å…¥ä»»æ„çš„ URLï¼Œä¾†é è¦½ä½ çš„ Workers åœ¨ä»»ä½•ä¸€å€‹ç¶²ç«™ä¸Šï¼Œæœƒå° Response åšçš„æ›´å‹•ã€‚\n\n![img](https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/32bd1508-ba78-4e94-76a0-adec503fe000/public)\n\nä¹Ÿå°±æ˜¯èªªå¦‚æœæŠŠç¨‹å¼æ”¹æˆä¸‹é¢é€™æ¨£ï¼Œå°±å¯ä»¥ç™¼ç¾ä»»æ„ç¶²ç«™éƒ½æœƒè®Šæˆ Google çš„æ¨¡æ¨£ã€‚\n\n```js\naddEventListener(\"fetch\", (event) => {\n  event.respondWith(handleRequest(event.request));\n});\n\nasync function handleRequest(request) {\n  const response = await fetch(\"https://google.com\");\n  return response;\n}\n```\n\n![img](https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/d7409a8b-8203-4e23-6491-309a4cc5b500/public)\n\nç†è§£å¾Œå°±æœƒç™¼ç¾ï¼Œå…¶å¯¦ Workers å¯ä»¥å°ç¶²é æœ‰å³æ™‚æ€§çš„æ›´æ”¹ï¼Œä¹Ÿå°±æ˜¯èªªå¯ä»¥å°ç¾æœ‰çš„ç¶²é åŠ ä¸Šæ–°åŠŸèƒ½ï¼Œæˆ–æ˜¯åœ¨ä¸æ›´å‹•åŸæœ¬ç¶²é çš„æƒ…æ³ä¸‹å»ä¿® bugã€‚\n\n## Wrangler\n\nWrangler æ˜¯ç®¡ç† Workers æœƒç”¨åˆ°çš„ cli å·¥å…·ï¼Œé›–ç„¶ä¸å®‰è£ä¹Ÿæ˜¯å¯ä»¥åœ¨ç¶²é ä¸­æ’°å¯« Workers ï¼Œä½†æ˜¯åŠŸèƒ½å°±æœƒå°‘å¾ˆå¤šï¼Œæ‰€ä»¥é‚„æ˜¯å»ºè­°å®‰è£ä¸€ä¸‹ã€‚é€™è£¡æ˜¯å®˜æ–¹çš„ Repo [cloudflare/wrangler2](https://github.com/cloudflare/wrangler2)ã€‚\n\nç”¨ npm å®‰è£åˆ° Globalï¼š\n\n```bash\nnpm i @cloudflare/wrangler -g\n```\n\né‚„æ˜¯å»ºè­°å»å®˜æ–¹ Repo çœ‹ä¸‹æœ‰æ²’æœ‰å…¶ä»–æ³¨æ„äº‹é …\n\nå®‰è£å®Œæˆå¾Œè¦ç™»å…¥ Cloudflare å¸³è™Ÿï¼Œ`wrangler login`ï¼Œå†ç”¨ç€è¦½å™¨ç™»å…¥å³å¯ã€‚\n\n## Init Project\n\n`wrangler init <project-name>` å‰µå»ºæ–°çš„å°ˆæ¡ˆï¼Œé€™ç•¶ä¸­ Wrangler æœƒå•ä¸€äº›å•é¡Œï¼Œå¯ä»¥æŒ‰ç…§è‡ªå·±çš„éœ€æ±‚æ±ºå®šã€‚\n\ninit å®Œæˆå¾Œï¼Œå¯ä»¥çœ‹åˆ°è‡ªå‹•ç”¢ç”Ÿäº†ä¸€äº›æª”æ¡ˆï¼ŒåŸºæœ¬ä¸Šæœƒç”¨åˆ°çš„åªæœ‰ `wrangler.toml` å’Œ `index.js` å…©å€‹æª”æ¡ˆã€‚\n\nç¾åœ¨å¯ä»¥å…ˆåœ¨ Terminal ä¸­è¼¸å…¥ `wrangler dev`ï¼Œå°±å¯ä»¥è®“ Workers è·‘åœ¨æœ¬åœ°ã€‚\n\n### Bug\n\nå› ç‚ºæˆ‘çš„ Cloudflare ä¸€æ¬¡ç™»å…¥å¤šå€‹ Userï¼Œæ‰€ä»¥åœ¨ä½¿ç”¨ wrangler çš„ **2.0.14** æ™‚å€™æœƒå‡º bug ç›´æ¥é–ƒé€€ï¼Œæˆ‘è§£æ±ºçš„æ–¹å¼æ˜¯ç›´æ¥åœ¨ `wrangler.toml` ä¸­è¼¸å…¥ `account_id` ä¾†é¿å… wrangler æœƒéœ€è¦é¸æ“‡å¸³è™Ÿçš„å•é¡Œã€‚\n\n```toml\naccount_id = \"xxxxxxxxxxxxxxx\"\n```\n\n## Cloudflare Workers KV\n\nçœ‹åˆ°åå­—å–ä½œ KVï¼Œç›´è§€çš„å°±æ˜¯è¡¨ç¤º `key-value` éµå€¼å°ï¼Œç¼ºé»æ˜¯ Key åªèƒ½å°ä¸Šä¸€å€‹ Valueï¼Œä¸èƒ½è¦å·¢ç‹€çš„ Value (åƒæ˜¯ Json é‚£æ¨£)ï¼Œè§£æ±ºçš„æ–¹å¼å…¶å¯¦ä¹Ÿæ˜¯ä¸é›£ï¼Œå¯ä»¥ç›´æ¥åœ¨ Value ä¸­å­˜ä¸Šæ•´çš„ Json æª”æ¡ˆï¼Œä½†åœ¨æœ¬æ–‡ä¸æœƒå¤šåšèªªæ˜ï¼Œå¯ä»¥è‡ªå·±ç ”ç©¶çœ‹çœ‹ã€‚\n\nå¦å¤– Cloudflare ä¹Ÿæœ‰æåˆ°ï¼ŒKV å­˜å–åœ¨å…¨çƒå¯èƒ½ä¸æ˜¯å³æ™‚æ€§çš„ï¼Œå¥½åƒæ˜¯åªä¿è­‰ 60 ç§’å¾ŒæœƒåŒæ­¥åˆ°æ‰€æœ‰ Serverï¼Œé›–ç„¶æˆ‘è¦ºå¾—æœ€æ…¢æ‡‰è©²ä¹Ÿæ˜¯ 5 å…§ç§’å•¦ï¼Œæˆ‘å¾ä¾†æ²’æœ‰æ„Ÿå—åˆ°å»¶é²éï¼Œä½†å¦‚æœå°å³æ™‚æ€§æœ‰ç–‘æ…®çš„å°ˆæ¡ˆå¯èƒ½ä¹Ÿè¦æ³¨æ„ä¸€ä¸‹ã€‚\n\nä¸‹é¢å°±ä¾†å‰µå»ºä¸€å€‹ KV namespaceï¼Œé€™å°±æ˜¯ä¸€å€‹ Database çš„åŸºæœ¬å–®ä½ï¼Œç›®å‰ Cloudflare æ˜¯å…è¨±ä¸€å€‹å¸³è™Ÿæœ‰ 100 å€‹ KV namespaceï¼Œæ‰€ä»¥æ­£å¸¸ä¾†èªªæ‡‰è©²ä¹Ÿä¸ç”¨æ“”å¿ƒæœƒç”¨å®Œã€‚ä¸‹é¢ç”¨ `URLS` ç•¶ä½œ namespace çš„åç¨±ï¼Œå› ç‚ºæˆ‘å€‘æ˜¯è¦å­˜çŸ­ç¶²å€çš„è³‡æ–™ã€‚\n\n```bash\n$ wrangler kv:namespace create \"URLS\"\n\nğŸŒ€  Creating namespace with title \"my-site-MY_KV\"\nâœ¨  Success!\nAdd the following to your configuration file:\nkv_namespaces = [\n  { binding = \"URLS\", id = \"xxxxxxxxxxxxxxxxxxxxxxx\" }\n]\n```\n\nç„¶å¾Œ wrangler æœƒæœ‰å€‹çµ¦ä½ ä¸€å€‹ binding å’Œ idï¼Œå°±ç›´æ¥è¤‡è£½è²¼ä¸Šåˆ° `wrangler.tmol` ä¸­å³å¯ï¼š\n\n```toml\nkv_namespaces = [\n  { binding = \"URLS\", id = \"xxxxxxxxxxxxxxxxxxxxxxx\" }\n]\n```\n\nå¦‚æœè¦åœ¨ wrangler çš„ dev æ¨¡å¼ä¸­æ¸¬è©¦ KVï¼Œå°±å¤šç”³è«‹ä¸€å€‹ Preview KVï¼Œä¾†é¿å…å°å·²ç¶“ä¸Šç·šçš„æœå‹™é€ æˆå½±éŸ¿ï¼š\n\n```bash\n$ wrangler kv:namespace create \"URLS\" --preview\n\nâ›…ï¸ wrangler 2.0.14\n--------------------\nğŸŒ€ Creating namespace with title \"URLS\"\nâœ¨ Success!\nAdd the following to your configuration file in your kv_namespaces array:\n{ binding = \"URLS\", preview_id = \"xxxxxxxxxxxxxxxxxxxx2\" }\n```\n\né€™æ¬¡æŠŠ `preview_id` åŠ åœ¨åŸæœ¬çš„ id å¾Œæ–¹å³å¯ï¼š\n\n```toml\nkv_namespaces = [\n    { binding = \"URLS\", id = \"xxxxxxxxxxxxxxxxxxxx\", preview_id = \"xxxxxxxxxxxxxxxxxxxx2\" }\n]\n```\n\nè¨­å®šå¥½å¾Œï¼Œwrangler æœƒç›´æ¥æŠŠä½ å‰›å‰›å–çš„åå­—ç›´æ¥ç”¨ç’°å¢ƒè®Šæ•¸ (ENV) å‚³å…¥ï¼Œå…·é«”çš„ä½¿ç”¨æ–¹å¼å¯ä»¥ç¹¼çºŒå¾€ä¸‹çœ‹ã€‚\n\n## Routing\n\nç‚ºäº†æ–¹ä¾¿ç­‰ç­‰æˆ‘å€‘è™•ç†å‚³å…¥çš„ Routingï¼Œæˆ‘å€‘å…ˆä¾†å®‰è£ä¸€å€‹ npm å¥—ä»¶ã€‚å°ä½ æ²’çœ‹éŒ¯ï¼ŒWorkers ä¹Ÿæ˜¯æ”¯æ´ npm å¥—ä»¶çš„ï¼š\n\n```bash\nyarn add itty-router\n\nnpm i itty-router\n```\n\né€™æ¨£ç­‰ç­‰å°±å¯ä»¥ç”¨ itty-router ä¾†è™•ç†å‚³å…¥çš„ requestã€‚\n\næˆ‘å€‘å…ˆå°‡ Handle Request å®Œå…¨ä¸Ÿçµ¦çš„ itty-router ä¾†è™•ç†ï¼Œå°‡ index.js æ”¹æˆä¸‹æ–¹é€™æ¨£ï¼š\n\n```js\nimport { Router } from \"itty-router\";\n\nconst router = Router();\n\nexport default {\n  fetch: router.handle,\n};\n```\n\nå¯ä»¥çœ‹åˆ°ç›´æ¥ export router çš„ handle æ–¹æ³•ï¼Œé€™æ¨£å°±å®Œå…¨æŠŠ Requse äº¤çµ¦ Router ä¾†è™•ç†ã€‚æˆ‘å€‘å…ˆå°‡ root å›å‚³ Hello æ¸¬è©¦çœ‹çœ‹ï¼š\n\n```js\nimport { Router } from \"itty-router\";\n\nconst router = Router();\n\nrouter.get(\"/\", async (req, env) => {\n  return new Response(\"Hello Workers\", {\n    status: 200,\n  });\n});\n\nexport default {\n  fetch: router.handle,\n};\n```\n\nç¾åœ¨å¯ä»¥ `wrangler dev` ä¸€ä¸‹ï¼Œç„¶å¾Œåˆ° `loclahost:8787/` çœ‹çœ‹æœƒä¸æœƒå›å‚³ Hello Workersã€‚\n\n> ä¹‹å¾Œçš„ç¨‹å¼ç¢¼å°±ä¸å†å®Œæ•´çš„å¯«å‡ºä¾†äº†ï¼Œä½†å°±æ˜¯åœ¨é€™å€‹å¤§æ¡†æ¶ä¸‹æ’°å¯«\n\n### New çŸ­ç¶²å€\n\næˆ‘å€‘å¯«ä¸€å€‹ post æ–¹æ³•ä¾†æ¥æ”¶æ–°çš„ç¶²å€ï¼Œä¸¦å›å‚³ä»–çš„æ–°çŸ­ç¶²å€çµ¦ä»–ã€‚\n\n```js\nrouter.post(\"/new\", async (req, env) => {\n  const body = await req.json();        // å–å¾— POST JSON BODY ä¸¦è½‰æˆ JS ç‰©ä»¶\n  console.log(JSON.stringify(body));\n  var { url, len } = body;\n  if (url == undefined) return f00(\"\"); // JSON æœ‰èª¤ï¼Œå›å‚³ 400 éŒ¯èª¤\n  if (!isValidHttpUrl(url)) return f00(\"URL is not valid\");  // ç¢ºèªæ˜¯å¦ç‚º Http ç¶²å€\n  if (len == undefined) len = 5;\n  if (len < 4) return f00(\"Lenght must be at least 4\"); // ç¢ºèªè‡³å°‘å¤§æ–¼ç­‰æ–¼ 4\n  var s = getRandomString(len); // ç”¢ç”Ÿè‹±æ–‡äº‚ç¢¼\n  while ((await env.URLS.get(s)) != undefined) { // å¾ kv ç¢ºèªæ²’æœ‰é‡è¤‡\n    len++; æœ‰é‡è¤‡å°‡ len +1 å¾Œå†ç”¢ç”Ÿæ–°çš„\n    s = getRandomString(len);\n  }\n  await env.URLS.put(s, url); // å­˜å…¥ kv\n  return new Response(s);\n});\n\nconst f00 = (msg) => new Response(msg ? msg : \"BAD REQUEST\", { status: 400 });\n\nfunction isValidHttpUrl(string) {\n  let url;\n  try {\n    url = new URL(string);\n  } catch (_) {\n    return false;\n  }\n  return url.protocol === \"http:\" || url.protocol === \"https:\";\n}\n\nfunction getRandomString(len) {\n  var s = \"\";\n  for (let i = 0; i < len; i++) {\n    s += String.fromCharCode(getRandomInt(26) + 97);\n  }\n  return s;\n}\n```\n\né€™å€‹ POST è¦åƒä¸€å€‹åƒæ˜¯ä¸‹é¢çš„ json bodyï¼Œåˆ†åˆ¥æœ‰è¦ç¸®çš„ç¶²å€ï¼Œå’Œè¦ç”¢å‡ºçš„çŸ­ç¶²å€é•·åº¦ï¼š\n\n```json\n{\n  \"url\": \"https://tonypepe.com\",\n  \"len\": 3\n}\n```\n\nå¯ä»¥ç™¼ç¾æˆ‘å€‘æ˜¯æ²’æœ‰åšæ¬Šé™æª¢æŸ¥çš„ï¼Œæ‰€ä»¥ä»»ä½•äººåªè¦å° POST `/new`ï¼Œéƒ½å¯ä»¥ç”¢ç”Ÿæ–°çš„çŸ­ç¶²å€ï¼Œä½†æˆ‘è‡ªå·±æ˜¯è¦ºå¾—å•é¡Œä¹Ÿä¸å¤§ï¼Œç•¢ç«Ÿ Cloudflare å°±æ˜¯ä¸€å®¶ ddos é˜²è­·å•†ï¼Œæ‰€ä»¥è¦è¢«æ”»æ“Šåˆ°ä¸€å¤©çš„ä½¿ç”¨é‡éƒ½ç”¨å®Œæ‡‰è©²ä¹Ÿå¾ˆé›£ã€‚æˆ–æ˜¯ä½ æƒ³è¦åšæ¬Šé™æª¢æŸ¥ï¼Œä¹Ÿå¯ä»¥è©¦è‘—å¯¦ä½œçœ‹çœ‹ã€‚\n\n## Redirect é‡æ–°å°å‘\n\næœ€å¾Œä¸€æ­¥å°±æ˜¯æŠŠçŸ­ç¶²å€é‡æ–°å°å‘åˆ°åŸæœ¬çš„ç¶²å€ï¼Œé€™éƒ¨ä»½å¾ˆç°¡å–®ï¼Œå°±æ˜¯å¾ kv å–å¾—åŸæœ¬çš„ç¶²å€ï¼Œç„¶å¾Œ Response HTTP 303 ä¾†åšé‡æ–°å°å‘ï¼Œå–ä¸åˆ° value å°±çµ¦ 404ã€‚\n\n```js\nrouter.get(\"/:path\", async (req, env) => {\n  const { params } = req;\n  const url = await env.URLS.get(params.path.toLowerCase());\n  if (url == undefined) return new Response(\"NOT FOUND\", { status: 404 });\n  const response = new Response(\"\", { status: 303 });\n  response.headers.append(\"Location\", url);\n  return response;\n});\n```\n\n## Publish\n\n`wrangler publish` å°±å¯ä»¥æŠŠç¨‹å¼ç¢¼éƒ¨ç½²åˆ°å…¨çƒçš„ Cloudflare ç¯€é»ï¼Œå¦‚æœæ²’æœ‰è‡ªå·±ç¶²åŸŸï¼ŒCloudflare ä¹Ÿæœƒçµ¦ä½ ä¸€å€‹ `xxx.workers.dev` çš„ç¶²åŸŸå…è²»ä½¿ç”¨ï¼Œå¯ä»¥ç¾åœ¨é€™è£¡æ¸¬è©¦çœ‹çœ‹ï¼Œå†æ±ºå®šè¦ä¸è¦æŠŠè‡ªå·±çš„ç¶²åŸŸç¶å®šä¸Šå»ã€‚\n\n## å¾Œè¨˜\n\né€™ç¯‡ç”¨ä¸åˆ° 100 è¡Œç¨‹å¼ç¢¼ç†Ÿç·´äº† Cloudflare çš„ Serverless æœå‹™ï¼Œå’Œå¯«å‡ºäº†çŸ­ç¶²å€æ‡‰ç”¨ï¼Œè®“æˆ‘å€‘ä¸ç”¨è‡ªå·±æ¶è¨­è‡ªå·±çš„ Server å°±å¯ä»¥æœ‰å‹•æ…‹ç¶²é çš„åŠŸèƒ½ã€‚æˆ‘é‚„çœ‹åˆ°å®˜æ–¹çš„æ–‡ä»¶ä¸­å¯ä»¥æŠŠ Response åŠ ä¸Š Cors çš„æ¨™é ­ï¼Œè®“åŸæœ¬ä¸å…è¨±è·¨ç«™å­˜å–çš„ api å¯ä»¥è·¨ç«™å­˜å–ï¼Œé›–ç„¶å¾ˆä¸é“å¾·ï¼Œä½†æ˜¯æˆ‘å–œæ­¡ã€‚æˆ‘è‡ªå·±é‚„æƒ³åˆ°å¯ä»¥å°åŸæœ¬çš„éœæ…‹ç¶²é åŠ ä¸Šé™åˆ¶å­˜å–çš„åŠŸèƒ½ï¼Œæˆ–æ˜¯ç¶²é æœ‰èª¤ç›´æ¥æŠŠç¶²é å…ˆå°å‘ 404ï¼Œé€™éƒ½æ˜¯å¾ˆæœ‰è¶£çš„æ‡‰ç”¨ï¼Œå¤§å®¶å¯ä»¥è‡ªå·±ç™¼æ®çœ‹çœ‹ã€‚\n\nå¦‚æœè¦å®Œæ•´ç¨‹å¼ç¢¼ï¼š[Gist](https://gist.github.com/TonyPepeBear/f435dae11b83fc2626a49a6b3cc9848b)\n\n## Reference\n\n- [Cloudflare Workers documentation](https://developers.cloudflare.com/workers/)\n","fileAbsolutePath":"/home/runner/work/Blog/Blog/src/posts/Web/cf-workers-short-url.md","excerpt":"Cloudflare Workers ä¹Ÿæ˜¯ Cloudflare çš„ä½›å¿ƒæœå‹™ä¹‹ä¸€ï¼Œå¯ä»¥æŠŠ node ç¨‹å¼éƒ¨ç½²åˆ° Cloudflare ä¸Šçš„çœ¾å¤šç¯€é»ï¼Œæ•ˆèƒ½ä¹Ÿä¸ä¿—ï¼Œæ¯å¤©é‚„æœ‰ 100,000 æ¬¡çš„å…è²»å‘¼å«ï¼Œä¹Ÿæ²’æœ‰å†·å•Ÿå‹•çš„å•é¡Œï¼Œå°æµé‡ä¸é«˜çš„ç¶²é ä¾†èªªå®Œå…¨å¤ ç”¨ã€‚å¦å¤–ï¼Œé‚„æœ‰ Workers KV å¯ä»¥ç”¨ä¾†å„²å­˜è³‡æ–™ï¼Œé€™å°±å¯ä»¥å¯«å‡ºç°¡å–®çš„å‹•æ…‹ç¶²é ï¼Œç”šè‡³æ˜¯ä¸€äº›æ›´è¤‡é›œçš„æ‡‰ç”¨ã€‚ä»Šå¤©å°±ä¾†å¯«ä¸€å€‹ Serverless çš„çŸ­ç¶²â€¦","frontmatter":{"title":"ç”¨ Cloudflare Workers æ¶è¨­ Serverless çŸ­ç¶²å€æœå‹™","date":"2022-06-21T09:15:49.000Z","draft":false,"tags":["cloudflare","workers","worker","web","short","url"],"image":"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/b6cf9d30-1028-4aa5-c136-0dbc6c098f00/public","description":null}}},{"node":{"id":"1f835006-d336-5140-acce-32c9475d47e1","html":"<p>æœ€è¿‘æŠŠç¶²ç«™å¾ Hugo é·ç§»åˆ° Gatsbyï¼Œé‡åˆ°äº†ä¸€äº›å•é¡Œï¼Œæˆ‘å°±ä¾†ç°¡å–®è¨˜éŒ„ä¸€ä¸‹è§£æ±ºå•é¡Œçš„éç¨‹ï¼Œè€Œä¸”å› ç‚ºæˆ‘å° Node ä¹Ÿä¸æ˜¯å¾ˆç†Ÿï¼Œæ‰€ä»¥ä¸»è¦æ˜¯åœ¨ç•¶ä½œæˆ‘ç·´ç¿’ Node å’Œ Reactã€‚</p>\n<!--more-->\n<h2>Whyï¼Ÿ</h2>\n<ol>\n<li>Hugo å¯¦åœ¨å¾ˆé›£ä½¿ç”¨ Node å¥—ä»¶</li>\n<li>å–®ç´”æƒ³çµ¦è‡ªå·±ä¸€å€‹æ¥è§¸ Node çš„æ©Ÿæœƒ</li>\n</ol>\n<p>è¨±å¤šç¶²é çš„å¥—ä»¶åº«éƒ½æ˜¯ä½¿ç”¨ node é–‹ç™¼çš„ï¼Œä½†å› ç‚º Hugo æ˜¯ç”¨ go é–‹ç™¼ï¼Œé›–ç„¶æœ‰æä¾›å° npm å¥—ä»¶çš„æ”¯æ´ï¼Œä½†æ˜¯é‚„æ˜¯æ²’æœ‰åŸç”Ÿçš„æ–¹ä¾¿ï¼Œåœ¨ç”¨å¥—ä»¶çš„æ™‚å€™å¸¸å¸¸æœƒé‡åˆ°å•é¡Œã€‚æ‰€ä»¥æˆ‘é‚„æ˜¯ä¸‹å®šæ±ºå¿ƒæ›åˆ° Gatsbyï¼Œä¹Ÿå¯ä»¥é †ä¾¿ç†Ÿæ‚‰ä¸€ä¸‹ Reactã€‚å¦å¤–ï¼Œæˆ‘æ˜¯ä½¿ç”¨ TypeScript ä¾†é–‹ç™¼ï¼Œé€™ä¹Ÿæ˜¯æœ‰é»è™å¾…è‡ªå·±ï¼Œä¸éé‚„å¥½é‚„æ˜¯é †åˆ©å®Œæˆï¼Œä¹Ÿå° TS æœ‰å¤šé»èªè­˜ã€‚</p>\n<p>ç›®å‰é‡åˆ°çš„ä¸€å€‹æœ€å¤§çš„ç¼ºé»ï¼Œå¤§æ¦‚å°±æ˜¯ Hugo ç”¢ç”Ÿç¶²é çš„é€Ÿåº¦çœŸçš„è¶…ç´šå¿«ï¼ŒGatsby å› ç‚ºä¾è³´ä¸€å¤§å † npm å¥—ä»¶ï¼Œæ‰€ä»¥æˆ‘åœ¨ Cloudflare Pages ä¸Šçš„å¹³å‡éœ€è¦å¤§ç´„ 5 åˆ†é˜ç¶²é æ‰èƒ½å»ºç½®å¥½ã€‚</p>\n<h2>é‡åˆ°çš„å•é¡Œ</h2>\n<p>ç›®å‰é‡åˆ°çš„ä¸»è¦å•é¡Œå¤§æ¦‚å°±æ˜¯ä¸‹é¢ä¸‰é»ï¼š</p>\n<ol>\n<li>npm build ä¸æˆåŠŸ</li>\n<li>è§€çœ‹æ›´å¤šçš„åŠŸèƒ½</li>\n<li>meilisearch</li>\n</ol>\n<h2>npm to yarn</h2>\n<p>ä¸€é–‹å§‹æˆ‘æ˜¯ä½¿ç”¨ npm ä½œç‚ºå¥—ä»¶ç®¡ç†ï¼Œæˆ‘åœ¨æœ¬æ©Ÿé–‹ç™¼æ™‚éƒ½æ²’æœ‰é‡åˆ°ä»€éº¼å•é¡Œï¼Œç›´åˆ°æˆ‘å¹¾ä¹éƒ½é–‹ç™¼å®Œæˆå¾Œï¼Œæˆ‘å°±å°‡ç¶²é  push åˆ° GitHub ä¸Šï¼ŒGitHub Actions åœ¨ Build æ™‚ä¹Ÿæ²’æœ‰é‡åˆ°å•é¡Œï¼Œç›´åˆ° Cloudflare Pages åœ¨å»ºç½®æ™‚ï¼Œå°±æ˜¯æœƒä¸€ç›´å¤±æ•—ï¼Œæˆ‘ä¹Ÿä¸€ç›´ç¢ºå®š node å’Œ npm ç‰ˆæœ¬è·Ÿæˆ‘æœ¬åœ°çš„ä¸€æ¨£ï¼Œä½†ç„¡è«–å¦‚ä½•å°±æ˜¯å¤±æ•—ï¼Œç›´åˆ°æˆ‘ä¸Šç¶²æŸ¥å¾Œï¼Œæ‰ç™¼ç¾ Gatsby å®˜æ–¹ä¹Ÿæ˜¯å»ºè­°ä½¿ç”¨ yarnï¼Œnpm å¥½åƒæœƒé‡åˆ°å•é¡Œã€‚æˆ‘å°±è©¦è‘— <code class=\"language-text\">yarn</code> ä¸€ä¸‹ï¼Œè®“å°ˆæ¡ˆè‡ªå‹•é·ç§»åˆ° yarnï¼Œå°±æ²’åˆå†å‡ºç¾å•é¡Œäº†ï¼Œå¯¦åœ¨è«åå…¶å¦™ã€‚æ‰€ä»¥ä¹Ÿæ˜¯å»ºè­°å¤§å®¶ä»¥å¾Œè‹¥æœ‰ä½¿ç”¨åˆ° Gatsbyï¼Œé‚„æ˜¯ä½¿ç”¨ yarn æ¯”è¼ƒå¥½ä¸€é»ã€‚</p>\n<h2>è§€çœ‹æ›´å¤š</h2>\n<p>åœ¨ Hugo æ™‚ï¼ŒHugo æ”¯æ´åœ¨ Markdown ä¸­ä½¿ç”¨ <code class=\"language-text\">&lt;!--more--></code> çš„æ¨™ç±¤ä¾†æå–æ¨™ç±¤å‰çš„éƒ¨åˆ†ç•¶ä½œæ–‡ç« æ‘˜è¦ï¼Œç”¨ä¾†é¡¯ç¤ºåœ¨ ListTemplateï¼Œè€Œ Gatsby åªæœ‰æä¾›æå–å‰ n å­—çš„åŠŸèƒ½ã€‚è€Œé€™å°æˆ‘ç¶²é çš„ç¾è§€ç¨‹åº¦å°±æœ‰ä¸€é»ä¸æ–¹ä¾¿ï¼Œå› ç‚ºæˆ‘ Hugo å·²ç¶“ç´¯è¨ˆäº†ä¸å°‘æ–‡ç« ï¼Œè‹¥è¦ç¾åœ¨å†å»ä¸€ç¯‡ç¯‡ä¿®æ”¹ï¼Œä¹Ÿæ˜¯æœƒæœ‰é»éº»ç…©ï¼Œæ‰€ä»¥åªå¥½è‡ªå·±ç¨å¾®ç ”ç©¶ä¸€ä¸‹è¦æ€éº¼è™•ç†ã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"md\"><pre class=\"language-md\"><code class=\"language-md\">Hello\n\næ‘˜è¦\n\n<span class=\"token comment\">&lt;!--more--></span>\n\næ­£æ–‡\n\næ­£æ–‡</code></pre></div>\n<p>æˆ‘è™•ç†çš„æ–¹å¼ç°¡å–®æš´åŠ›ï¼Œæˆ‘ç™¼ç¾ Gatsby åœ¨ GraphQL çš„æ™‚å€™ï¼Œå¯ä»¥æ‹¿åˆ° RawMarkdownï¼Œè€Œä¸”é€™å€‹ä¹Ÿæœƒä¿ç•™è¨»è§£ï¼Œæ‰€ä»¥æˆ‘éˆæ©Ÿä¸€å‹•ï¼Œæˆ‘å°±è‡ªå·±ä½¿ç”¨ Node å¥—ä»¶ï¼Œè‡ªå·±è§£æ Markdown ä¸å°±å¥½äº†ï¼Ÿæ‰€ä»¥æˆ‘å°±ç”¨ <code class=\"language-text\">marked</code> å¥—ä»¶ï¼Œå¹«æˆ‘æŠŠ md è½‰æˆ htmlã€‚ç¯„ä¾‹å¤§è‡´å¦‚ä¸‹ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> marked <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">\"marked\"</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">Summary</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> node <span class=\"token punctuation\">}</span><span class=\"token operator\">:</span> Props<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> summary <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span>rawMarkdownBody<span class=\"token punctuation\">.</span><span class=\"token function\">spllit</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;!--more-->\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div dangerouslaSetSetInnerHTML<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span> __html<span class=\"token operator\">:</span> marked<span class=\"token punctuation\">.</span><span class=\"token function\">parse</span><span class=\"token punctuation\">(</span>summary<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<h2>MeiliSearch</h2>\n<p>æˆ‘åŸæœ¬çš„ Hugo ç¶²é ï¼Œå°±æ˜¯ä½¿ç”¨ MeiliSearch ä¾†ç•¶æˆ‘çš„æœå°‹åŠŸèƒ½ï¼Œå¯ä»¥åƒè€ƒé€™å€‹ <a href=\"/search/tag?tag=meilisearch\">tag</a> ã€‚æ‰€ä»¥ä¸€æ¨£æ˜¯æœƒéœ€è¦ç”¢ç”Ÿä¸€å€‹ <code class=\"language-text\">SearchIndex.json</code>ï¼Œæˆ‘ç›´æ¥åœ¨ <code class=\"language-text\">gatsby-node.ts</code> è£¡çš„ <code class=\"language-text\">noPostBuild</code> æ‰‹å‹•ç”¢ç”Ÿ jsonï¼Œå†ç”¨ <code class=\"language-text\">fs</code> å¯«å…¥æª”æ¡ˆï¼Œç›´æ¥çµ¦å¤§å®¶ç¨‹å¼ç¢¼åƒè€ƒã€‚</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> onPostBuild<span class=\"token operator\">:</span> GatsbyNode<span class=\"token punctuation\">[</span><span class=\"token string\">\"onPostBuild\"</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">async</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  graphql<span class=\"token punctuation\">,</span>\n  actions<span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">{</span> errors<span class=\"token punctuation\">,</span> data <span class=\"token punctuation\">}</span> <span class=\"token operator\">=</span> <span class=\"token keyword\">await</span> <span class=\"token generic-function\"><span class=\"token function\">graphql</span><span class=\"token generic class-name\"><span class=\"token operator\">&lt;</span>ArticleListData<span class=\"token operator\">></span></span></span><span class=\"token punctuation\">(</span>articleGraphql<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token comment\">// SearchIndex.json</span>\n  <span class=\"token keyword\">const</span> searchArr<span class=\"token operator\">:</span> SearchIndex<span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n  data<span class=\"token operator\">!</span><span class=\"token operator\">!</span><span class=\"token punctuation\">.</span>allMarkdownRemark<span class=\"token punctuation\">.</span>edges<span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> node <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> index<span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">const</span> summary <span class=\"token operator\">=</span> node<span class=\"token punctuation\">.</span>rawMarkdownBody<span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"&lt;!--more-->\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> url <span class=\"token operator\">=</span>\n      <span class=\"token string\">\"/posts/\"</span> <span class=\"token operator\">+</span>\n      node<span class=\"token punctuation\">.</span>fileAbsolutePath\n        <span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"/posts/\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">split</span><span class=\"token punctuation\">(</span><span class=\"token string\">\".md\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\" \"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\"-\"</span><span class=\"token punctuation\">)</span>\n        <span class=\"token punctuation\">.</span><span class=\"token function\">toLowerCase</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">const</span> miliseconds <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">Date</span><span class=\"token punctuation\">(</span>node<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>date<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">getTime</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    searchArr<span class=\"token punctuation\">.</span><span class=\"token function\">push</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n      id<span class=\"token operator\">:</span> index<span class=\"token punctuation\">,</span>\n      date<span class=\"token operator\">:</span> miliseconds<span class=\"token punctuation\">,</span>\n      url<span class=\"token operator\">:</span> url<span class=\"token punctuation\">,</span>\n      title<span class=\"token operator\">:</span> node<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>title<span class=\"token punctuation\">,</span>\n      summary<span class=\"token operator\">:</span> summary<span class=\"token punctuation\">,</span>\n      content<span class=\"token operator\">:</span> node<span class=\"token punctuation\">.</span>internal<span class=\"token punctuation\">.</span>content<span class=\"token punctuation\">.</span><span class=\"token function\">replace</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\\n\"</span><span class=\"token punctuation\">,</span> <span class=\"token string\">\" \"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span>\n      tags<span class=\"token operator\">:</span> node<span class=\"token punctuation\">.</span>frontmatter<span class=\"token punctuation\">.</span>tags<span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  fs<span class=\"token punctuation\">.</span><span class=\"token function\">writeFileSync</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"./public/SearchIndex.json\"</span><span class=\"token punctuation\">,</span> <span class=\"token constant\">JSON</span><span class=\"token punctuation\">.</span><span class=\"token function\">stringify</span><span class=\"token punctuation\">(</span>searchArr<span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">;</span></code></pre></div>\n<p>ç”¢ç”Ÿ Json å¾Œï¼Œæˆ‘ä¸€æ¨£æ˜¯ä½¿ç”¨ GitHub Actions ä¾†è‡ªå‹•æŠŠ Index æ¨åˆ° MeiliSearch Serverã€‚</p>\n<h2>Tag Page</h2>\n<p>å…¶å¯¦ Gatsby æ‡‰è©²ä¹Ÿæ˜¯æœ‰æ–¹æ³•å¯ä»¥ç”¢ç”Ÿ Tag Pageï¼Œä½†æ˜¯å› ç‚ºæˆ‘æƒ³åˆ°è¦ç”¨ Tag Page æ™‚ï¼Œæˆ‘å·²ç¶“å¼„å¥½ MeiliSearch äº†ï¼Œæ‰€ä»¥æˆ‘å°±éˆæ©Ÿä¸€å‹•ï¼Œæƒ³æƒ³æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥ç›´æ¥ç°¡å–®çš„ä½¿ç”¨ MeiliSearch ä¾†å‹•æ…‹çš„ç”¢ç”Ÿ Tag Page å°±å¥½ï¼Œçµæœé‚„çœŸçš„è¢«æˆ‘å¼„æˆåŠŸäº†ï¼Œå°±ä¾†ç´€éŒ„ä¸€ä¸‹æˆ‘å¤§æ¦‚çš„æ€è·¯ã€‚é›–ç„¶æˆ‘çŸ¥é“é€™å…«æˆä¸æ˜¯ä»€éº¼å¥½æ–¹æ³•ï¼Œä½†æ˜¯ç°¡å–®æš´åŠ›ã€‚</p>\n<p>MeiliSearch å¯ä»¥è¨­å®š <code class=\"language-text\">filterableAttributes</code> çš„å±¬æ€§ï¼Œæ‰€ä»¥æˆ‘æŠŠæˆ‘çš„ Index ä¸­çš„ Tag å±¬æ€§è¨­å®šæˆå¯ä»¥ Filterableï¼Œç„¶å¾Œå†å–å¾—ç¶²å€çš„ Paramsï¼Œæœ€å¾Œå‘ MeiliSearch æœå°‹å¾Œå‹•æ…‹çš„æŠŠçµæœé¡¯ç¤ºåœ¨ç¶²é ä¸Šã€‚ä¹Ÿå¯ä»¥åƒè€ƒ<a href=\"https://docs.meilisearch.com/learn/advanced/filtering_and_faceted_search.html#configuring-filters\">å®˜æ–¹æ–‡ä»¶</a>ã€‚</p>\n<p>é€™æ™‚é‡åˆ°çš„å•é¡Œå°±æ˜¯ Gatsby æ˜¯ Server Side Renderingï¼Œæ‰€ä»¥å–çš„ Params è¦ä½¿ç”¨é¡å¤–çš„ pluginï¼Œæˆ‘æ˜¯ä½¿ç”¨ <code class=\"language-text\">gatsby-plugin-use-query-params</code>ï¼Œå°±å¯ä»¥åƒæ˜¯ React çš„ useState çš„æ–¹å¼ä¾†å–çš„ç¶²å€çš„ Parmã€‚</p>\n<p>ä¹Ÿæ˜¯æä¾›éƒ¨åˆ†çš„ç¨‹å¼ç¢¼çµ¦å¤§å®¶åƒè€ƒï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"typescript\"><pre class=\"language-typescript\"><code class=\"language-typescript\"><span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token keyword\">function</span> <span class=\"token function\">SearchTags</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">{</span> tag <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> _<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useQueryParams</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span> tag<span class=\"token operator\">:</span> StringParam <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span> <span class=\"token comment\">// å–çš„ Params</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>result<span class=\"token punctuation\">,</span> setResult<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>isLoading<span class=\"token punctuation\">,</span> setIsLoading<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> React<span class=\"token punctuation\">.</span><span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">true</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  React<span class=\"token punctuation\">.</span><span class=\"token function\">useEffect</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n    <span class=\"token comment\">// åŸ·è¡Œæœå°‹</span>\n    client\n      <span class=\"token punctuation\">.</span><span class=\"token function\">index</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"gatsby-blog\"</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">search</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span>\n        filter<span class=\"token operator\">:</span> <span class=\"token punctuation\">[</span><span class=\"token string\">\"tags=\"</span> <span class=\"token operator\">+</span> <span class=\"token punctuation\">(</span>tag <span class=\"token operator\">?</span> tag <span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span>\n        limit<span class=\"token operator\">:</span> Number<span class=\"token punctuation\">.</span><span class=\"token constant\">MAX_SAFE_INTEGER</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n      <span class=\"token punctuation\">.</span><span class=\"token function\">then</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span>res<span class=\"token operator\">:</span> <span class=\"token builtin\">any</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n        <span class=\"token function\">setResult</span><span class=\"token punctuation\">(</span>res<span class=\"token punctuation\">.</span>hits<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token function\">setIsLoading</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n      <span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token punctuation\">(</span>\n    <span class=\"token operator\">&lt;</span>MainLayout title<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token string\">\"tag: \"</span> <span class=\"token operator\">+</span> tag <span class=\"token operator\">+</span> <span class=\"token string\">\" - TonyPepe\"</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>div<span class=\"token operator\">></span>\n        <span class=\"token operator\">&lt;</span>h1 className<span class=\"token operator\">=</span><span class=\"token string\">\"my-4 bg-white rounded-md py-4 px-6 text-2xl\"</span><span class=\"token operator\">></span>\n          <span class=\"token punctuation\">{</span><span class=\"token string\">\"Tag: \"</span> <span class=\"token operator\">+</span> tag<span class=\"token punctuation\">}</span>\n        <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>h1<span class=\"token operator\">></span>\n        <span class=\"token punctuation\">{</span>isLoading <span class=\"token operator\">?</span> <span class=\"token operator\">&lt;</span>LoadingChild <span class=\"token operator\">/</span><span class=\"token operator\">></span> <span class=\"token operator\">:</span> <span class=\"token operator\">&lt;</span>ResultClild hits<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>result<span class=\"token punctuation\">}</span> <span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>MainLayout<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">const</span> client <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">MeiliSearch</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>\n  host<span class=\"token operator\">:</span> <span class=\"token string\">\"https://search.tonypepe.com\"</span><span class=\"token punctuation\">,</span>\n  apiKey<span class=\"token operator\">:</span> <span class=\"token string\">\"\"</span><span class=\"token punctuation\">,</span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span></code></pre></div>\n<h2>å¾Œç´€</h2>\n<p>Node åœ¨å»ºç½®ä¸Šå¯¦åœ¨æ˜¯å¤ªæ…¢ï¼ŒçœŸçš„æœƒæœ‰ä¸€é»å—ä¸äº†ï¼Œæ¯æ¬¡å…‰æ˜¯è¦ Run èµ· Dev Serverï¼Œå°±è‡³å°‘éœ€è¦ 30 ç§’ï¼Œç›¸æ¯” Hugo å°±ç®—æ˜¯æœ‰è£ä¸€é»é»çš„ npm å¥—ä»¶ï¼Œé‚„æ˜¯åªè¦ 10 ç§’å·¦å³å°±å¯ä»¥é–‹å§‹å¯«ç¶²é äº†ã€‚</p>\n<p>ç•¶ç„¶ï¼Œä½¿ç”¨ Gatsby é–‹ç™¼çš„å¥½è™•ä¹Ÿæ˜¯å¾ˆå¤šï¼Œå¯ä»¥æœ€å¤§åŒ–çš„è‡ªè¨‚ç¶²é çš„é•·ç›¸å’ŒåŠŸèƒ½ï¼Œä¸æœƒè¢« Hugo çš„åŠŸèƒ½é™åˆ¶ä½ï¼Œå¦‚æœç¼ºå°‘äº†ä»€éº¼åŠŸèƒ½ï¼Œéƒ½å¯ä»¥è‡ªå·±ç”¨ js é–‹ç™¼å‡ºä¾†ï¼Œè€Œä¸”åœ¨ä½¿ç”¨ä¸€äº› Web Library å’Œ React çœŸçš„å¤ªæ–¹ä¾¿äº†ã€‚</p>\n<h2>Reference</h2>\n<ul>\n<li><a href=\"https://gatsbyjs.org/\">Gatsby</a></li>\n<li><a href=\"https://docs.meilisearch.com/learn/advanced/filtering_and_faceted_search.html#configuring-filters\">MeiliSearch - Filtering and faceted search</a></li>\n</ul>","rawMarkdownBody":"\næœ€è¿‘æŠŠç¶²ç«™å¾ Hugo é·ç§»åˆ° Gatsbyï¼Œé‡åˆ°äº†ä¸€äº›å•é¡Œï¼Œæˆ‘å°±ä¾†ç°¡å–®è¨˜éŒ„ä¸€ä¸‹è§£æ±ºå•é¡Œçš„éç¨‹ï¼Œè€Œä¸”å› ç‚ºæˆ‘å° Node ä¹Ÿä¸æ˜¯å¾ˆç†Ÿï¼Œæ‰€ä»¥ä¸»è¦æ˜¯åœ¨ç•¶ä½œæˆ‘ç·´ç¿’ Node å’Œ Reactã€‚\n\n<!--more-->\n\n## Whyï¼Ÿ\n\n1. Hugo å¯¦åœ¨å¾ˆé›£ä½¿ç”¨ Node å¥—ä»¶\n2. å–®ç´”æƒ³çµ¦è‡ªå·±ä¸€å€‹æ¥è§¸ Node çš„æ©Ÿæœƒ\n\nè¨±å¤šç¶²é çš„å¥—ä»¶åº«éƒ½æ˜¯ä½¿ç”¨ node é–‹ç™¼çš„ï¼Œä½†å› ç‚º Hugo æ˜¯ç”¨ go é–‹ç™¼ï¼Œé›–ç„¶æœ‰æä¾›å° npm å¥—ä»¶çš„æ”¯æ´ï¼Œä½†æ˜¯é‚„æ˜¯æ²’æœ‰åŸç”Ÿçš„æ–¹ä¾¿ï¼Œåœ¨ç”¨å¥—ä»¶çš„æ™‚å€™å¸¸å¸¸æœƒé‡åˆ°å•é¡Œã€‚æ‰€ä»¥æˆ‘é‚„æ˜¯ä¸‹å®šæ±ºå¿ƒæ›åˆ° Gatsbyï¼Œä¹Ÿå¯ä»¥é †ä¾¿ç†Ÿæ‚‰ä¸€ä¸‹ Reactã€‚å¦å¤–ï¼Œæˆ‘æ˜¯ä½¿ç”¨ TypeScript ä¾†é–‹ç™¼ï¼Œé€™ä¹Ÿæ˜¯æœ‰é»è™å¾…è‡ªå·±ï¼Œä¸éé‚„å¥½é‚„æ˜¯é †åˆ©å®Œæˆï¼Œä¹Ÿå° TS æœ‰å¤šé»èªè­˜ã€‚\n\nç›®å‰é‡åˆ°çš„ä¸€å€‹æœ€å¤§çš„ç¼ºé»ï¼Œå¤§æ¦‚å°±æ˜¯ Hugo ç”¢ç”Ÿç¶²é çš„é€Ÿåº¦çœŸçš„è¶…ç´šå¿«ï¼ŒGatsby å› ç‚ºä¾è³´ä¸€å¤§å † npm å¥—ä»¶ï¼Œæ‰€ä»¥æˆ‘åœ¨ Cloudflare Pages ä¸Šçš„å¹³å‡éœ€è¦å¤§ç´„ 5 åˆ†é˜ç¶²é æ‰èƒ½å»ºç½®å¥½ã€‚\n\n## é‡åˆ°çš„å•é¡Œ\n\nç›®å‰é‡åˆ°çš„ä¸»è¦å•é¡Œå¤§æ¦‚å°±æ˜¯ä¸‹é¢ä¸‰é»ï¼š\n\n1. npm build ä¸æˆåŠŸ\n2. è§€çœ‹æ›´å¤šçš„åŠŸèƒ½\n3. meilisearch\n\n## npm to yarn\n\nä¸€é–‹å§‹æˆ‘æ˜¯ä½¿ç”¨ npm ä½œç‚ºå¥—ä»¶ç®¡ç†ï¼Œæˆ‘åœ¨æœ¬æ©Ÿé–‹ç™¼æ™‚éƒ½æ²’æœ‰é‡åˆ°ä»€éº¼å•é¡Œï¼Œç›´åˆ°æˆ‘å¹¾ä¹éƒ½é–‹ç™¼å®Œæˆå¾Œï¼Œæˆ‘å°±å°‡ç¶²é  push åˆ° GitHub ä¸Šï¼ŒGitHub Actions åœ¨ Build æ™‚ä¹Ÿæ²’æœ‰é‡åˆ°å•é¡Œï¼Œç›´åˆ° Cloudflare Pages åœ¨å»ºç½®æ™‚ï¼Œå°±æ˜¯æœƒä¸€ç›´å¤±æ•—ï¼Œæˆ‘ä¹Ÿä¸€ç›´ç¢ºå®š node å’Œ npm ç‰ˆæœ¬è·Ÿæˆ‘æœ¬åœ°çš„ä¸€æ¨£ï¼Œä½†ç„¡è«–å¦‚ä½•å°±æ˜¯å¤±æ•—ï¼Œç›´åˆ°æˆ‘ä¸Šç¶²æŸ¥å¾Œï¼Œæ‰ç™¼ç¾ Gatsby å®˜æ–¹ä¹Ÿæ˜¯å»ºè­°ä½¿ç”¨ yarnï¼Œnpm å¥½åƒæœƒé‡åˆ°å•é¡Œã€‚æˆ‘å°±è©¦è‘— `yarn` ä¸€ä¸‹ï¼Œè®“å°ˆæ¡ˆè‡ªå‹•é·ç§»åˆ° yarnï¼Œå°±æ²’åˆå†å‡ºç¾å•é¡Œäº†ï¼Œå¯¦åœ¨è«åå…¶å¦™ã€‚æ‰€ä»¥ä¹Ÿæ˜¯å»ºè­°å¤§å®¶ä»¥å¾Œè‹¥æœ‰ä½¿ç”¨åˆ° Gatsbyï¼Œé‚„æ˜¯ä½¿ç”¨ yarn æ¯”è¼ƒå¥½ä¸€é»ã€‚\n\n## è§€çœ‹æ›´å¤š\n\nåœ¨ Hugo æ™‚ï¼ŒHugo æ”¯æ´åœ¨ Markdown ä¸­ä½¿ç”¨ `<!--more-->` çš„æ¨™ç±¤ä¾†æå–æ¨™ç±¤å‰çš„éƒ¨åˆ†ç•¶ä½œæ–‡ç« æ‘˜è¦ï¼Œç”¨ä¾†é¡¯ç¤ºåœ¨ ListTemplateï¼Œè€Œ Gatsby åªæœ‰æä¾›æå–å‰ n å­—çš„åŠŸèƒ½ã€‚è€Œé€™å°æˆ‘ç¶²é çš„ç¾è§€ç¨‹åº¦å°±æœ‰ä¸€é»ä¸æ–¹ä¾¿ï¼Œå› ç‚ºæˆ‘ Hugo å·²ç¶“ç´¯è¨ˆäº†ä¸å°‘æ–‡ç« ï¼Œè‹¥è¦ç¾åœ¨å†å»ä¸€ç¯‡ç¯‡ä¿®æ”¹ï¼Œä¹Ÿæ˜¯æœƒæœ‰é»éº»ç…©ï¼Œæ‰€ä»¥åªå¥½è‡ªå·±ç¨å¾®ç ”ç©¶ä¸€ä¸‹è¦æ€éº¼è™•ç†ã€‚\n\n```md\nHello\n\næ‘˜è¦\n\n<!--more-->\n\næ­£æ–‡\n\næ­£æ–‡\n```\n\næˆ‘è™•ç†çš„æ–¹å¼ç°¡å–®æš´åŠ›ï¼Œæˆ‘ç™¼ç¾ Gatsby åœ¨ GraphQL çš„æ™‚å€™ï¼Œå¯ä»¥æ‹¿åˆ° RawMarkdownï¼Œè€Œä¸”é€™å€‹ä¹Ÿæœƒä¿ç•™è¨»è§£ï¼Œæ‰€ä»¥æˆ‘éˆæ©Ÿä¸€å‹•ï¼Œæˆ‘å°±è‡ªå·±ä½¿ç”¨ Node å¥—ä»¶ï¼Œè‡ªå·±è§£æ Markdown ä¸å°±å¥½äº†ï¼Ÿæ‰€ä»¥æˆ‘å°±ç”¨ `marked` å¥—ä»¶ï¼Œå¹«æˆ‘æŠŠ md è½‰æˆ htmlã€‚ç¯„ä¾‹å¤§è‡´å¦‚ä¸‹ï¼š\n\n```typescript\nimport { marked } from \"marked\";\n\nexport default function Summary({ node }: Props) {\n  const summary = node.rawMarkdownBody.spllit(\"<!--more-->\")[0];\n  return <div dangerouslaSetSetInnerHTML={{ __html: marked.parse(summary) }} />;\n}\n```\n\n## MeiliSearch\n\næˆ‘åŸæœ¬çš„ Hugo ç¶²é ï¼Œå°±æ˜¯ä½¿ç”¨ MeiliSearch ä¾†ç•¶æˆ‘çš„æœå°‹åŠŸèƒ½ï¼Œå¯ä»¥åƒè€ƒé€™å€‹ [tag](/search/tag?tag=meilisearch) ã€‚æ‰€ä»¥ä¸€æ¨£æ˜¯æœƒéœ€è¦ç”¢ç”Ÿä¸€å€‹ `SearchIndex.json`ï¼Œæˆ‘ç›´æ¥åœ¨ `gatsby-node.ts` è£¡çš„ `noPostBuild` æ‰‹å‹•ç”¢ç”Ÿ jsonï¼Œå†ç”¨ `fs` å¯«å…¥æª”æ¡ˆï¼Œç›´æ¥çµ¦å¤§å®¶ç¨‹å¼ç¢¼åƒè€ƒã€‚\n\n```typescript\nexport const onPostBuild: GatsbyNode[\"onPostBuild\"] = async ({\n  graphql,\n  actions,\n}) => {\n  const { errors, data } = await graphql<ArticleListData>(articleGraphql);\n  // SearchIndex.json\n  const searchArr: SearchIndex[] = [];\n  data!!.allMarkdownRemark.edges.forEach(({ node }, index) => {\n    const summary = node.rawMarkdownBody.split(\"<!--more-->\")[0];\n    const url =\n      \"/posts/\" +\n      node.fileAbsolutePath\n        .split(\"/posts/\")[1]\n        .split(\".md\")[0]\n        .replace(\" \", \"-\")\n        .toLowerCase();\n    const miliseconds = new Date(node.frontmatter.date).getTime();\n    searchArr.push({\n      id: index,\n      date: miliseconds,\n      url: url,\n      title: node.frontmatter.title,\n      summary: summary,\n      content: node.internal.content.replace(\"\\n\", \" \"),\n      tags: node.frontmatter.tags,\n    });\n  });\n  fs.writeFileSync(\"./public/SearchIndex.json\", JSON.stringify(searchArr));\n};\n```\n\nç”¢ç”Ÿ Json å¾Œï¼Œæˆ‘ä¸€æ¨£æ˜¯ä½¿ç”¨ GitHub Actions ä¾†è‡ªå‹•æŠŠ Index æ¨åˆ° MeiliSearch Serverã€‚\n\n## Tag Page\n\nå…¶å¯¦ Gatsby æ‡‰è©²ä¹Ÿæ˜¯æœ‰æ–¹æ³•å¯ä»¥ç”¢ç”Ÿ Tag Pageï¼Œä½†æ˜¯å› ç‚ºæˆ‘æƒ³åˆ°è¦ç”¨ Tag Page æ™‚ï¼Œæˆ‘å·²ç¶“å¼„å¥½ MeiliSearch äº†ï¼Œæ‰€ä»¥æˆ‘å°±éˆæ©Ÿä¸€å‹•ï¼Œæƒ³æƒ³æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥ç›´æ¥ç°¡å–®çš„ä½¿ç”¨ MeiliSearch ä¾†å‹•æ…‹çš„ç”¢ç”Ÿ Tag Page å°±å¥½ï¼Œçµæœé‚„çœŸçš„è¢«æˆ‘å¼„æˆåŠŸäº†ï¼Œå°±ä¾†ç´€éŒ„ä¸€ä¸‹æˆ‘å¤§æ¦‚çš„æ€è·¯ã€‚é›–ç„¶æˆ‘çŸ¥é“é€™å…«æˆä¸æ˜¯ä»€éº¼å¥½æ–¹æ³•ï¼Œä½†æ˜¯ç°¡å–®æš´åŠ›ã€‚\n\nMeiliSearch å¯ä»¥è¨­å®š `filterableAttributes` çš„å±¬æ€§ï¼Œæ‰€ä»¥æˆ‘æŠŠæˆ‘çš„ Index ä¸­çš„ Tag å±¬æ€§è¨­å®šæˆå¯ä»¥ Filterableï¼Œç„¶å¾Œå†å–å¾—ç¶²å€çš„ Paramsï¼Œæœ€å¾Œå‘ MeiliSearch æœå°‹å¾Œå‹•æ…‹çš„æŠŠçµæœé¡¯ç¤ºåœ¨ç¶²é ä¸Šã€‚ä¹Ÿå¯ä»¥åƒè€ƒ[å®˜æ–¹æ–‡ä»¶](https://docs.meilisearch.com/learn/advanced/filtering_and_faceted_search.html#configuring-filters)ã€‚\n\né€™æ™‚é‡åˆ°çš„å•é¡Œå°±æ˜¯ Gatsby æ˜¯ Server Side Renderingï¼Œæ‰€ä»¥å–çš„ Params è¦ä½¿ç”¨é¡å¤–çš„ pluginï¼Œæˆ‘æ˜¯ä½¿ç”¨ `gatsby-plugin-use-query-params`ï¼Œå°±å¯ä»¥åƒæ˜¯ React çš„ useState çš„æ–¹å¼ä¾†å–çš„ç¶²å€çš„ Parmã€‚\n\nä¹Ÿæ˜¯æä¾›éƒ¨åˆ†çš„ç¨‹å¼ç¢¼çµ¦å¤§å®¶åƒè€ƒï¼š\n\n```typescript\nexport default function SearchTags() {\n  const [{ tag }, _] = useQueryParams({ tag: StringParam }); // å–çš„ Params\n  const [result, setResult] = React.useState([]);\n  const [isLoading, setIsLoading] = React.useState(true);\n  React.useEffect(() => {\n    // åŸ·è¡Œæœå°‹\n    client\n      .index(\"gatsby-blog\")\n      .search(\"\", {\n        filter: [\"tags=\" + (tag ? tag : \"\")],\n        limit: Number.MAX_SAFE_INTEGER,\n      })\n      .then((res: any) => {\n        setResult(res.hits);\n        setIsLoading(false);\n      });\n  }, []);\n  return (\n    <MainLayout title={\"tag: \" + tag + \" - TonyPepe\"}>\n      <div>\n        <h1 className=\"my-4 bg-white rounded-md py-4 px-6 text-2xl\">\n          {\"Tag: \" + tag}\n        </h1>\n        {isLoading ? <LoadingChild /> : <ResultClild hits={result} />}\n      </div>\n    </MainLayout>\n  );\n}\n\nconst client = new MeiliSearch({\n  host: \"https://search.tonypepe.com\",\n  apiKey: \"\",\n});\n```\n\n## å¾Œç´€\n\nNode åœ¨å»ºç½®ä¸Šå¯¦åœ¨æ˜¯å¤ªæ…¢ï¼ŒçœŸçš„æœƒæœ‰ä¸€é»å—ä¸äº†ï¼Œæ¯æ¬¡å…‰æ˜¯è¦ Run èµ· Dev Serverï¼Œå°±è‡³å°‘éœ€è¦ 30 ç§’ï¼Œç›¸æ¯” Hugo å°±ç®—æ˜¯æœ‰è£ä¸€é»é»çš„ npm å¥—ä»¶ï¼Œé‚„æ˜¯åªè¦ 10 ç§’å·¦å³å°±å¯ä»¥é–‹å§‹å¯«ç¶²é äº†ã€‚\n\nç•¶ç„¶ï¼Œä½¿ç”¨ Gatsby é–‹ç™¼çš„å¥½è™•ä¹Ÿæ˜¯å¾ˆå¤šï¼Œå¯ä»¥æœ€å¤§åŒ–çš„è‡ªè¨‚ç¶²é çš„é•·ç›¸å’ŒåŠŸèƒ½ï¼Œä¸æœƒè¢« Hugo çš„åŠŸèƒ½é™åˆ¶ä½ï¼Œå¦‚æœç¼ºå°‘äº†ä»€éº¼åŠŸèƒ½ï¼Œéƒ½å¯ä»¥è‡ªå·±ç”¨ js é–‹ç™¼å‡ºä¾†ï¼Œè€Œä¸”åœ¨ä½¿ç”¨ä¸€äº› Web Library å’Œ React çœŸçš„å¤ªæ–¹ä¾¿äº†ã€‚\n\n## Reference\n\n- [Gatsby](https://gatsbyjs.org/)\n- [MeiliSearch - Filtering and faceted search](https://docs.meilisearch.com/learn/advanced/filtering_and_faceted_search.html#configuring-filters)\n","fileAbsolutePath":"/home/runner/work/Blog/Blog/src/posts/Web/hugo-to-gatsby.md","excerpt":"æœ€è¿‘æŠŠç¶²ç«™å¾ Hugo é·ç§»åˆ° Gatsbyï¼Œé‡åˆ°äº†ä¸€äº›å•é¡Œï¼Œæˆ‘å°±ä¾†ç°¡å–®è¨˜éŒ„ä¸€ä¸‹è§£æ±ºå•é¡Œçš„éç¨‹ï¼Œè€Œä¸”å› ç‚ºæˆ‘å° Node ä¹Ÿä¸æ˜¯å¾ˆç†Ÿï¼Œæ‰€ä»¥ä¸»è¦æ˜¯åœ¨ç•¶ä½œæˆ‘ç·´ç¿’ Node å’Œ Reactã€‚ Whyï¼Ÿ Hugo å¯¦åœ¨å¾ˆé›£ä½¿ç”¨ Node å¥—ä»¶ å–®ç´”æƒ³çµ¦è‡ªå·±ä¸€å€‹æ¥è§¸ Node çš„æ©Ÿæœƒ è¨±å¤šç¶²é çš„å¥—ä»¶åº«éƒ½æ˜¯ä½¿ç”¨ node é–‹ç™¼çš„ï¼Œä½†å› ç‚º Hugo æ˜¯ç”¨ go é–‹ç™¼ï¼Œé›–ç„¶æœ‰æä¾›å° npm å¥—ä»¶çš„æ”¯æ´ï¼Œä½†æ˜¯é‚„æ˜¯æ²’â€¦","frontmatter":{"title":"å¾ Hugo é·åˆ° Gatsby çš„ç´€éŒ„","date":"2022-06-01T15:17:28.142Z","draft":false,"tags":["hugo","gatsby","blog","web","node","npm","meilisearch","search"],"image":"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/2892b2bf-2c12-4d17-21f7-ba2e57c98100/public","description":null}}},{"node":{"id":"af3c84b0-2162-5466-8b24-f810139828dd","html":"<p>è¨˜éŒ„ä¸€äº›æˆ‘æ€•å¿˜çš„ Command Line æŠ€å·§ï¼Œç•¶ä½œå­—å…¸ç”¨ã€‚</p>\n<!--more-->\n<h2>æ¸…è¢å¹•</h2>\n<p><code class=\"language-text\">clear</code> æˆ–æ˜¯ <code class=\"language-text\">ctrl + L</code></p>\n<h2>å®¶ç›®éŒ„</h2>\n<p><code class=\"language-text\">~</code> æ³¢æµªç¬¦å°±æ˜¯ä»£è¡¨å®¶ç›®éŒ„</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">/etc$ <span class=\"token builtin class-name\">cd</span> ~\n\n~$</code></pre></div>\n<h2>é è¨­æ–‡å­—ç·¨è¼¯å™¨</h2>\n<p>æœ‰æ™‚é è¨­çš„æ–‡å­—ç·¨è¼¯å™¨ä¸æ˜¯ vimï¼Œè€Œæ˜¯ <code class=\"language-text\">nano</code> æˆ–æ˜¯ <code class=\"language-text\">emacs</code>ï¼Œåœ¨æ‰“ git æŒ‡ä»¤æ™‚ï¼Œæœƒé€²éŒ¯ç·¨è¼¯å™¨ã€‚åªè¦åœ¨ <code class=\"language-text\">.bashrc</code> ä¸­åŠ å…¥ä»¥ä¸‹å…©è¡Œï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">EDITOR</span><span class=\"token operator\">=</span>vim\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">VISUAL</span><span class=\"token operator\">=</span>vim</code></pre></div>\n<h2>è®Šæ›´ rc file å¾Œé¦¬ä¸Šç”Ÿæ•ˆ</h2>\n<p><code class=\"language-text\">source ~/.bashrc</code></p>\n<h2>è¿”å›ä¸Šä¸€å€‹è·¯å¾‘</h2>\n<p><code class=\"language-text\">cd -</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">~$ <span class=\"token builtin class-name\">cd</span> /etc\n\n/etc$ <span class=\"token builtin class-name\">cd</span> /var\n\n/var$ <span class=\"token builtin class-name\">cd</span> -\n\n/etc$ <span class=\"token builtin class-name\">cd</span> ~\n\n~$</code></pre></div>\n<h2>æŠŠè·¯å¾‘æ”¾é€² Stack</h2>\n<p><code class=\"language-text\">pushd</code> æŠŠç¾åœ¨çš„è·¯å¾‘æ¨é€² Stackï¼Œä¸¦ cd åˆ°å¾Œé¢çš„åƒæ•¸</p>\n<p><code class=\"language-text\">popd</code> æ‹¿å‡ºä¾†</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">/etc$ <span class=\"token function\">pushd</span> /var\n/var /etc\n\n/var$ <span class=\"token function\">pushd</span> /home\n/home /var /etc\n\n/home$ <span class=\"token builtin class-name\">cd</span> ~\n\n~$ <span class=\"token builtin class-name\">cd</span> /var/\n\n~$ <span class=\"token builtin class-name\">cd</span> /var/lib/\n\n/var/lib$ <span class=\"token function\">popd</span>\n/var /etc\n\n/var$ <span class=\"token function\">popd</span>\n/etc\n\n/etc$</code></pre></div>\n<h2>æŠŠå·¥ä½œæ”¾åˆ°èƒŒæ™¯</h2>\n<p><code class=\"language-text\">ctrl + z</code></p>\n<p>æ³¨æ„ï¼Œé€™æœƒæš«åœæ•´å€‹ processï¼Œä¸¦ä¸æ˜¯æ”¾åˆ°èƒŒæ™¯åŸ·è¡Œ</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">~$ <span class=\"token function\">vim</span> /proc/cpuinfo\n\n<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span>+  Stopped                 <span class=\"token function\">vim</span> /proc/cpuinfo\n\n~$</code></pre></div>\n<p><code class=\"language-text\">fg</code> (foreground) æŠŠæ”¾åˆ°èƒŒæ™¯çš„ process å–å›å‰æ™¯ç¹¼çºŒåŸ·è¡Œ</p>\n<p>Shell çµæŸæ™‚ï¼Œæ‰€æœ‰è¢«æš«åœçš„ process ä¹Ÿæœƒä¸€èµ·è¢«æ®ºæ‰</p>\n<h2>é‡è¤‡ä¸Šä¸€å€‹ Command</h2>\n<p><code class=\"language-text\">!!</code> å°±æ˜¯ä»£è¡¨ä¸Šä¸€å€‹ Command</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">~$ <span class=\"token builtin class-name\">echo</span> HI\nHI\n\n~$ <span class=\"token operator\">!</span><span class=\"token operator\">!</span>\n<span class=\"token builtin class-name\">echo</span> HI\nHI\n\n~$</code></pre></div>\n<p>é€™æ˜¯å¯ä»¥çµ„åˆæŠ€çš„ï¼šå¿˜è¨˜æ‰“ sudo å°± <code class=\"language-text\">sudo !!</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">~$ <span class=\"token function\">apt</span> update\nReading package lists<span class=\"token punctuation\">..</span>. Done\nE: Could not <span class=\"token function\">open</span> lock <span class=\"token function\">file</span> /var/lib/apt/lists/lock - <span class=\"token function\">open</span> <span class=\"token punctuation\">(</span><span class=\"token number\">13</span>: Permission denied<span class=\"token punctuation\">)</span>\nE: Unable to lock directory /var/lib/apt/lists/\n\n~$ <span class=\"token function\">sudo</span> <span class=\"token operator\">!</span><span class=\"token operator\">!</span>\n<span class=\"token function\">sudo</span> <span class=\"token function\">apt</span> update\nHit:1 http://archive.ubuntu.com/ubuntu jammy InRelease\nGet:2 http://security.ubuntu.com/ubuntu jammy-security InRelease <span class=\"token punctuation\">[</span><span class=\"token number\">110</span> kB<span class=\"token punctuation\">]</span>\nGet:3 http://archive.ubuntu.com/ubuntu jammy-updates InRelease <span class=\"token punctuation\">[</span><span class=\"token number\">109</span> kB<span class=\"token punctuation\">]</span>\nGet:4 http://archive.ubuntu.com/ubuntu jammy-backports InRelease <span class=\"token punctuation\">[</span><span class=\"token number\">99.8</span> kB<span class=\"token punctuation\">]</span>\nGet:5 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 Packages <span class=\"token punctuation\">[</span><span class=\"token number\">230</span> kB<span class=\"token punctuation\">]</span>\nGet:6 http://archive.ubuntu.com/ubuntu jammy-updates/restricted amd64 Packages <span class=\"token punctuation\">[</span><span class=\"token number\">143</span> kB<span class=\"token punctuation\">]</span>\nFetched <span class=\"token number\">693</span> kB <span class=\"token keyword\">in</span> 2s <span class=\"token punctuation\">(</span><span class=\"token number\">328</span> kB/s<span class=\"token punctuation\">)</span>\nReading package lists<span class=\"token punctuation\">..</span>. Done\nBuilding dependency tree<span class=\"token punctuation\">..</span>. Done\nReading state information<span class=\"token punctuation\">..</span>. Done\n<span class=\"token number\">1</span> package can be upgraded. Run <span class=\"token string\">'apt list --upgradable'</span> to see it.\n~$</code></pre></div>\n<h2>sudo ä¸è¼¸å…¥å¯†ç¢¼</h2>\n<p>åªè¦è®“ä¸‹é¢é‚£ä¸€è¡Œå‡ºç¾åœ¨ <code class=\"language-text\">/etc/sudoers</code> ä¸­å°±å¯ä»¥ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"text\"><pre class=\"language-text\"><code class=\"language-text\">%sudo ALL=(ALL) NOPASSWD:ALL</code></pre></div>\n<p>æˆ–æ˜¯ç›´æ¥è¼¸å…¥ (with root)ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\"><span class=\"token punctuation\">(</span>root<span class=\"token punctuation\">)</span> ~$ <span class=\"token builtin class-name\">echo</span> <span class=\"token string\">'%sudo ALL=(ALL) NOPASSWD:ALL'</span> <span class=\"token operator\">>></span> /etc/sudoers</code></pre></div>\n<h2>æœå°‹æ‰“éçš„æŒ‡ä»¤</h2>\n<p><code class=\"language-text\">ctrl + r</code>ï¼Œç„¶å¾Œæ‰“ä¸Šéƒ¨åˆ†è¨˜å¾—çš„æŒ‡ä»¤ï¼Œå°±æœƒè‡ªå‹•è£œå®Œ</p>\n<h2>è¼¸å‡ºå°é€² less</h2>\n<p>æœ‰æ™‚æŒ‡ä»¤è¼¸å‡ºå¾ˆé•·ï¼Œéœ€è¦ç¿»é é¡¯ç¤ºæ™‚ï¼Œå¯ä»¥ç”¨ <code class=\"language-text\">|</code> å°å…¥ <code class=\"language-text\">less</code></p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">~$ <span class=\"token function\">cat</span> /proc/cpuinfo <span class=\"token operator\">|</span> <span class=\"token function\">less</span></code></pre></div>\n<h2>æ¸…æ‰ä¸€æ•´è¡Œ</h2>\n<p><code class=\"language-text\">ctrl + u</code> æŠŠé‚„æ²’ enter çš„æŒ‡ä»¤æ¸…æ‰</p>\n<h2>å…‰æ¨™åˆ°æœ€å‰æˆ–æœ€å¾Œ</h2>\n<p><code class=\"language-text\">ctrl + a</code> ç§»å‹•å…‰æ¨™åˆ°æœ€å‰</p>\n<p><code class=\"language-text\">ctrl + e</code> ç§»å‹•å…‰æ¨™åˆ°æœ€å¾Œ</p>\n<h2>é€£çºŒåŸ·è¡ŒæŒ‡ä»¤</h2>\n<p><code class=\"language-text\">;</code> ä¸ç®¡å‰é¢æœ‰æ²’æœ‰æˆåŠŸï¼Œéƒ½åŸ·è¡Œå¾Œé¢çš„å‘½ä»¤</p>\n<p><code class=\"language-text\">&amp;&amp;</code> è¦å‰é¢å¾—åŸ·è¡ŒæˆåŠŸï¼Œæ‰åŸ·è¡Œå¾Œé¢çš„å‘½ä»¤</p>\n<div class=\"gatsby-highlight\" data-language=\"bash\"><pre class=\"language-bash\"><code class=\"language-bash\">~$ <span class=\"token function\">ls</span> / <span class=\"token punctuation\">;</span> <span class=\"token builtin class-name\">echo</span> hi\nbin  boot  dev  etc  home  lib  lib32  lib64  libx32  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var\nhi\n\n~$ <span class=\"token function\">ls</span> / <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">echo</span> hi\nbin  boot  dev  etc  home  lib  lib32  lib64  libx32  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var\nhi\n\n~$ <span class=\"token function\">ls</span> /no_such_dir <span class=\"token punctuation\">;</span> <span class=\"token builtin class-name\">echo</span> hi\nls: cannot access <span class=\"token string\">'/no_such_dir'</span><span class=\"token builtin class-name\">:</span> No such <span class=\"token function\">file</span> or directory\nhi\n\n~$ <span class=\"token function\">ls</span> /no_such_dir <span class=\"token operator\">&amp;&amp;</span> <span class=\"token builtin class-name\">echo</span> hi\nls: cannot access <span class=\"token string\">'/no_such_dir'</span><span class=\"token builtin class-name\">:</span> No such <span class=\"token function\">file</span> or directory</code></pre></div>\n<h2>Reference</h2>\n<ul>\n<li><a href=\"https://youtube.com/watch?v=AVXYq8aL47Q\">18 Commands That Will Change The Way You Use Linux Forever</a></li>\n</ul>","rawMarkdownBody":"\nè¨˜éŒ„ä¸€äº›æˆ‘æ€•å¿˜çš„ Command Line æŠ€å·§ï¼Œç•¶ä½œå­—å…¸ç”¨ã€‚\n\n<!--more-->\n\n## æ¸…è¢å¹•\n\n`clear` æˆ–æ˜¯ `ctrl + L`\n\n## å®¶ç›®éŒ„\n\n`~` æ³¢æµªç¬¦å°±æ˜¯ä»£è¡¨å®¶ç›®éŒ„\n\n```bash\n/etc$ cd ~\n\n~$\n```\n\n## é è¨­æ–‡å­—ç·¨è¼¯å™¨\n\næœ‰æ™‚é è¨­çš„æ–‡å­—ç·¨è¼¯å™¨ä¸æ˜¯ vimï¼Œè€Œæ˜¯ `nano` æˆ–æ˜¯ `emacs`ï¼Œåœ¨æ‰“ git æŒ‡ä»¤æ™‚ï¼Œæœƒé€²éŒ¯ç·¨è¼¯å™¨ã€‚åªè¦åœ¨ `.bashrc` ä¸­åŠ å…¥ä»¥ä¸‹å…©è¡Œï¼š\n\n```bash\nexport EDITOR=vim\nexport VISUAL=vim\n```\n\n## è®Šæ›´ rc file å¾Œé¦¬ä¸Šç”Ÿæ•ˆ\n\n`source ~/.bashrc`\n\n## è¿”å›ä¸Šä¸€å€‹è·¯å¾‘\n\n`cd -`\n\n```bash\n~$ cd /etc\n\n/etc$ cd /var\n\n/var$ cd -\n\n/etc$ cd ~\n\n~$\n```\n\n## æŠŠè·¯å¾‘æ”¾é€² Stack\n\n`pushd` æŠŠç¾åœ¨çš„è·¯å¾‘æ¨é€² Stackï¼Œä¸¦ cd åˆ°å¾Œé¢çš„åƒæ•¸\n\n`popd` æ‹¿å‡ºä¾†\n\n```bash\n/etc$ pushd /var\n/var /etc\n\n/var$ pushd /home\n/home /var /etc\n\n/home$ cd ~\n\n~$ cd /var/\n\n~$ cd /var/lib/\n\n/var/lib$ popd\n/var /etc\n\n/var$ popd\n/etc\n\n/etc$\n```\n\n## æŠŠå·¥ä½œæ”¾åˆ°èƒŒæ™¯\n\n`ctrl + z`\n\næ³¨æ„ï¼Œé€™æœƒæš«åœæ•´å€‹ processï¼Œä¸¦ä¸æ˜¯æ”¾åˆ°èƒŒæ™¯åŸ·è¡Œ\n\n```bash\n~$ vim /proc/cpuinfo\n\n[1]+  Stopped                 vim /proc/cpuinfo\n\n~$\n```\n\n`fg` (foreground) æŠŠæ”¾åˆ°èƒŒæ™¯çš„ process å–å›å‰æ™¯ç¹¼çºŒåŸ·è¡Œ\n\nShell çµæŸæ™‚ï¼Œæ‰€æœ‰è¢«æš«åœçš„ process ä¹Ÿæœƒä¸€èµ·è¢«æ®ºæ‰\n\n## é‡è¤‡ä¸Šä¸€å€‹ Command\n\n`!!` å°±æ˜¯ä»£è¡¨ä¸Šä¸€å€‹ Command\n\n```bash\n~$ echo HI\nHI\n\n~$ !!\necho HI\nHI\n\n~$\n```\n\né€™æ˜¯å¯ä»¥çµ„åˆæŠ€çš„ï¼šå¿˜è¨˜æ‰“ sudo å°± `sudo !!`\n\n```bash\n~$ apt update\nReading package lists... Done\nE: Could not open lock file /var/lib/apt/lists/lock - open (13: Permission denied)\nE: Unable to lock directory /var/lib/apt/lists/\n\n~$ sudo !!\nsudo apt update\nHit:1 http://archive.ubuntu.com/ubuntu jammy InRelease\nGet:2 http://security.ubuntu.com/ubuntu jammy-security InRelease [110 kB]\nGet:3 http://archive.ubuntu.com/ubuntu jammy-updates InRelease [109 kB]\nGet:4 http://archive.ubuntu.com/ubuntu jammy-backports InRelease [99.8 kB]\nGet:5 http://archive.ubuntu.com/ubuntu jammy-updates/main amd64 Packages [230 kB]\nGet:6 http://archive.ubuntu.com/ubuntu jammy-updates/restricted amd64 Packages [143 kB]\nFetched 693 kB in 2s (328 kB/s)\nReading package lists... Done\nBuilding dependency tree... Done\nReading state information... Done\n1 package can be upgraded. Run 'apt list --upgradable' to see it.\n~$\n```\n\n## sudo ä¸è¼¸å…¥å¯†ç¢¼\n\nåªè¦è®“ä¸‹é¢é‚£ä¸€è¡Œå‡ºç¾åœ¨ `/etc/sudoers` ä¸­å°±å¯ä»¥ï¼š\n\n```text\n%sudo ALL=(ALL) NOPASSWD:ALL\n```\n\næˆ–æ˜¯ç›´æ¥è¼¸å…¥ (with root)ï¼š\n\n```bash\n(root) ~$ echo '%sudo ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers\n```\n\n## æœå°‹æ‰“éçš„æŒ‡ä»¤\n\n`ctrl + r`ï¼Œç„¶å¾Œæ‰“ä¸Šéƒ¨åˆ†è¨˜å¾—çš„æŒ‡ä»¤ï¼Œå°±æœƒè‡ªå‹•è£œå®Œ\n\n## è¼¸å‡ºå°é€² less\n\næœ‰æ™‚æŒ‡ä»¤è¼¸å‡ºå¾ˆé•·ï¼Œéœ€è¦ç¿»é é¡¯ç¤ºæ™‚ï¼Œå¯ä»¥ç”¨ `|` å°å…¥ `less`\n\n```bash\n~$ cat /proc/cpuinfo | less\n```\n\n## æ¸…æ‰ä¸€æ•´è¡Œ\n\n`ctrl + u` æŠŠé‚„æ²’ enter çš„æŒ‡ä»¤æ¸…æ‰\n\n## å…‰æ¨™åˆ°æœ€å‰æˆ–æœ€å¾Œ\n\n`ctrl + a` ç§»å‹•å…‰æ¨™åˆ°æœ€å‰\n\n`ctrl + e` ç§»å‹•å…‰æ¨™åˆ°æœ€å¾Œ\n\n## é€£çºŒåŸ·è¡ŒæŒ‡ä»¤\n\n`;` ä¸ç®¡å‰é¢æœ‰æ²’æœ‰æˆåŠŸï¼Œéƒ½åŸ·è¡Œå¾Œé¢çš„å‘½ä»¤\n\n`&&` è¦å‰é¢å¾—åŸ·è¡ŒæˆåŠŸï¼Œæ‰åŸ·è¡Œå¾Œé¢çš„å‘½ä»¤\n\n```bash\n~$ ls / ; echo hi\nbin  boot  dev  etc  home  lib  lib32  lib64  libx32  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var\nhi\n\n~$ ls / && echo hi\nbin  boot  dev  etc  home  lib  lib32  lib64  libx32  media  mnt  opt  proc  root  run  sbin  srv  sys  tmp  usr  var\nhi\n\n~$ ls /no_such_dir ; echo hi\nls: cannot access '/no_such_dir': No such file or directory\nhi\n\n~$ ls /no_such_dir && echo hi\nls: cannot access '/no_such_dir': No such file or directory\n```\n\n## Reference\n\n- [18 Commands That Will Change The Way You Use Linux Forever](https://youtube.com/watch?v=AVXYq8aL47Q)\n","fileAbsolutePath":"/home/runner/work/Blog/Blog/src/posts/Linux/command tips.md","excerpt":"è¨˜éŒ„ä¸€äº›æˆ‘æ€•å¿˜çš„ Command Line æŠ€å·§ï¼Œç•¶ä½œå­—å…¸ç”¨ã€‚ æ¸…è¢å¹•  æˆ–æ˜¯  å®¶ç›®éŒ„  æ³¢æµªç¬¦å°±æ˜¯ä»£è¡¨å®¶ç›®éŒ„ é è¨­æ–‡å­—ç·¨è¼¯å™¨ æœ‰æ™‚é è¨­çš„æ–‡å­—ç·¨è¼¯å™¨ä¸æ˜¯ vimï¼Œè€Œæ˜¯  æˆ–æ˜¯ ï¼Œåœ¨æ‰“ git æŒ‡ä»¤æ™‚ï¼Œæœƒé€²éŒ¯ç·¨è¼¯å™¨ã€‚åªè¦åœ¨  ä¸­åŠ å…¥ä»¥ä¸‹å…©è¡Œï¼š è®Šæ›´ rc file å¾Œé¦¬ä¸Šç”Ÿæ•ˆ  è¿”å›ä¸Šä¸€å€‹è·¯å¾‘  æŠŠè·¯å¾‘æ”¾é€² Stack  æŠŠç¾åœ¨çš„è·¯å¾‘æ¨é€² Stackï¼Œä¸¦ cd åˆ°å¾Œé¢çš„åƒæ•¸  æ‹¿å‡ºä¾† æŠŠå·¥ä½œæ”¾åˆ°â€¦","frontmatter":{"title":"ä¸€äº› Command Line æŠ€å·§","date":"2022-05-25T15:27:30.000Z","draft":false,"tags":["linux","ubuntu","mac","command","max"],"image":"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/9dfac9e4-1de1-43dc-eead-381301a1b500/public","description":null}}},{"node":{"id":"22c3b17c-4301-5fb4-9145-fa9a71fdb584","html":"<p>ç‚ºä»€éº¼è¦åœ¨ Container ä¸­ Codingï¼Ÿå› çˆ²é–‹ç™¼ä¸­æœ€å¤§çš„é›£é¡Œç¸½æ˜¯åœ¨ç’°å¢ƒå»ºç½®ï¼Œå¥½ä¸å®¹æ˜“å»ºç½®å¥½ç’°å¢ƒï¼Œè¦å¯«ä¸‹å€‹å°ˆæ¡ˆæ™‚ï¼Œå› ç‚ºé›»è…¦å·²ç¶“é«’å…®å…®ï¼Œå®‰è£ç’°å¢ƒæ™‚å°±æœƒå®¹æ˜“è¡åˆ°ç‰ˆæœ¬ï¼Œè€Œé€ æˆæƒ¡æ€§å¾ªç’°ï¼Œç’°å¢ƒå»ºç½®ä¸€æ¬¡æ¯”ä¸€æ¬¡å›°é›£ï¼Œæœ€å¾Œç™¼ç¾é‡çŒé›»è…¦æœ€å¿«ã€‚åœ¨ Container ä¸­ Coding å°±å¯ä»¥ç°¡å–®ç”¨å®Œå³ä¸Ÿï¼Œæ¯æ¬¡éƒ½å¯ä»¥åœ¨ä¹¾æ·¨çš„é›»è…¦å®‰è£ç’°å¢ƒï¼Œè£ä»»ä½•æ±è¥¿ä¹Ÿä¸æ€•æŠŠæœ¬æ©Ÿå¼„é«’ï¼Œåœ¨ Windows ä¸Šæ›´å¯ä»¥ç°¡å–®çš„åœ¨ Linux ä¸­é–‹ç™¼ã€‚</p>\n<!--more-->\n<p>åœ¨ Container è£¡ Coding å·²ç¶“ä¸æ˜¯ä»€éº¼æ–°é®®äº‹ï¼ŒVSCode çš„å®˜æ–¹å°±æœ‰æä¾› <a href=\"https://code.visualstudio.com/docs/remote/containers\">Developing inside a Container</a> çš„å®˜æ–¹æ–‡ä»¶ï¼Œå¯ä»¥ç”¨æœ¬æ©Ÿçš„ Docker å¿«é€Ÿçš„ç”¢ç”Ÿ Container ä¸¦ä¸”åœ¨è£¡é¢é–‹ç™¼ã€‚å£è™•å°±æ˜¯åªèƒ½åœ¨æœ¬æ©Ÿé€£ç·šï¼Œå¦‚æœæœ‰å¤šå°é›»è…¦æƒ³è¦å…±åŒé–‹ç™¼çš„éœ€æ±‚ï¼Œå°±åªå¥½ç”¨ä»Šå¤©è¦ä»‹ç´¹çš„æ–¹å¼ï¼Œç”¨ SSH é€£å…¥ Containerï¼Œåªè¦é€£å¾—ä¸Š SSH å°±å¯ä»¥é–‹ç™¼ï¼Œé–‹ç™¼æ™‚ä¹Ÿä¸ç”¨è¢«ä¾·é™åœ¨ä¸€å°é›»è…¦çš„ Docker ä¸Šã€‚ç•¶ç„¶ï¼Œæœ€å¤§çš„ç¼ºé»å°±æ˜¯è¦æœ‰ä¸€å°ä¸€ç›´é‹ä½œè‘— Docker çš„ Server å¯ä»¥è®“ä½ éš¨æ™‚é€£ç·šã€‚GitHub æœ‰ä¸€å€‹ <a href=\"https://github.com/features/codespaces\">Codespace</a> çš„åŠŸèƒ½ï¼Œå°±æ˜¯å¾ˆé¡ä¼¼çš„æƒ³æ³•ï¼ŒCode in Cloudï¼Œä½†ç•¢ç«Ÿæ˜¯ä¼æ¥­çš„æ”¶è²»æœå‹™ï¼Œæˆ‘ä¹‹å‰æœ‰æŠ½åˆ°é è¦½ç‰ˆï¼Œåˆ°ç¾åœ¨éƒ½å¯ä»¥å…è²»ä½¿ç”¨ï¼Œæ˜¯çœŸçš„å¾ˆæ–¹ä¾¿çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯ä»–çš„æ–¹ä¾¿ï¼Œè®“æˆ‘æƒ³ç ”ç©¶å¦‚ä½•è‡ªå·±æ¶é¡ä¼¼çš„æœå‹™ã€‚</p>\n<h2>Dockerfile</h2>\n<p>ç°¡å–®ä¾†èªªå°±æ˜¯å‰µå»ºä¸€å€‹å·²ç¶“è¢«é è£ SSH Server çš„ Linuxï¼Œæˆ‘å€‘ä»Šå¤©å°±ç”¨ Ubuntuï¼Œç„¶å¾Œé †ä¾¿é è£ä¸€äº›é–‹ç™¼ä¸­å¸¸æœƒç”¨åˆ°å¥—ä»¶ï¼Œåƒæ˜¯ <code class=\"language-text\">git</code>, <code class=\"language-text\">vim</code> ç­‰ç­‰ã€‚</p>\n<blockquote>\n<p>å¦‚æœæƒ³è·³éé€™æ­¥é©Ÿï¼Œç”¨æˆ‘å‰µå»ºå¥½çš„ Image å¯ä»¥æ‹‰åˆ°ä¸‹ä¸€å€‹ç« ç¯€å»çœ‹</p>\n</blockquote>\n<div class=\"gatsby-highlight\" data-language=\"dockerfile\"><pre class=\"language-dockerfile\"><code class=\"language-dockerfile\"><span class=\"token instruction\"><span class=\"token keyword\">ARG</span> UBUNTU_VERSION=latest</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">FROM</span> ubuntu:<span class=\"token variable\">${UBUNTU_VERSION}</span></span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">ENV</span> DEBIAN_FRONTEND noninteractive</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">RUN</span> apt update <span class=\"token operator\">\\</span>\n    &amp;&amp; apt install -y openssh-server ssh sudo git vim <span class=\"token operator\">\\</span>\n    &amp;&amp; useradd -rm -d /home/ubuntu -s /bin/bash -g root -G sudo -u 1000 ubuntu <span class=\"token operator\">\\</span>\n    &amp;&amp; echo <span class=\"token string\">\"ubuntu:ubuntu\"</span> | chpasswd <span class=\"token operator\">\\</span>\n    &amp;&amp; echo <span class=\"token string\">'%sudo ALL=(ALL) NOPASSWD:ALL'</span> >> /etc/sudoers <span class=\"token operator\">\\</span>\n    &amp;&amp; service ssh start</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">EXPOSE</span> 22</span>\n\n<span class=\"token instruction\"><span class=\"token keyword\">CMD</span> [<span class=\"token string\">\"/usr/sbin/sshd\"</span>, <span class=\"token string\">\"-D\"</span>]</span></code></pre></div>\n<p>å¯ä»¥çœ‹åˆ°æˆ‘æŠŠå¸³è™Ÿå¯†ç¢¼éƒ½è¨­ç½®ç‚º <code class=\"language-text\">ubuntu</code>ï¼Œç„¶å¾Œè®“ <code class=\"language-text\">sudo</code> æ™‚å¯ä»¥ä¸ç”¨å¯†ç¢¼ã€‚ç„¶å¾Œå®‰è£å•Ÿå‹• ssh serviceï¼Œæœ€å¾Œé–‹å•Ÿ 22 portã€‚ç”¨ä¸‹é¢çš„ Docker æŒ‡ä»¤å°±å¯ä»¥å‰µå»ºè‡ªå·±çš„ Imageï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">docker</span> build -t ssh-ubuntu <span class=\"token builtin class-name\">.</span></code></pre></div>\n<h3>æˆ‘æ§‹å»ºå¥½çš„ Image</h3>\n<p>æˆ‘æœ‰å‰µä¸€å€‹ GitHub Repo æ”¾æˆ‘çš„ Dockerfileï¼Œä¸¦ç”¨ GitHub Actions + Packages ä¾†ç™¼å¸ƒ Imageï¼ŒImage åç¨±ç‚º <code class=\"language-text\">ghcr.io/tonypepebear/ssh-dev-ubuntu</code>ã€‚</p>\n<p><a href=\"https://github.com/TonyPepeBear/ssh-dev-container/pkgs/container/ssh-dev-ubuntu\">Package ç¶²å€</a></p>\n<h2>å•Ÿå‹• Container ä¸¦ SSH é€£å…¥</h2>\n<p>å•Ÿå‹• Container ä¸¦æŠŠ 22 Port å¼„å‡ºä¾†ï¼Œæˆ‘æ˜¯æ˜ å°„åˆ° 8222ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">docker</span> run -dp <span class=\"token number\">8222</span>:22 ssh-ubuntu\n\nå¦‚æœè¦ç”¨æˆ‘çš„ Imageï¼š\n<span class=\"token function\">docker</span> run -dp <span class=\"token number\">8222</span>:22 ghcr.io/tonypepebear/ssh-dev-ubuntu</code></pre></div>\n<p>SSH é€£å…¥ï¼Œè©¢å•å¯†ç¢¼å°±æ˜¯ <code class=\"language-text\">ubuntu</code>ï¼š</p>\n<div class=\"gatsby-highlight\" data-language=\"shell\"><pre class=\"language-shell\"><code class=\"language-shell\"><span class=\"token function\">ssh</span> -p <span class=\"token number\">8222</span> ubuntu@localhost</code></pre></div>\n<p>å¦‚æœæ²’ç™¼ç”Ÿå•é¡Œï¼Œåˆ°ç¾åœ¨æ‡‰è©²å°±å¯ä»¥é †åˆ©çš„é€£åˆ° Container ä¸­ã€‚</p>\n<h2>VSCode SSH é€£ç·š</h2>\n<p>éœ€è¦å…ˆåœ¨ VSCode ä¸­å®‰è£ Remote - SSH å¥—ä»¶ï¼Œå¦‚åœ–ï¼š</p>\n<p><img src=\"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/be8ec8dc-8900-4cbe-1587-45fa6f3f6500/public\" alt=\"img\"></p>\n<p>å®‰è£å®Œæˆå¾Œï¼Œé»æ“Šæœ€å·¦ä¸‹è§’çš„ Remote åŠŸèƒ½ï¼Œå†é¸æ“‡ Connect to SSH Hostï¼Œè¼¸å…¥ SSH æŒ‡ä»¤ <code class=\"language-text\">ssh -p 8222 ubuntu@localhost</code>ï¼Œå°±å¯ä»¥é †åˆ©é€£åˆ° Container ä¸­ã€‚</p>\n<p><img src=\"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/960ea18c-82c7-4ce1-73d3-8ff092f2b000/public\" alt=\"img\"></p>\n<p><img src=\"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/814b9dac-f39d-4d07-1095-2d280cd5e300/public\" alt=\"img\"></p>\n<h2>å¾Œè¨˜</h2>\n<p>å…¶å¯¦æˆ‘ä¹Ÿä¸æœƒæ¯å€‹å°ˆæ¡ˆéƒ½æ–°å¢ä¸€å€‹æ–°çš„ Containerï¼Œè€Œæ˜¯ç”¨åˆ°æˆ‘å—ä¸äº†æˆ–è¡çªåˆ°å¾Œï¼Œæ‰å‰µå»ºä¸€å€‹æ–°çš„ï¼Œç•¢ç«Ÿæ¯æ¬¡å‰µæ–°çš„ Container ä¹Ÿæ˜¯æœ‰é»éº»ç…©ï¼Œä½†æ˜¯èƒ½è®“æˆ‘åœ¨å®‰è£ä¸€äº›äº‚ä¸ƒå…«ç³Ÿçš„ç’°å¢ƒ (å°±æ˜¯åœ¨èªªä½ å€‘ npm, pip) æ™‚ï¼Œå¯ä»¥å¤§è†½åœ°æŒ‰ä¸‹å»ï¼Œä¸ç”¨æ“”å¿ƒæŠŠé›»è…¦æåˆ°å—ä¸äº†æ‰æ˜¯é‡é»ã€‚å¸Œæœ›å¤§å®¶åœ¨é–‹ç™¼çš„è·¯ä¸Šå¯ä»¥æ›´åŠ é †åˆ©ã€‚</p>\n<p>å¦å¤–ï¼ŒVSCode çš„ SSH é€£ç·šåŠŸèƒ½çœŸçš„åšçš„ä¸éŒ¯ï¼Œç”šè‡³å¯ä»¥ Port Forwardingï¼Œåœ¨é–‹ç™¼ç¶²é çš„æ™‚å€™ä¸ç”¨åœ¨ Docker ä¸­å¤š Forwarding ä¸€å€‹ Portï¼Œå¯ä»¥éš¨æ™‚ç”¨ VSCode Forwarding åˆ°æœ¬æ©Ÿä¸Šã€‚</p>\n<h2>Reference</h2>\n<ul>\n<li><a href=\"https://code.visualstudio.com/docs/remote/ssh\">Remote Development using SSH</a></li>\n</ul>","rawMarkdownBody":"\nç‚ºä»€éº¼è¦åœ¨ Container ä¸­ Codingï¼Ÿå› çˆ²é–‹ç™¼ä¸­æœ€å¤§çš„é›£é¡Œç¸½æ˜¯åœ¨ç’°å¢ƒå»ºç½®ï¼Œå¥½ä¸å®¹æ˜“å»ºç½®å¥½ç’°å¢ƒï¼Œè¦å¯«ä¸‹å€‹å°ˆæ¡ˆæ™‚ï¼Œå› ç‚ºé›»è…¦å·²ç¶“é«’å…®å…®ï¼Œå®‰è£ç’°å¢ƒæ™‚å°±æœƒå®¹æ˜“è¡åˆ°ç‰ˆæœ¬ï¼Œè€Œé€ æˆæƒ¡æ€§å¾ªç’°ï¼Œç’°å¢ƒå»ºç½®ä¸€æ¬¡æ¯”ä¸€æ¬¡å›°é›£ï¼Œæœ€å¾Œç™¼ç¾é‡çŒé›»è…¦æœ€å¿«ã€‚åœ¨ Container ä¸­ Coding å°±å¯ä»¥ç°¡å–®ç”¨å®Œå³ä¸Ÿï¼Œæ¯æ¬¡éƒ½å¯ä»¥åœ¨ä¹¾æ·¨çš„é›»è…¦å®‰è£ç’°å¢ƒï¼Œè£ä»»ä½•æ±è¥¿ä¹Ÿä¸æ€•æŠŠæœ¬æ©Ÿå¼„é«’ï¼Œåœ¨ Windows ä¸Šæ›´å¯ä»¥ç°¡å–®çš„åœ¨ Linux ä¸­é–‹ç™¼ã€‚\n\n<!--more-->\n\nåœ¨ Container è£¡ Coding å·²ç¶“ä¸æ˜¯ä»€éº¼æ–°é®®äº‹ï¼ŒVSCode çš„å®˜æ–¹å°±æœ‰æä¾› [Developing inside a Container](https://code.visualstudio.com/docs/remote/containers) çš„å®˜æ–¹æ–‡ä»¶ï¼Œå¯ä»¥ç”¨æœ¬æ©Ÿçš„ Docker å¿«é€Ÿçš„ç”¢ç”Ÿ Container ä¸¦ä¸”åœ¨è£¡é¢é–‹ç™¼ã€‚å£è™•å°±æ˜¯åªèƒ½åœ¨æœ¬æ©Ÿé€£ç·šï¼Œå¦‚æœæœ‰å¤šå°é›»è…¦æƒ³è¦å…±åŒé–‹ç™¼çš„éœ€æ±‚ï¼Œå°±åªå¥½ç”¨ä»Šå¤©è¦ä»‹ç´¹çš„æ–¹å¼ï¼Œç”¨ SSH é€£å…¥ Containerï¼Œåªè¦é€£å¾—ä¸Š SSH å°±å¯ä»¥é–‹ç™¼ï¼Œé–‹ç™¼æ™‚ä¹Ÿä¸ç”¨è¢«ä¾·é™åœ¨ä¸€å°é›»è…¦çš„ Docker ä¸Šã€‚ç•¶ç„¶ï¼Œæœ€å¤§çš„ç¼ºé»å°±æ˜¯è¦æœ‰ä¸€å°ä¸€ç›´é‹ä½œè‘— Docker çš„ Server å¯ä»¥è®“ä½ éš¨æ™‚é€£ç·šã€‚GitHub æœ‰ä¸€å€‹ [Codespace](https://github.com/features/codespaces) çš„åŠŸèƒ½ï¼Œå°±æ˜¯å¾ˆé¡ä¼¼çš„æƒ³æ³•ï¼ŒCode in Cloudï¼Œä½†ç•¢ç«Ÿæ˜¯ä¼æ¥­çš„æ”¶è²»æœå‹™ï¼Œæˆ‘ä¹‹å‰æœ‰æŠ½åˆ°é è¦½ç‰ˆï¼Œåˆ°ç¾åœ¨éƒ½å¯ä»¥å…è²»ä½¿ç”¨ï¼Œæ˜¯çœŸçš„å¾ˆæ–¹ä¾¿çš„åŠŸèƒ½ï¼Œä¹Ÿå°±æ˜¯ä»–çš„æ–¹ä¾¿ï¼Œè®“æˆ‘æƒ³ç ”ç©¶å¦‚ä½•è‡ªå·±æ¶é¡ä¼¼çš„æœå‹™ã€‚\n\n## Dockerfile\n\nç°¡å–®ä¾†èªªå°±æ˜¯å‰µå»ºä¸€å€‹å·²ç¶“è¢«é è£ SSH Server çš„ Linuxï¼Œæˆ‘å€‘ä»Šå¤©å°±ç”¨ Ubuntuï¼Œç„¶å¾Œé †ä¾¿é è£ä¸€äº›é–‹ç™¼ä¸­å¸¸æœƒç”¨åˆ°å¥—ä»¶ï¼Œåƒæ˜¯ `git`, `vim` ç­‰ç­‰ã€‚\n\n> å¦‚æœæƒ³è·³éé€™æ­¥é©Ÿï¼Œç”¨æˆ‘å‰µå»ºå¥½çš„ Image å¯ä»¥æ‹‰åˆ°ä¸‹ä¸€å€‹ç« ç¯€å»çœ‹\n\n```Dockerfile\nARG UBUNTU_VERSION=latest\n\nFROM ubuntu:${UBUNTU_VERSION}\n\nENV DEBIAN_FRONTEND noninteractive\n\nRUN apt update \\\n    && apt install -y openssh-server ssh sudo git vim \\\n    && useradd -rm -d /home/ubuntu -s /bin/bash -g root -G sudo -u 1000 ubuntu \\\n    && echo \"ubuntu:ubuntu\" | chpasswd \\\n    && echo '%sudo ALL=(ALL) NOPASSWD:ALL' >> /etc/sudoers \\\n    && service ssh start\n\nEXPOSE 22\n\nCMD [\"/usr/sbin/sshd\", \"-D\"]\n```\n\nå¯ä»¥çœ‹åˆ°æˆ‘æŠŠå¸³è™Ÿå¯†ç¢¼éƒ½è¨­ç½®ç‚º `ubuntu`ï¼Œç„¶å¾Œè®“ `sudo` æ™‚å¯ä»¥ä¸ç”¨å¯†ç¢¼ã€‚ç„¶å¾Œå®‰è£å•Ÿå‹• ssh serviceï¼Œæœ€å¾Œé–‹å•Ÿ 22 portã€‚ç”¨ä¸‹é¢çš„ Docker æŒ‡ä»¤å°±å¯ä»¥å‰µå»ºè‡ªå·±çš„ Imageï¼š\n\n```shell\ndocker build -t ssh-ubuntu .\n```\n\n### æˆ‘æ§‹å»ºå¥½çš„ Image\n\næˆ‘æœ‰å‰µä¸€å€‹ GitHub Repo æ”¾æˆ‘çš„ Dockerfileï¼Œä¸¦ç”¨ GitHub Actions + Packages ä¾†ç™¼å¸ƒ Imageï¼ŒImage åç¨±ç‚º `ghcr.io/tonypepebear/ssh-dev-ubuntu`ã€‚\n\n[Package ç¶²å€](https://github.com/TonyPepeBear/ssh-dev-container/pkgs/container/ssh-dev-ubuntu)\n\n## å•Ÿå‹• Container ä¸¦ SSH é€£å…¥\n\nå•Ÿå‹• Container ä¸¦æŠŠ 22 Port å¼„å‡ºä¾†ï¼Œæˆ‘æ˜¯æ˜ å°„åˆ° 8222ï¼š\n\n```shell\ndocker run -dp 8222:22 ssh-ubuntu\n\nå¦‚æœè¦ç”¨æˆ‘çš„ Imageï¼š\ndocker run -dp 8222:22 ghcr.io/tonypepebear/ssh-dev-ubuntu\n```\n\nSSH é€£å…¥ï¼Œè©¢å•å¯†ç¢¼å°±æ˜¯ `ubuntu`ï¼š\n\n```shell\nssh -p 8222 ubuntu@localhost\n```\n\nå¦‚æœæ²’ç™¼ç”Ÿå•é¡Œï¼Œåˆ°ç¾åœ¨æ‡‰è©²å°±å¯ä»¥é †åˆ©çš„é€£åˆ° Container ä¸­ã€‚\n\n## VSCode SSH é€£ç·š\n\néœ€è¦å…ˆåœ¨ VSCode ä¸­å®‰è£ Remote - SSH å¥—ä»¶ï¼Œå¦‚åœ–ï¼š\n\n![img](https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/be8ec8dc-8900-4cbe-1587-45fa6f3f6500/public)\n\nå®‰è£å®Œæˆå¾Œï¼Œé»æ“Šæœ€å·¦ä¸‹è§’çš„ Remote åŠŸèƒ½ï¼Œå†é¸æ“‡ Connect to SSH Hostï¼Œè¼¸å…¥ SSH æŒ‡ä»¤ `ssh -p 8222 ubuntu@localhost`ï¼Œå°±å¯ä»¥é †åˆ©é€£åˆ° Container ä¸­ã€‚\n\n![img](https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/960ea18c-82c7-4ce1-73d3-8ff092f2b000/public)\n\n![img](https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/814b9dac-f39d-4d07-1095-2d280cd5e300/public)\n\n## å¾Œè¨˜\n\nå…¶å¯¦æˆ‘ä¹Ÿä¸æœƒæ¯å€‹å°ˆæ¡ˆéƒ½æ–°å¢ä¸€å€‹æ–°çš„ Containerï¼Œè€Œæ˜¯ç”¨åˆ°æˆ‘å—ä¸äº†æˆ–è¡çªåˆ°å¾Œï¼Œæ‰å‰µå»ºä¸€å€‹æ–°çš„ï¼Œç•¢ç«Ÿæ¯æ¬¡å‰µæ–°çš„ Container ä¹Ÿæ˜¯æœ‰é»éº»ç…©ï¼Œä½†æ˜¯èƒ½è®“æˆ‘åœ¨å®‰è£ä¸€äº›äº‚ä¸ƒå…«ç³Ÿçš„ç’°å¢ƒ (å°±æ˜¯åœ¨èªªä½ å€‘ npm, pip) æ™‚ï¼Œå¯ä»¥å¤§è†½åœ°æŒ‰ä¸‹å»ï¼Œä¸ç”¨æ“”å¿ƒæŠŠé›»è…¦æåˆ°å—ä¸äº†æ‰æ˜¯é‡é»ã€‚å¸Œæœ›å¤§å®¶åœ¨é–‹ç™¼çš„è·¯ä¸Šå¯ä»¥æ›´åŠ é †åˆ©ã€‚\n\nå¦å¤–ï¼ŒVSCode çš„ SSH é€£ç·šåŠŸèƒ½çœŸçš„åšçš„ä¸éŒ¯ï¼Œç”šè‡³å¯ä»¥ Port Forwardingï¼Œåœ¨é–‹ç™¼ç¶²é çš„æ™‚å€™ä¸ç”¨åœ¨ Docker ä¸­å¤š Forwarding ä¸€å€‹ Portï¼Œå¯ä»¥éš¨æ™‚ç”¨ VSCode Forwarding åˆ°æœ¬æ©Ÿä¸Šã€‚\n\n## Reference\n\n- [Remote Development using SSH](https://code.visualstudio.com/docs/remote/ssh)\n","fileAbsolutePath":"/home/runner/work/Blog/Blog/src/posts/VSCode/SSH Dev Container.md","excerpt":"ç‚ºä»€éº¼è¦åœ¨ Container ä¸­ Codingï¼Ÿå› çˆ²é–‹ç™¼ä¸­æœ€å¤§çš„é›£é¡Œç¸½æ˜¯åœ¨ç’°å¢ƒå»ºç½®ï¼Œå¥½ä¸å®¹æ˜“å»ºç½®å¥½ç’°å¢ƒï¼Œè¦å¯«ä¸‹å€‹å°ˆæ¡ˆæ™‚ï¼Œå› ç‚ºé›»è…¦å·²ç¶“é«’å…®å…®ï¼Œå®‰è£ç’°å¢ƒæ™‚å°±æœƒå®¹æ˜“è¡åˆ°ç‰ˆæœ¬ï¼Œè€Œé€ æˆæƒ¡æ€§å¾ªç’°ï¼Œç’°å¢ƒå»ºç½®ä¸€æ¬¡æ¯”ä¸€æ¬¡å›°é›£ï¼Œæœ€å¾Œç™¼ç¾é‡çŒé›»è…¦æœ€å¿«ã€‚åœ¨ Container ä¸­ Coding å°±å¯ä»¥ç°¡å–®ç”¨å®Œå³ä¸Ÿï¼Œæ¯æ¬¡éƒ½å¯ä»¥åœ¨ä¹¾æ·¨çš„é›»è…¦å®‰è£ç’°å¢ƒï¼Œè£ä»»ä½•æ±è¥¿ä¹Ÿä¸æ€•æŠŠæœ¬æ©Ÿå¼„é«’ï¼Œåœ¨ Windows ä¸Šæ›´å¯ä»¥ç°¡å–®çš„åœ¨ Linâ€¦","frontmatter":{"title":"VSCode SSH é€£å…¥ Docker Container","date":"2022-05-21T14:07:16.000Z","draft":false,"tags":["vscode","ssh","docker"],"image":"https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/0f3867f8-dd79-482c-1f27-a7a166f7dc00/public","description":null}}}]}},"pageContext":{"limit":8,"skip":0,"numPages":4,"currentPage":1}},"staticQueryHashes":[]}