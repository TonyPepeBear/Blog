<!doctype html><html lang=zh-tw><head><meta http-equiv=content-type content="text/html" charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href="/HugoBlog/css/main.min.c2d216e1adfb9a02a5b6bc1d037421d8c4caa354db7dc07ef4a0f56a330fc2e0.css" integrity="sha256-wtIW4a37mgKltrwdA3Qh2MTKo1TbfcB+9KD1ajMPwuA="><title>用 Go 寫 Telegram Bot - TonyPepe</title></head><body class=bg-gray-200><script src=https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js defer></script><div class="container mx-auto lg:flex"><aside class="lg:w-1/5 top-4 lg:sticky h-full z-0 mt-4"><nav class="mx-4 lg:mx-0 flex flex-row lg:flex-col xl:ml-28"><div><img class="rounded-full w-32 h-32 hover:-rotate-12 transform duration-700" src=https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/cfccf3e2-7fd5-4e6c-adcb-a3cc5064f900/public alt><div class=mt-3><a href=/ class="mt-10 text-2xl font-black text-gray-800">TonyPepe</a></div></div><div><div class="flex flex-col ml-4 lg:ml-0"><a href=/ class="mt-5 text-xl font-black text-gray-800 hover:text-blue-900"><div class="flex flex-row items-center"><span class=iconify data-icon=mdi:home></span><p class=ml-2>Home</p></div></a><a href=/search class="mt-5 text-xl font-black text-gray-800 hover:text-blue-900"><div class="flex flex-row items-center"><span class=iconify data-icon=mdi:file-search></span><p class=ml-2>Search</p></div></a><a href=/about class="mt-5 text-xl font-black text-gray-800 hover:text-blue-900 transition"><div class="flex flex-row items-center"><span class=iconify data-icon=mdi:human-greeting-variant></span><p class=ml-2>About</p></div></a></div></div></nav></aside><div class="lg:w-3/5 z-10 mt-12"><main><div class="bg-white shadow-md rounded-xl my-5 mx-2"><img src=https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/f8c04956-a2ef-4cba-b9fe-2a5ceff40b00/public class="filter w-full h-80 object-cover rounded-t-xl"><div class=px-3><h1 class="text-4xl my-5 inline-block text-center w-full text-black">用 Go 寫 Telegram Bot</h1><div class="mx-2 flex flex-row pb-2 text-gray-500 items-center"><span class=iconify data-icon=mdi:calendar-range></span>
<time class=ml-1 datetime=2021-12-11T14:30:15Z>2021-Dec-11</time>
<a href=https://github.com/TonyPepeBear/HugoBlog/commit/ac97c4b38a90fbb53bd1841c78ff4f3e0348d9c1 target=_blank class="flex flex-row items-center ml-5"><span class=iconify data-icon=bi:git></span><p class=ml-1>ac97c4b</p></a><a href=https://github.com/TonyPepeBear/HugoBlog/issues target=_blank class="flex flex-row items-center ml-5"><span class=iconify data-icon=bi:info-circle-fill></span><p class=ml-1>Issue</p></a></div><article class="mx-2 pb-4 text-justify"><p>Telegram Bot 沒有任何使用限制，可以寫出許多屬於自己的幫手。本篇簡單的用 Go 寫一個鸚鵡機器人，用戶說什麼，機器人就回什麼。</p><h2 id=新增自己的-bot>新增自己的 Bot</h2><p><img src=https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/fbf36cb0-84f4-4f7a-2553-04ecccf44800/public alt=image></p><p>Telegram 非常有趣，要新增自己的 Bot，只要跟 Telegram 上的 <a href=https://telegram.me/BotFather>BotFather</a> <code>說一下</code>，他就會給你一個 Bot。</p><p><img src=https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/9200bc38-828c-4ad4-a022-d34c3a692d00/public alt=image></p><p>按 BotFather 給你的步驟做，最後可以看到他會提供一個 API Token 給你，只要有這個 Token 就可以跟 Bot 溝通，要保存好，等等會用到，也不要給別人看到，以免自己的 Bot 變成別人的玩具。</p><h2 id=go-telegram-bot-api>go-telegram-bot-api</h2><p>Go 已經有社區開發的函式庫可以用 <a href=https://github.com/go-telegram-bot-api/telegram-bot-api>telegram-bot-api</a>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>go get -u github.com/go-telegram-bot-api/telegram-bot-api/v5
</span></span></code></pre></div><p>之後只要 import 就可以使用：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>tgbotapi</span> <span style=color:#e6db74>&#34;github.com/go-telegram-bot-api/telegram-bot-api/v5&#34;</span>
</span></span><span style=display:flex><span>)
</span></span></code></pre></div><h2 id=連線到-telegram-bot>連線到 Telegram Bot</h2><p>利用剛剛 import 的函式庫，只需要剛剛創建好的 Bot 的 API Token 就可以連線到 Telegram。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>bot</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>NewBotAPI</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Getenv</span>(<span style=color:#e6db74>&#34;TELEGRAM_API_TOKEN&#34;</span>))
</span></span><span style=display:flex><span><span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>    panic(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>上面用環境變數的方式來取得 TOKEN，避免需要直接寫在程式碼裡，如果覺得在測試時設定環境變數很麻煩，可以用 JetBrains 的 <a href=https://www.jetbrains.com/go/>GoLand</a>，設定 Runtime 的環境變數：</p><p><img src=https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/9af5d8a5-3504-479d-ab04-f8b0adf93500/public alt=image></p><h2 id=處理-update>處理 Update</h2><p>要接收使用者傳過來的訊息，Telegram API 稱為 Update，我們使用的函示庫基本上都自動處理好了，只需要接收一個 Channel 就好。使用 <code>bot.GetUpdatesChan(config)</code> 會需要給一個 Config，這可以用 <code>tgbotapi.NewUpdate(0)</code> 來生，然後這邊設定 Timeout 為 60，如果對這個設定值有興趣，可以去看 Telegram 的文件。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#a6e22e>updateConfig</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>NewUpdate</span>(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span><span style=color:#a6e22e>updateConfig</span>.<span style=color:#a6e22e>Timeout</span> = <span style=color:#ae81ff>60</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>updates</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>bot</span>.<span style=color:#a6e22e>GetUpdatesChan</span>(<span style=color:#a6e22e>updateConfig</span>)
</span></span></code></pre></div><h2 id=回復>回復</h2><p>我們先簡單寫一隻鸚鵡，把用戶傳過來的 Text，直接傳回去。</p><p><img src=https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/19bbc73e-3090-4a0d-0eec-d65671c01900/public alt=image></p><p>用 for 把 Channel 中的 Update 一個一個拿出來，然後用 <code>tgbotapi</code> 產生一個 Message 物件，裡面放在聊天室的 ID 和要回傳的 Text，最後用 bot 把 Message 傳回去。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>for</span> <span style=color:#a6e22e>update</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>updates</span> {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>text</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>update</span>.<span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>Text</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>chatID</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>update</span>.<span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>Chat</span>.<span style=color:#a6e22e>ID</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>replyMsg</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>NewMessage</span>(<span style=color:#a6e22e>chatID</span>, <span style=color:#a6e22e>text</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>_</span> = <span style=color:#a6e22e>bot</span>.<span style=color:#a6e22e>Send</span>(<span style=color:#a6e22e>replyMsg</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=簡單鸚鵡的完整程式碼>簡單鸚鵡的完整程式碼</h2><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#f92672>package</span> <span style=color:#a6e22e>main</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> (
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>tgbotapi</span> <span style=color:#e6db74>&#34;github.com/go-telegram-bot-api/telegram-bot-api/v5&#34;</span>
</span></span><span style=display:flex><span>    <span style=color:#e6db74>&#34;os&#34;</span>
</span></span><span style=display:flex><span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>bot</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>NewBotAPI</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Getenv</span>(<span style=color:#e6db74>&#34;TELEGRAM_API_TOKEN&#34;</span>))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>        panic(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>bot</span>.<span style=color:#a6e22e>Debug</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>updateConfig</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>NewUpdate</span>(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>updateConfig</span>.<span style=color:#a6e22e>Timeout</span> = <span style=color:#ae81ff>60</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>updates</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>bot</span>.<span style=color:#a6e22e>GetUpdatesChan</span>(<span style=color:#a6e22e>updateConfig</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>update</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>updates</span> {
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>text</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>update</span>.<span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>Text</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>chatID</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>update</span>.<span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>Chat</span>.<span style=color:#a6e22e>ID</span>
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>replyMsg</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>NewMessage</span>(<span style=color:#a6e22e>chatID</span>, <span style=color:#a6e22e>text</span>)
</span></span><span style=display:flex><span>        <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>_</span> = <span style=color:#a6e22e>bot</span>.<span style=color:#a6e22e>Send</span>(<span style=color:#a6e22e>replyMsg</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=改寫成非阻塞的-goroutine>改寫成非阻塞的 Goroutine</h2><p>因為每次處理和回復都會需要一點時間，甚至是要去 DB 找資料，如果用上面的寫法，在處理多人或高速傳訊息的時候會被卡住，一次只能處理的一個訊息。還好 Go 的併發寫法非常簡單，只要放一個 go 在前面，就可以非阻塞的執行 function 中的內容。</p><p>我們先把 <code>handleUpdate</code> 提取成一個 function，然後再用 go 去執行他：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>main</span>() {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>bot</span>, <span style=color:#a6e22e>err</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>NewBotAPI</span>(<span style=color:#a6e22e>os</span>.<span style=color:#a6e22e>Getenv</span>(<span style=color:#e6db74>&#34;TELEGRAM_API_TOKEN&#34;</span>))
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>err</span> <span style=color:#f92672>!=</span> <span style=color:#66d9ef>nil</span> {
</span></span><span style=display:flex><span>        panic(<span style=color:#a6e22e>err</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>bot</span>.<span style=color:#a6e22e>Debug</span> = <span style=color:#66d9ef>true</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>updateConfig</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>NewUpdate</span>(<span style=color:#ae81ff>0</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>updateConfig</span>.<span style=color:#a6e22e>Timeout</span> = <span style=color:#ae81ff>60</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>updates</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>bot</span>.<span style=color:#a6e22e>GetUpdatesChan</span>(<span style=color:#a6e22e>updateConfig</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>for</span> <span style=color:#a6e22e>update</span> <span style=color:#f92672>:=</span> <span style=color:#66d9ef>range</span> <span style=color:#a6e22e>updates</span> {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>go</span> <span style=color:#a6e22e>handleUpdate</span>(<span style=color:#a6e22e>bot</span>, <span style=color:#a6e22e>update</span>)
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>}
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>handleUpdate</span>(<span style=color:#a6e22e>bot</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>BotAPI</span>, <span style=color:#a6e22e>update</span> <span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>Update</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>text</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>update</span>.<span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>Text</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>chatID</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>update</span>.<span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>Chat</span>.<span style=color:#a6e22e>ID</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>replyMsg</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>NewMessage</span>(<span style=color:#a6e22e>chatID</span>, <span style=color:#a6e22e>text</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>_</span> = <span style=color:#a6e22e>bot</span>.<span style=color:#a6e22e>Send</span>(<span style=color:#a6e22e>replyMsg</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=回復特定訊息>回復特定訊息</h2><p>要回復 <code>回復訊息</code> ，像是下面的效果也很簡單：</p><p><img src=https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/22010000-e325-45e6-52f9-64eec6b28500/public alt=image></p><p>只需要設定 <code>replyMsg.ReplyToMessageID</code> 就可以回復特定的訊息，下面就是直接回覆接收到的訊息：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>handleUpdate</span>(<span style=color:#a6e22e>bot</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>BotAPI</span>, <span style=color:#a6e22e>update</span> <span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>Update</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>text</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>update</span>.<span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>Text</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>chatID</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>update</span>.<span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>Chat</span>.<span style=color:#a6e22e>ID</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>replyMsg</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>NewMessage</span>(<span style=color:#a6e22e>chatID</span>, <span style=color:#a6e22e>text</span>)
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>replyMsg</span>.<span style=color:#a6e22e>ReplyToMessageID</span> = <span style=color:#a6e22e>update</span>.<span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>MessageID</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>_</span> = <span style=color:#a6e22e>bot</span>.<span style=color:#a6e22e>Send</span>(<span style=color:#a6e22e>replyMsg</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><h2 id=處理-command>處理 Command</h2><p>Telegram 中，用 <code>/</code> 開頭的文字就是 Command，這個函示庫也有寫好處理 Command 的方法，只需要用 <code>isCommand()</code>，確認一下是不是 Command 就可以：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-go data-lang=go><span style=display:flex><span><span style=color:#66d9ef>func</span> <span style=color:#a6e22e>handleUpdate</span>(<span style=color:#a6e22e>bot</span> <span style=color:#f92672>*</span><span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>BotAPI</span>, <span style=color:#a6e22e>update</span> <span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>Update</span>) {
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>text</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>update</span>.<span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>Text</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>chatID</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>update</span>.<span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>Chat</span>.<span style=color:#a6e22e>ID</span>
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>replyMsg</span> <span style=color:#f92672>:=</span> <span style=color:#a6e22e>tgbotapi</span>.<span style=color:#a6e22e>NewMessage</span>(<span style=color:#a6e22e>chatID</span>, <span style=color:#a6e22e>text</span>)
</span></span><span style=display:flex><span>    <span style=color:#66d9ef>if</span> <span style=color:#a6e22e>update</span>.<span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>IsCommand</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>switch</span> <span style=color:#a6e22e>update</span>.<span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>Command</span>() {
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;start&#34;</span>:
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>replyMsg</span>.<span style=color:#a6e22e>Text</span> = <span style=color:#e6db74>&#34;Hello &#34;</span> <span style=color:#f92672>+</span> <span style=color:#a6e22e>update</span>.<span style=color:#a6e22e>Message</span>.<span style=color:#a6e22e>From</span>.<span style=color:#a6e22e>FirstName</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>case</span> <span style=color:#e6db74>&#34;help&#34;</span>:
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>replyMsg</span>.<span style=color:#a6e22e>Text</span> = <span style=color:#e6db74>&#34;What can I help you?&#34;</span>
</span></span><span style=display:flex><span>        <span style=color:#66d9ef>default</span>:
</span></span><span style=display:flex><span>            <span style=color:#a6e22e>replyMsg</span>.<span style=color:#a6e22e>Text</span> = <span style=color:#e6db74>&#34;No such command!!!&#34;</span>
</span></span><span style=display:flex><span>        }
</span></span><span style=display:flex><span>    }
</span></span><span style=display:flex><span>    <span style=color:#a6e22e>_</span>, <span style=color:#a6e22e>_</span> = <span style=color:#a6e22e>bot</span>.<span style=color:#a6e22e>Send</span>(<span style=color:#a6e22e>replyMsg</span>)
</span></span><span style=display:flex><span>}
</span></span></code></pre></div><p>上面的程式碼其實也可以看到如何拿到傳送者的一些基本資料。</p><p><img src=https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/0fd54240-5c18-4b75-c7be-981cdb144e00/public alt=image></p><h2 id=reference>Reference</h2><ul><li><a href=https://core.telegram.org/>Telegram APIs</a></li><li><a href=https://github.com/go-telegram-bot-api/telegram-bot-api>Golang bindings for the Telegram Bot API - GitHub</a></li></ul></article></div></div><div class=py-2><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1667006488909532" crossorigin=anonymous></script>
<ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-1667006488909532 data-ad-slot=8852856882></ins>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></main></div><aside class="lg:w-1/5 top-4 lg:sticky h-full z-0 mt-4 pl-3"><nav><div class="overflow-y-auto page-right-nav rounded-lg shadow-md bg-gray-50 my-10 p-3 mr-3" style=max-height:65vh><h2 class="text-3xl m-4 text-gray-600">目錄</h2><nav id=TableOfContents><ul><li><a href=#新增自己的-bot>新增自己的 Bot</a></li><li><a href=#go-telegram-bot-api>go-telegram-bot-api</a></li><li><a href=#連線到-telegram-bot>連線到 Telegram Bot</a></li><li><a href=#處理-update>處理 Update</a></li><li><a href=#回復>回復</a></li><li><a href=#簡單鸚鵡的完整程式碼>簡單鸚鵡的完整程式碼</a></li><li><a href=#改寫成非阻塞的-goroutine>改寫成非阻塞的 Goroutine</a></li><li><a href=#回復特定訊息>回復特定訊息</a></li><li><a href=#處理-command>處理 Command</a></li><li><a href=#reference>Reference</a></li></ul></nav></div></nav></aside></div><footer class="py-20 bg-gray-800 flex justify-center items-center flex-col space-y-16"><p class="order-1 text-gray-100">TonyPepe &copy; 2020 - 2022</p><div class="order-2 text-gray-100 inline-flex"><p>Made with</p><span class="iconify mx-2" data-icon=ant-design:heart-filled style=color:#f21111></span><p>and <a href=https://gohugo.io/ target=_blank>Hugo</a> in Taiwan</p></div><div class="order-3 flex flex-row space-x-6"><a href=https://github.com/TonyPepeBear/HugoBlog target=_blank><span class="iconify text-white" data-icon=file-icons:hugo data-width=33></span></a>
<a href=https://www.wikiwand.com/en/Taiwan target=_blank><span class=iconify data-icon=twemoji:flag-for-flag-taiwan style=color:#f21111 data-width=40></span></a>
<a href=https://github.com/TonyPepeBear target=_blank><span class="iconify text-white" data-icon=fontisto:github data-width=35></span></a></div></footer><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@500&family=Noto+Serif+TC:wght@600&display=swap" rel=stylesheet><script src=https://code.iconify.design/2/2.1.0/iconify.min.js></script>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/base16/dracula.min.css><script data-cfasync=false src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js></script>
<script data-cfasync=false src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/kotlin.min.js></script>
<script data-cfasync=false src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/groovy.min.js></script>
<script data-cfasync=false src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/dart.min.js></script>
<script data-cfasync=false src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/dockerfile.min.js></script>
<script data-cfasync=false src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/http.min.js></script>
<script defer>hljs.highlightAll()</script></body></html>