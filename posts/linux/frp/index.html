<!doctype html><html lang=zh-tw><head><meta http-equiv=content-type content="text/html" charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=stylesheet href="/HugoBlog/css/main.min.c2d216e1adfb9a02a5b6bc1d037421d8c4caa354db7dc07ef4a0f56a330fc2e0.css" integrity="sha256-wtIW4a37mgKltrwdA3Qh2MTKo1TbfcB+9KD1ajMPwuA="><title>Frp - TonyPepe</title></head><body class=bg-gray-200><script src=https://cdn.jsdelivr.net/gh/alpinejs/alpine@v2.x.x/dist/alpine.min.js defer></script><div class="container mx-auto lg:flex"><aside class="lg:w-1/5 top-4 lg:sticky h-full z-0 mt-4"><nav class="mx-4 lg:mx-0 flex flex-row lg:flex-col xl:ml-28"><div><img class="rounded-full w-32 h-32 hover:-rotate-12 transform duration-700" src=https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/cfccf3e2-7fd5-4e6c-adcb-a3cc5064f900/public alt><div class=mt-3><a href=/ class="mt-10 text-2xl font-black text-gray-800">TonyPepe</a></div></div><div><div class="flex flex-col ml-4 lg:ml-0"><a href=/ class="mt-5 text-xl font-black text-gray-800 hover:text-blue-900"><div class="flex flex-row items-center"><span class=iconify data-icon=mdi:home></span><p class=ml-2>Home</p></div></a><a href=/search class="mt-5 text-xl font-black text-gray-800 hover:text-blue-900"><div class="flex flex-row items-center"><span class=iconify data-icon=mdi:file-search></span><p class=ml-2>Search</p></div></a><a href=/about class="mt-5 text-xl font-black text-gray-800 hover:text-blue-900 transition"><div class="flex flex-row items-center"><span class=iconify data-icon=mdi:human-greeting-variant></span><p class=ml-2>About</p></div></a></div></div></nav></aside><div class="lg:w-3/5 z-10 mt-12"><main><div class="bg-white shadow-md rounded-xl my-5 mx-2"><img src=https://imagedelivery.net/cdkaXPuFls5qlrh3GM4hfA/34046c81-cb6e-40a5-7b3a-8623c613f400/public class="filter w-full h-80 object-cover rounded-t-xl"><div class=px-3><h1 class="text-4xl my-5 inline-block text-center w-full text-black">Frp</h1><div class="mx-2 flex flex-row pb-2 text-gray-500 items-center"><span class=iconify data-icon=mdi:calendar-range></span>
<time class=ml-1 datetime=2021-06-20T21:48:33+08:00>2021-Jun-20</time>
<a href=https://github.com/TonyPepeBear/HugoBlog/commit/ac97c4b38a90fbb53bd1841c78ff4f3e0348d9c1 target=_blank class="flex flex-row items-center ml-5"><span class=iconify data-icon=bi:git></span><p class=ml-1>ac97c4b</p></a><a href=https://github.com/TonyPepeBear/HugoBlog/issues target=_blank class="flex flex-row items-center ml-5"><span class=iconify data-icon=bi:info-circle-fill></span><p class=ml-1>Issue</p></a></div><article class="mx-2 pb-4 text-justify"><p>frp 全名是 fast reverse proxy，可以將在 NAT 後方的服務快速的發布到公網 ip 上，可以支援 TCP 和 UDP 協議，我覺得唯一的缺點就是所有流量都會經過 Server 端，所以如果 Server 端的流量有限制就需要注意一下。</p><p>frp 會需要一台 Server，Server 需要公網 ip，如果沒有公網 ip，可以使用 aws 或 gcp 買一個簡單的 VPS。</p><h2 id=安裝>安裝</h2><p>網路上有許多一鍵安裝的到腳本，但我們不使用那些，有興趣的自己上網搜尋。</p><p>到官方 <a href=https://github.com/fatedier/frp/releases>Release</a> 下載最新版，根據系統選擇，解壓後會看到 <code>frps</code> 、<code>frpc</code> 各有三個檔案，跟 <code>frps</code> 有關的就是 Server 端用的，<code>frpc</code> 的就是 Client 端用的。如果是 Server 端，就可以將 <code>frpc</code> 的檔案都刪除。</p><h2 id=server-端設定>Server 端設定</h2><p>在 Server 上打開設定文件 <code>frps.ini</code> 可以看到預設就有如下的內容：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[common]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>bind_port</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>7000</span>
</span></span></code></pre></div><p><code>common</code> 內綁定了 7000 port，這個 port 是讓 client 端連接用的，基本現在不用改設定就可以直接用。執行 <code>frps</code> 要用 <code>-c</code> 參數給定設定檔案：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-shell data-lang=shell><span style=display:flex><span>./frps -c ./frps.ini
</span></span></code></pre></div><p>如果沒看到問題，基本上 Server 端就設定好了，其他功能晚點再介紹，我們先設定好 Client。</p><h2 id=client-端設定>Client 端設定</h2><p>Client 就是要發布服務伺服器，所以雖然叫做 Client 但本身應該也是一台提供服務的 Server。Client 就可以刪除有關 <code>frps</code> 相關的檔案。</p><p>一樣先打開設定檔 <code>frpc.ini</code>，也會有如下預設內容：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[common]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>server_addr</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>127.0.0.1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>server_port</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>7000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[ssh]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>type</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>tcp</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>local_ip</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>127.0.0.1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>local_port</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>22</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>remote_port</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>6000</span>
</span></span></code></pre></div><p>Client 端的設定檔就不能直接用，需要修改 Server ip 才行，更改 <code>server_addr</code> 為剛剛 Server 端的 ip 地址或是 Domain 都可以。</p><p>下方方的 ssh 區塊設一個將 Client 端的 ssh 22 port 公開到 Server 端的 6000 port 的範本，如果有其他的 port 要開放，用相同的思維更改即可。像是如過要加 Minecraft 25565 port 也到 Server 端的 25565 port，就可以新增一個區塊：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[common]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>server_addr</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>example.com</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>server_port</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>7000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[ssh]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>type</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>tcp</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>local_ip</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>127.0.0.1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>local_port</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>22</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>remote_port</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>6000</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[minecraft]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>type</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>tcp</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>local_ip</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>127.0.0.1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>local_port</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>25565</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>remote_port</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>25565</span>
</span></span></code></pre></div><p>到目前為止應該就可以用 Server 端的 ip 連接到 Client 端了，如果連不上，可能要檢查一下 Server 端防火牆的設定，這邊就不贅述。</p><h2 id=token-認證>Token 認證</h2><p>不知道大家有沒有發現，基本上只要知道你 Server ip 或 domain 的人都可以新增自己的 port，要避免這樣的狀況，我們可以使用 token。使用方法也很簡單，只要在 Server 和 Client 端的 <code>[common]</code> 都加上相同的 token 參數，就可以進行簡單的認證。</p><p>Server 端範例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[common]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>bind_port</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>7000</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>token</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>7Jc2ZCvVzHu</span>
</span></span></code></pre></div><p>Client 端範例：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-ini data-lang=ini><span style=display:flex><span><span style=color:#66d9ef>[common]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>server_addr</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>example.com</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>server_port</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>7000</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>token</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>7Jc2ZCvVzHu</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#66d9ef>[ssh]</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>type</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>tcp</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>local_ip</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>127.0.0.1</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>local_port</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>22</span>
</span></span><span style=display:flex><span><span style=color:#a6e22e>remote_port</span> <span style=color:#f92672>=</span> <span style=color:#e6db74>6000</span>
</span></span></code></pre></div><h2 id=refrence>Refrence</h2><p><a href=https://github.com/fatedier/frp>GitHub</a></p><p><a href=https://gofrp.org/docs/>中文文檔</a></p></article></div></div><div class=py-2><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1667006488909532" crossorigin=anonymous></script>
<ins class=adsbygoogle style=display:block;text-align:center data-ad-layout=in-article data-ad-format=fluid data-ad-client=ca-pub-1667006488909532 data-ad-slot=8852856882></ins>
<script>(adsbygoogle=window.adsbygoogle||[]).push({})</script></div></main></div><aside class="lg:w-1/5 top-4 lg:sticky h-full z-0 mt-4 pl-3"><nav><div class="overflow-y-auto page-right-nav rounded-lg shadow-md bg-gray-50 my-10 p-3 mr-3" style=max-height:65vh><h2 class="text-3xl m-4 text-gray-600">目錄</h2><nav id=TableOfContents><ul><li><a href=#安裝>安裝</a></li><li><a href=#server-端設定>Server 端設定</a></li><li><a href=#client-端設定>Client 端設定</a></li><li><a href=#token-認證>Token 認證</a></li><li><a href=#refrence>Refrence</a></li></ul></nav></div></nav></aside></div><footer class="py-20 bg-gray-800 flex justify-center items-center flex-col space-y-16"><p class="order-1 text-gray-100">TonyPepe &copy; 2020 - 2022</p><div class="order-2 text-gray-100 inline-flex"><p>Made with</p><span class="iconify mx-2" data-icon=ant-design:heart-filled style=color:#f21111></span><p>and <a href=https://gohugo.io/ target=_blank>Hugo</a> in Taiwan</p></div><div class="order-3 flex flex-row space-x-6"><a href=https://github.com/TonyPepeBear/HugoBlog target=_blank><span class="iconify text-white" data-icon=file-icons:hugo data-width=33></span></a>
<a href=https://www.wikiwand.com/en/Taiwan target=_blank><span class=iconify data-icon=twemoji:flag-for-flag-taiwan style=color:#f21111 data-width=40></span></a>
<a href=https://github.com/TonyPepeBear target=_blank><span class="iconify text-white" data-icon=fontisto:github data-width=35></span></a></div></footer><link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link href="https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@500&family=Noto+Serif+TC:wght@600&display=swap" rel=stylesheet><script src=https://code.iconify.design/2/2.1.0/iconify.min.js></script>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/styles/base16/dracula.min.css><script data-cfasync=false src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/highlight.min.js></script>
<script data-cfasync=false src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/kotlin.min.js></script>
<script data-cfasync=false src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/groovy.min.js></script>
<script data-cfasync=false src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/dart.min.js></script>
<script data-cfasync=false src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/dockerfile.min.js></script>
<script data-cfasync=false src=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.4.0/languages/http.min.js></script>
<script defer>hljs.highlightAll()</script></body></html>